<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Time-dependent Example &mdash; Lightweaver  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Computing a simple NLTE 8542 line profile in a FAL C atmosphere" href="plot_SimpleLineTest.html" />
    <link rel="prev" title="Lightweaver Examples Gallery" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Lightweaver
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Lightweaver Examples Gallery</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Time-dependent Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_SimpleLineTest.html">Computing a simple NLTE 8542 line profile in a FAL C atmosphere</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lightweaver-api.html">Lightweaver API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Lightweaver</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Lightweaver Examples Gallery</a></li>
      <li class="breadcrumb-item active">Time-dependent Example</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/plot_JudgeDynamicValidation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-plot-judgedynamicvalidation-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="time-dependent-example">
<span id="sphx-glr-auto-examples-plot-judgedynamicvalidation-py"></span><h1>Time-dependent Example<a class="headerlink" href="#time-dependent-example" title="Link to this heading">ÔÉÅ</a></h1>
<p>Simple illustrative example of time-dependent method. Herein we reproduce the
time-dependent population figure present in Judge 2017. Here the complete
Rybicki-Hummer MALI method is used.
Herein we also conserve charge.</p>
<p>Judge (2017): ApJ 851, 5</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lightweaver.fal</span> <span class="kn">import</span> <span class="n">Falc82</span>
<span class="kn">from</span> <span class="nn">lightweaver.rh_atoms</span> <span class="kn">import</span>  <span class="n">H_4_atom</span><span class="p">,</span> <span class="n">C_atom</span><span class="p">,</span> <span class="n">O_atom</span><span class="p">,</span> <span class="n">Si_atom</span><span class="p">,</span> <span class="n">Al_atom</span><span class="p">,</span> <span class="n">CaII_atom</span><span class="p">,</span> <span class="n">Fe_atom</span><span class="p">,</span> <span class="n">He_atom</span><span class="p">,</span> <span class="n">MgII_atom</span><span class="p">,</span> <span class="n">N_atom</span><span class="p">,</span> <span class="n">Na_atom</span><span class="p">,</span> <span class="n">S_atom</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">lightweaver</span> <span class="k">as</span> <span class="nn">lw</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/Lightweaver/Lightweaver/lightweaver/config.py:75: UserWarning: No config file found, using defaults. For optimised vectorised code, please run `lightweaver.benchmark()`, otherwise the most advanced instruction set supported by your machine will be picked, which may not be the fastest (due to e.g. aggressive AVX offsets).
  warnings.warn(&#39;No config file found, using defaults. For optimised vectorised code,&#39;
</pre></div>
</div>
<p>Set up the standard FAL C 82 point initial atmosphere.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">atmos</span> <span class="o">=</span> <span class="n">Falc82</span><span class="p">()</span>
<span class="n">atmos</span><span class="o">.</span><span class="n">quadrature</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">aSet</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">RadiativeSet</span><span class="p">([</span><span class="n">H_4_atom</span><span class="p">(),</span> <span class="n">C_atom</span><span class="p">(),</span> <span class="n">O_atom</span><span class="p">(),</span> <span class="n">Si_atom</span><span class="p">(),</span> <span class="n">Al_atom</span><span class="p">(),</span> <span class="n">CaII_atom</span><span class="p">(),</span>\
                        <span class="n">Fe_atom</span><span class="p">(),</span> <span class="n">He_atom</span><span class="p">(),</span> <span class="n">MgII_atom</span><span class="p">(),</span> <span class="n">N_atom</span><span class="p">(),</span> <span class="n">Na_atom</span><span class="p">(),</span> <span class="n">S_atom</span><span class="p">()])</span>
<span class="n">aSet</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
<span class="n">spect</span> <span class="o">=</span> <span class="n">aSet</span><span class="o">.</span><span class="n">compute_wavelength_grid</span><span class="p">()</span>

<span class="n">eqPops</span> <span class="o">=</span> <span class="n">aSet</span><span class="o">.</span><span class="n">iterate_lte_ne_eq_pops</span><span class="p">(</span><span class="n">atmos</span><span class="p">)</span>
<span class="n">ctx</span> <span class="o">=</span> <span class="n">lw</span><span class="o">.</span><span class="n">Context</span><span class="p">(</span><span class="n">atmos</span><span class="p">,</span> <span class="n">spect</span><span class="p">,</span> <span class="n">eqPops</span><span class="p">,</span> <span class="n">conserveCharge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Nthreads</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Find the initial statistical equilibrium solution,</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">lw</span><span class="o">.</span><span class="n">iterate_ctx_se</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Achieved initial Stat Eq</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>-- Iteration 0:
dJ = 1.00e+00
    (Lambda iterating background)
-- Iteration 4:
dJ = 9.64e+00
    H delta = 1.0905e+00
    ne delta = 1.6015e-01
-- Iteration 28:
dJ = 8.70e-02
    H delta = 5.2471e-02
    ne delta = 8.2997e-16
-- Iteration 52:
dJ = 5.61e-02
    H delta = 3.3457e-02
    ne delta = 1.3546e-16
-- Iteration 76:
dJ = 2.21e-02
    H delta = 1.4337e-02
    ne delta = 1.3546e-16
-- Iteration 100:
dJ = 4.19e-03
    H delta = 2.7958e-03
    ne delta = 1.3546e-16
--------------------------------------------------------------------------------
Final Iteration: 113
--------------------------------------------------------------------------------
dJ = 1.45e-03
    H delta = 9.6901e-04
    ne delta = 7.0413e-16
--------------------------------------------------------------------------------
Context converged to statistical equilibrium in 113 iterations after 2.57 s.
--------------------------------------------------------------------------------
Achieved initial Stat Eq
</pre></div>
</div>
<p>Simulation parameters, timestep, number of steps to run for, and how many
times to attempt to solve the equations for convergence per step.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">NtStep</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">NsubStep</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
<p>Perturb the atmospheric temperature structure like in the paper.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">prevT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">atmos</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">31</span><span class="p">):</span>
    <span class="n">di</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mf">20.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0</span>
    <span class="n">atmos</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">di</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Solve the problem</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">hPops</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">eqPops</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">])]</span>
<span class="n">subIters</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NtStep</span><span class="p">):</span>
    <span class="c1"># Recompute line profiles etc to account for changing electron density and temperature.</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">update_deps</span><span class="p">()</span>

    <span class="n">prevState</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NsubStep</span><span class="p">):</span>
        <span class="n">JUpdate</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">formal_sol_gamma_matrices</span><span class="p">()</span>
        <span class="c1"># If prevState is None, then the function assumes that this is the</span>
        <span class="c1"># subiteration for this step and constructs and returns prevState</span>
        <span class="n">popsUpdate</span><span class="p">,</span> <span class="n">prevState</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">time_dep_update</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">prevState</span><span class="p">)</span>
        <span class="c1"># Update electron density.</span>
        <span class="c1"># If conserveCharge is set to True when the context is constructed, then</span>
        <span class="c1"># the effects of `time_dep_update` are included in the IterationUpdate</span>
        <span class="c1"># returned from `nr_post_update`, as the Context is expecting this to be</span>
        <span class="c1"># called immediately after `time_dep_update`.</span>
        <span class="n">nrUpdate</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">nr_post_update</span><span class="p">(</span><span class="n">timeDependentData</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="n">dt</span><span class="p">,</span> <span class="s1">&#39;nPrev&#39;</span><span class="p">:</span> <span class="n">prevState</span><span class="p">})</span>

        <span class="c1"># Check subiteration convergence</span>
        <span class="k">if</span> <span class="n">nrUpdate</span><span class="o">.</span><span class="n">dPopsMax</span> <span class="o">&lt;</span> <span class="mf">1e-3</span> <span class="ow">and</span> <span class="n">JUpdate</span><span class="o">.</span><span class="n">dJMax</span> <span class="o">&lt;</span> <span class="mf">3e-3</span><span class="p">:</span>
            <span class="n">subIters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No convergence within required Nsubstep&#39;</span><span class="p">)</span>

    <span class="n">hPops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">eqPops</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Iteration </span><span class="si">%d</span><span class="s1"> (</span><span class="si">%f</span><span class="s1"> s) done after </span><span class="si">%d</span><span class="s1"> sub iterations&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="p">(</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">sub</span><span class="p">))</span>

    <span class="c1"># input()</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Iteration 0 (0.100000 s) done after 51 sub iterations
Iteration 1 (0.200000 s) done after 48 sub iterations
Iteration 2 (0.300000 s) done after 46 sub iterations
Iteration 3 (0.400000 s) done after 41 sub iterations
Iteration 4 (0.500000 s) done after 36 sub iterations
Iteration 5 (0.600000 s) done after 30 sub iterations
Iteration 6 (0.700000 s) done after 30 sub iterations
Iteration 7 (0.800000 s) done after 24 sub iterations
Iteration 8 (0.900000 s) done after 22 sub iterations
Iteration 9 (1.000000 s) done after 21 sub iterations
Iteration 10 (1.100000 s) done after 19 sub iterations
Iteration 11 (1.200000 s) done after 18 sub iterations
Iteration 12 (1.300000 s) done after 17 sub iterations
Iteration 13 (1.400000 s) done after 17 sub iterations
Iteration 14 (1.500000 s) done after 16 sub iterations
Iteration 15 (1.600000 s) done after 16 sub iterations
Iteration 16 (1.700000 s) done after 20 sub iterations
Iteration 17 (1.800000 s) done after 21 sub iterations
Iteration 18 (1.900000 s) done after 14 sub iterations
Iteration 19 (2.000000 s) done after 13 sub iterations
Iteration 20 (2.100000 s) done after 13 sub iterations
Iteration 21 (2.200000 s) done after 12 sub iterations
Iteration 22 (2.300000 s) done after 11 sub iterations
Iteration 23 (2.400000 s) done after 11 sub iterations
Iteration 24 (2.500000 s) done after 10 sub iterations
Iteration 25 (2.600000 s) done after 9 sub iterations
Iteration 26 (2.700000 s) done after 9 sub iterations
Iteration 27 (2.800000 s) done after 8 sub iterations
Iteration 28 (2.900000 s) done after 7 sub iterations
Iteration 29 (3.000000 s) done after 7 sub iterations
</pre></div>
</div>
<p>Reproduce Judge plot.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">initialAtmos</span> <span class="o">=</span> <span class="n">Falc82</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">cmass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">atmos</span><span class="o">.</span><span class="n">cmass</span><span class="o">/</span><span class="mf">1e1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmass</span><span class="p">,</span> <span class="n">initialAtmos</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmass</span><span class="p">,</span> <span class="n">atmos</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">hPops</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmass</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmass</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmass</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">))</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">hPops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmass</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmass</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmass</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">4.935</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.931</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6e4</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time taken: </span><span class="si">%.2f</span><span class="s1"> s&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">))</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_JudgeDynamicValidation_001.png" srcset="../_images/sphx_glr_plot_JudgeDynamicValidation_001.png" alt="plot JudgeDynamicValidation" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Time taken: 6.23 s
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 26.226 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-judgedynamicvalidation-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/80b6e3e2cfa645cda4e5a121a0b8a2e4/plot_JudgeDynamicValidation.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_JudgeDynamicValidation.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/6e84ed00ad45ba63690cdf562cf55cb9/plot_JudgeDynamicValidation.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_JudgeDynamicValidation.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Lightweaver Examples Gallery" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot_SimpleLineTest.html" class="btn btn-neutral float-right" title="Computing a simple NLTE 8542 line profile in a FAL C atmosphere" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, C. Osborne.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>