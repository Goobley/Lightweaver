

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lightweaver package &mdash; Lightweaver  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to Lightweaver’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Lightweaver
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">lightweaver package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lightweaver-atmosphere-module">lightweaver.atmosphere module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.atomic_model">lightweaver.atomic_model module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.atomic_set">lightweaver.atomic_set module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.atomic_table">lightweaver.atomic_table module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.barklem">lightweaver.barklem module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.broadening">lightweaver.broadening module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lightweaver-collisional-rates-module">lightweaver.collisional_rates module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lightweaver-fal-module">lightweaver.fal module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.molecule">lightweaver.molecule module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.multi">lightweaver.multi module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.nr_update">lightweaver.nr_update module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lightweaver-rh-atoms-module">lightweaver.rh_atoms module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.utils">lightweaver.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.witt">lightweaver.witt module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.zeeman">lightweaver.zeeman module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lightweaver-lwcompiled-module">lightweaver.LwCompiled module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Lightweaver</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>lightweaver package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/lightweaver-api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="lightweaver-package">
<h1>lightweaver package<a class="headerlink" href="#lightweaver-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="lightweaver-atmosphere-module">
<h2>lightweaver.atmosphere module<a class="headerlink" href="#lightweaver-atmosphere-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-lightweaver.atomic_model">
<span id="lightweaver-atomic-model-module"></span><h2>lightweaver.atomic_model module<a class="headerlink" href="#module-lightweaver.atomic_model" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.atomic_model.AtomicContinuum">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">AtomicContinuum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.AtomicTransition" title="lightweaver.atomic_model.AtomicTransition"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.AtomicTransition</span></code></a></p>
<p>Base class for atomic continua.</p>
<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.alpha">
<code class="sig-name descname">alpha</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cross-section as a function of wavelength</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelength</strong> (<em>np.ndarray</em>) – The wavelengths at which to compute the cross-section</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>alpha</strong> – The cross-section for each wavelength</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.lambda0">
<em class="property">property </em><code class="sig-name descname">lambda0</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.lambda0" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum (edge) wavelength at which this transition contributes [nm].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.lambda0_m">
<em class="property">property </em><code class="sig-name descname">lambda0_m</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.lambda0_m" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum (edge) wavelength at which this transition contributes [m].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.lambdaEdge">
<em class="property">property </em><code class="sig-name descname">lambdaEdge</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.lambdaEdge" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum (edge) wavelength at which this transition contributes [nm].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.minLambda">
<em class="property">property </em><code class="sig-name descname">minLambda</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.minLambda" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum wavelength at which this transition contributes.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>The wavelength grid on which this continuum’s cross section is defined.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.AtomicLevel">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">AtomicLevel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">E</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">g</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">label</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">stage</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">J</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>fractions.Fraction<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">L</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">S</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>fractions.Fraction<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Description of atomic level in model atom.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.E">
<code class="sig-name descname">E</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.E" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy above ground state [cm-1]</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.g">
<code class="sig-name descname">g</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.g" title="Permalink to this definition">¶</a></dt>
<dd><p>Statistical weight of level</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.label">
<code class="sig-name descname">label</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Name for level</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.stage">
<code class="sig-name descname">stage</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Ionisation of level with 0 being neutral</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.atom">
<code class="sig-name descname">atom</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.atom" title="Permalink to this definition">¶</a></dt>
<dd><p>AtomicModel that holds this level, will be initialised by the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">AtomicModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.J">
<code class="sig-name descname">J</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.J" title="Permalink to this definition">¶</a></dt>
<dd><p>Total quantum angular momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Fraction, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.L">
<code class="sig-name descname">L</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.L" title="Permalink to this definition">¶</a></dt>
<dd><p>Orbital angular momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.S">
<code class="sig-name descname">S</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.S" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Fraction, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLevel.E_SI">
<em class="property">property </em><code class="sig-name descname">E_SI</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.E_SI" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns E in Joule.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLevel.E_eV">
<em class="property">property </em><code class="sig-name descname">E_eV</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.E_eV" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns E in electron volt.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLevel.lsCoupling">
<em class="property">property </em><code class="sig-name descname">lsCoupling</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.lsCoupling" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether the L-S coupling formalism can be applied to this
level.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.AtomicLine">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">AtomicLine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">f</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">type</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineType" title="lightweaver.atomic_model.LineType">lightweaver.atomic_model.LineType</a></span></em>, <em class="sig-param"><span class="n">quadrature</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineQuadrature" title="lightweaver.atomic_model.LineQuadrature">lightweaver.atomic_model.LineQuadrature</a></span></em>, <em class="sig-param"><span class="n">broadening</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.broadening.LineBroadening" title="lightweaver.broadening.LineBroadening">lightweaver.broadening.LineBroadening</a></span></em>, <em class="sig-param"><span class="n">gLandeEff</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.AtomicTransition" title="lightweaver.atomic_model.AtomicTransition"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.AtomicTransition</span></code></a></p>
<p>Base class for atomic lines, holding their specialised information over
transitions.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLine.f">
<code class="sig-name descname">f</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Oscillator strength.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLine.type">
<code class="sig-name descname">type</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Should the line be treated in PRD or CRD.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.LineType" title="lightweaver.atomic_model.LineType">LineType</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLine.quadrature">
<code class="sig-name descname">quadrature</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.quadrature" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavelength quadrature for integrating line properties over.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.LineQuadrature" title="lightweaver.atomic_model.LineQuadrature">LineQuadrature</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLine.broadening">
<code class="sig-name descname">broadening</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.broadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Object describing the broadening processes to be used in conjunction
with the quadrature to generate the line profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.broadening.LineBroadening" title="lightweaver.broadening.LineBroadening">LineBroadening</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLine.gLandeEff">
<code class="sig-name descname">gLandeEff</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.gLandeEff" title="Permalink to this definition">¶</a></dt>
<dd><p>Optionally override LS-coupling (if available for this transition),
and just directly set the effective Lande g factor (if it isn’t).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.Aji">
<em class="property">property </em><code class="sig-name descname">Aji</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.Aji" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Einstein A coefficient for this line.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.Bij">
<em class="property">property </em><code class="sig-name descname">Bij</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.Bij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Einstein B_{ij} coefficient for this line.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.Bji">
<em class="property">property </em><code class="sig-name descname">Bji</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.Bji" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Einstein B_{ji} coefficient for this line.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.compute_phi">
<code class="sig-name descname">compute_phi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineProfileState" title="lightweaver.atomic_model.LineProfileState">lightweaver.atomic_model.LineProfileState</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_model.LineProfileResult" title="lightweaver.atomic_model.LineProfileResult">lightweaver.atomic_model.LineProfileResult</a><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.compute_phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the line profile, intended to be called from the backend.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.lambda0">
<em class="property">property </em><code class="sig-name descname">lambda0</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.lambda0" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the line rest wavelength [nm].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.lambda0_m">
<em class="property">property </em><code class="sig-name descname">lambda0_m</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.lambda0_m" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the line rest wavelength [m].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.overlyingContinuumLevel">
<em class="property">property </em><code class="sig-name descname">overlyingContinuumLevel</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.overlyingContinuumLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the first overlying continuum level.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.polarisable">
<em class="property">property </em><code class="sig-name descname">polarisable</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.polarisable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether sufficient information is available to compute full
Stokes solutions for this line.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vMicroChar</span><span class="o">=</span><span class="default_value">3000.0</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the wavelength grid for this transition based on the
LineQuadrature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vMicroChar</strong> (<em>float</em><em>, </em><em>optional</em>) – Characterisitc microturbulent velocity to assume when computing
the line quadrature (default 3e3 m/s).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.zeeman_components">
<code class="sig-name descname">zeeman_components</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.zeeman.ZeemanComponents" title="lightweaver.zeeman.ZeemanComponents">lightweaver.zeeman.ZeemanComponents</a><span class="p">]</span><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.zeeman_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Zeeman components of a line, if possible or None.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.AtomicModel">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">AtomicModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a></span></em>, <em class="sig-param"><span class="n">levels</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_model.AtomicLevel" title="lightweaver.atomic_model.AtomicLevel">AtomicLevel</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">lines</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine">AtomicLine</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">continua</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_model.AtomicContinuum" title="lightweaver.atomic_model.AtomicContinuum">AtomicContinuum</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">collisions</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>CollisionalRates<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container class for the complete description of a model atom.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicModel.element">
<code class="sig-name descname">element</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.element" title="Permalink to this definition">¶</a></dt>
<dd><p>The element or ion represented by this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicModel.levels">
<code class="sig-name descname">levels</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.levels" title="Permalink to this definition">¶</a></dt>
<dd><p>The levels in use in this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of AtomicLevel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicModel.lines">
<code class="sig-name descname">lines</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.lines" title="Permalink to this definition">¶</a></dt>
<dd><p>The atomic lines present in this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of AtomicLine</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicModel.continua">
<code class="sig-name descname">continua</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.continua" title="Permalink to this definition">¶</a></dt>
<dd><p>The atomic continua present in this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of AtomicContinuum</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicModel.collisions">
<code class="sig-name descname">collisions</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.collisions" title="Permalink to this definition">¶</a></dt>
<dd><p>The collisional rates present in this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of CollisionalRates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicModel.transitions">
<em class="property">property </em><code class="sig-name descname">transitions</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>List of all atomic transitions present on the model.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicModel.vBroad">
<code class="sig-name descname">vBroad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.vBroad" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the atomic broadening velocity structure for a given
atmosphere from the thermal motions and microturbulent velocity.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.AtomicTransition">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">AtomicTransition</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.AtomicTransition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic storage class for atomic transitions. Both lines and continua are
derived from this.</p>
<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicTransition.transId">
<em class="property">property </em><code class="sig-name descname">transId</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicTransition.transId" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique identifier (transition ID) for transition (assuming one copy
of each Element), used in creating a SpectrumConfiguration etc.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.ExplicitContinuum">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">ExplicitContinuum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">wavelengthGrid</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">alphaGrid</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.ExplicitContinuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.AtomicContinuum" title="lightweaver.atomic_model.AtomicContinuum"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.AtomicContinuum</span></code></a></p>
<p>Specific version of atomic continuum with tabulated cross-section against
wavelength. Interpolated using weno4.
.. attribute:: wavelengthGrid</p>
<blockquote>
<div><p>Wavelengths at which cross-section is tabulated [nm].</p>
<dl class="field-list simple">
<dt class="field-odd">type</dt>
<dd class="field-odd"><p>list of float</p>
</dd>
</dl>
</div></blockquote>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.ExplicitContinuum.alphaGrid">
<code class="sig-name descname">alphaGrid</code><a class="headerlink" href="#lightweaver.atomic_model.ExplicitContinuum.alphaGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Tabulated cross-sections [m2].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.ExplicitContinuum.alpha">
<code class="sig-name descname">alpha</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.ExplicitContinuum.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cross-section as a function of wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelength</strong> (<em>np.ndarray</em>) – Wavelengths at which to compute the cross-section [nm].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>alpha</strong> – Cross-section at associated wavelength.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.ExplicitContinuum.minLambda">
<em class="property">property </em><code class="sig-name descname">minLambda</code><a class="headerlink" href="#lightweaver.atomic_model.ExplicitContinuum.minLambda" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum wavelength at which this transition contributes.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.ExplicitContinuum.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.ExplicitContinuum.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the wavelength grid at which this transition needs to be
computed to be correctly integrated. Specific handling is added to
ensure that it is treated properly close to the edge.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.HydrogenicContinuum">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">HydrogenicContinuum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">NlambdaGen</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">alpha0</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">minWavelength</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.AtomicContinuum" title="lightweaver.atomic_model.AtomicContinuum"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.AtomicContinuum</span></code></a></p>
<p>Specific case of a Hydrogenic continuum, approximately falling off as
1/nu**3 towards higher frequencies (additional effects from Gaunt
factor).</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.NlambaGen">
<code class="sig-name descname">NlambaGen</code><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.NlambaGen" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of points to generate for the wavelength grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.alpha0">
<code class="sig-name descname">alpha0</code><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.alpha0" title="Permalink to this definition">¶</a></dt>
<dd><p>The cross-section at the edge wavelength [m2].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.minWavelength">
<code class="sig-name descname">minWavelength</code><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.minWavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum wavelength below which this transition is assumed to no
longer contribute [nm].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.alpha">
<code class="sig-name descname">alpha</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cross-section as a function of wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelength</strong> (<em>np.ndarray</em>) – Wavelengths at which to compute the cross-section [nm].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>alpha</strong> – Cross-section at associated wavelength.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.minLambda">
<em class="property">property </em><code class="sig-name descname">minLambda</code><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.minLambda" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum wavelength at which this transition contributes.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the wavelength grid at which this transition needs to be
computed to be correctly integrated.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.LineProfileResult">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">LineProfileResult</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phi</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">aDamp</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">Qelast</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.LineProfileResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Dataclass for returning the line profile and associated data that needs
to be saved (damping parameter and elastic collision rate) from the
frontend to the backend.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.LineProfileState">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">LineProfileState</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vlosMu</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em>, <em class="sig-param"><span class="n">default_voigt_callback</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">vBroad</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Dataclass used to communicate line profile calculations from the backend
to the frontend whilst allowing the backend to provide an overrideable
optimised voigt implementation for the default case.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.wavelength">
<code class="sig-name descname">wavelength</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavelengths at which to compute the line profile [nm]</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.vlosMu">
<code class="sig-name descname">vlosMu</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.vlosMu" title="Permalink to this definition">¶</a></dt>
<dd><p>Bulk velocity projected onto each ray in the angular integration scheme [m/s] in an array of [Nmu, Nspace].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.atmos">
<code class="sig-name descname">atmos</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.atmos" title="Permalink to this definition">¶</a></dt>
<dd><p>The associated atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Atmosphere</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.eqPops">
<code class="sig-name descname">eqPops</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.eqPops" title="Permalink to this definition">¶</a></dt>
<dd><p>The associated populations for each species present in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable">SpeciesStateTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.default_voigt_callback">
<code class="sig-name descname">default_voigt_callback</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.default_voigt_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Voigt profile for the default case, takes the damping
parameter aDamp and broadening velocity vBroad as arguments, and
returns the line profile phi (in this case phi_num in the tech report).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.vBroad">
<code class="sig-name descname">vBroad</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.vBroad" title="Permalink to this definition">¶</a></dt>
<dd><p>Cache to avoid recomputing vBroad every time. May be None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray, optional</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.LineQuadrature">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">LineQuadrature</code><a class="headerlink" href="#lightweaver.atomic_model.LineQuadrature" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Describes the wavelength quadrature to be used for integrating properties
associated with a line.</p>
<dl class="py method">
<dt id="lightweaver.atomic_model.LineQuadrature.doppler_units">
<code class="sig-name descname">doppler_units</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine">lightweaver.atomic_model.AtomicLine</a></span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.LineQuadrature.doppler_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadrature in Doppler units.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.LineQuadrature.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine">lightweaver.atomic_model.AtomicLine</a></span></em>, <em class="sig-param"><span class="n">vMicroChar</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">3000.0</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.LineQuadrature.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadrature in nm.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.LineType">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">LineType</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.LineType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Enum to show if the line should be treated in CRD or PRD.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.LinearCoreExpWings">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">LinearCoreExpWings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">qCore</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">qWing</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">Nlambda</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.LinearCoreExpWings" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.LineQuadrature" title="lightweaver.atomic_model.LineQuadrature"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.LineQuadrature</span></code></a></p>
<p>RH-Style line quadrature, with approximately linear core spacing and
exponential wing spacing, by using a function of the form
q(n) = a*(n + (exp(b*n)-1))
with n in [0, N) satisfying the following conditions:</p>
<blockquote>
<div><ul class="simple">
<li><p>q[0] = 0</p></li>
<li><p>q[(N-1)/2] = qcore</p></li>
<li><p>q[N-1] = qwing.</p></li>
</ul>
</div></blockquote>
<dl class="py method">
<dt id="lightweaver.atomic_model.LinearCoreExpWings.doppler_units">
<code class="sig-name descname">doppler_units</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine">lightweaver.atomic_model.AtomicLine</a></span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.LinearCoreExpWings.doppler_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadrature in Doppler units.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.LinearCoreExpWings.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine">lightweaver.atomic_model.AtomicLine</a></span></em>, <em class="sig-param"><span class="n">vMicroChar</span><span class="o">=</span><span class="default_value">3000.0</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_model.LinearCoreExpWings.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadrature in nm.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.VoigtLine">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">VoigtLine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">f</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">type</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineType" title="lightweaver.atomic_model.LineType">lightweaver.atomic_model.LineType</a></span></em>, <em class="sig-param"><span class="n">quadrature</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineQuadrature" title="lightweaver.atomic_model.LineQuadrature">lightweaver.atomic_model.LineQuadrature</a></span></em>, <em class="sig-param"><span class="n">broadening</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.broadening.LineBroadening" title="lightweaver.broadening.LineBroadening">lightweaver.broadening.LineBroadening</a></span></em>, <em class="sig-param"><span class="n">gLandeEff</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.VoigtLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.AtomicLine</span></code></a></p>
<p>Specialised line profile for the default case of a Voigt profile.</p>
<dl class="py method">
<dt id="lightweaver.atomic_model.VoigtLine.compute_phi">
<code class="sig-name descname">compute_phi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineProfileState" title="lightweaver.atomic_model.LineProfileState">lightweaver.atomic_model.LineProfileState</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_model.LineProfileResult" title="lightweaver.atomic_model.LineProfileResult">lightweaver.atomic_model.LineProfileResult</a><a class="headerlink" href="#lightweaver.atomic_model.VoigtLine.compute_phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the line profile.</p>
<p>In the case of a VoigtLine the line profile simply uses the
default_voigt_callback from the backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="#lightweaver.atomic_model.LineProfileState" title="lightweaver.atomic_model.LineProfileState"><em>LineProfileState</em></a>) – The information from the backend</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – The line profile, as well as the damping parameter ‘a’ and and
the broadening velocity.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.LineProfileResult" title="lightweaver.atomic_model.LineProfileResult">LineProfileResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.VoigtLine.damping">
<code class="sig-name descname">damping</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em>, <em class="sig-param"><span class="n">vBroad</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.VoigtLine.damping" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the damping parameter and elastic collision rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere to consider.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations in this atmosphere.</p></li>
<li><p><strong>vBroad</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The broadening velocity, will be used if passed, or computed
using atom.vBroad if not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>aDamp</strong> (<em>np.ndarray</em>) – The Voigt damping parameter.</p></li>
<li><p><strong>Qelast</strong> (<em>np.ndarray</em>) – The rate of elastic collisions broadening the line – needed for PRD.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_model.reconfigure_atom">
<code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">reconfigure_atom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">lightweaver.atomic_model.AtomicModel</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_model.reconfigure_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-perform all atomic set up after modifying parameters.</p>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.atomic_set">
<span id="lightweaver-atomic-set-module"></span><h2>lightweaver.atomic_set module<a class="headerlink" href="#module-lightweaver.atomic_set" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.atomic_set.AtomicState">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">AtomicState</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">lightweaver.atomic_model.AtomicModel</a></span></em>, <em class="sig-param"><span class="n">abundance</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">nStar</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">nTotal</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">detailed</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pops</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">radiativeRates</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Dict<span class="p">[</span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.AtomicState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for the state of an atomic model during a simulation.</p>
<p>This hold both the model, as well as the simulations properties such as abundance, populations and radiative rates.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.model">
<code class="sig-name descname">model</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The python model of the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">AtomicModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.abundance">
<code class="sig-name descname">abundance</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.abundance" title="Permalink to this definition">¶</a></dt>
<dd><p>The abundance of the species as a fraction of H abundance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.nStar">
<code class="sig-name descname">nStar</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.nStar" title="Permalink to this definition">¶</a></dt>
<dd><p>The LTE populations of the species.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.nTotal">
<code class="sig-name descname">nTotal</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.nTotal" title="Permalink to this definition">¶</a></dt>
<dd><p>The total species population at each point in the atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.detailed">
<code class="sig-name descname">detailed</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.detailed" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the species has detailed populations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.pops">
<code class="sig-name descname">pops</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.pops" title="Permalink to this definition">¶</a></dt>
<dd><p>The NLTE populations for the species, if detailed is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.radiativeRates">
<code class="sig-name descname">radiativeRates</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.radiativeRates" title="Permalink to this definition">¶</a></dt>
<dd><p>If detailed the radiative rates for the species will be present here,
stored under (i, j) and (j, i) for each transition.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[(int, int), np.ndarray], optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.dimensioned_unit_view">
<code class="sig-name descname">dimensioned_unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.dimensioned_unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of AtomicState reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model,
and the correct <cite>astropy.units</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>tuple</em>) – The shape to reshape to, this can be obtained from Atmosphere.structure.dimensioned_shape</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – An instance of self with the arrays reshaped to the appropriate
dimensionality.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState">AtomicState</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.dimensioned_view">
<code class="sig-name descname">dimensioned_view</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.dimensioned_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of AtomicState reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model, as
these are all stored under a flat scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>tuple</em>) – The shape to reshape to, this can be obtained from Atmosphere.structure.dimensioned_shape</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – An instance of self with the arrays reshaped to the appropriate
dimensionality.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState">AtomicState</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.element">
<em class="property">property </em><code class="sig-name descname">element</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.element" title="Permalink to this definition">¶</a></dt>
<dd><p>The element associated with this model.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.mass">
<em class="property">property </em><code class="sig-name descname">mass</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>The mass of the element associated with this model.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.n">
<em class="property">property </em><code class="sig-name descname">n</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.n" title="Permalink to this definition">¶</a></dt>
<dd><p>The NLTE populations, if present, or the LTE populations.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the element associated with this model.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.set_n_to_lte">
<code class="sig-name descname">set_n_to_lte</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.set_n_to_lte" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the NLTE populations to LTE.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.unit_view">
<code class="sig-name descname">unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of the AtomicState with the correct
<cite>astropy.units</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.update_nTotal">
<code class="sig-name descname">update_nTotal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">lightweaver.atmosphere.Atmosphere</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.update_nTotal" title="Permalink to this definition">¶</a></dt>
<dd><p>Update nTotal assuming either the abundance or nHTot have changed.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_set.AtomicStateTable">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">AtomicStateTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState">lightweaver.atomic_set.AtomicState</a><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.AtomicStateTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for AtomicStates.</p>
<p>The __getitem__ on this class is intended to be smart, and should work
correctly with ints, strings, or Elements and return the associated
AtomicState.
This object is not normally constructed directly by the user, but will
instead be interacted with as a means of transporting information to and
from the backend.</p>
<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicStateTable.dimensioned_unit_view">
<code class="sig-name descname">dimensioned_unit_view</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.AtomicStateTable.dimensioned_unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of AtomicStateTable reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model,
and the correct <cite>astropy.units</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>tuple</em>) – The shape to reshape to, this can be obtained from Atmosphere.structure.dimensioned_shape</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – An instance of self with the arrays reshaped to the appropriate
dimensionality.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable">AtomicStateTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicStateTable.dimensioned_view">
<code class="sig-name descname">dimensioned_view</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.AtomicStateTable.dimensioned_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of AtomicStateTable reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model, as
these are all stored under a flat scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>tuple</em>) – The shape to reshape to, this can be obtained from Atmosphere.structure.dimensioned_shape</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – An instance of self with the arrays reshaped to the appropriate
dimensionality.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable">AtomicStateTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicStateTable.unit_view">
<code class="sig-name descname">unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.AtomicStateTable.unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of the AtomicStateTable with the correct
<cite>astropy.units</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_set.RadiativeSet">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">RadiativeSet</code><span class="sig-paren">(</span><em class="sig-param">atoms: List[lightweaver.atomic_model.AtomicModel], abundance: lightweaver.atomic_table.AtomicAbundance = &lt;lightweaver.atomic_table.AtomicAbundance object&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Used to configure the atomic models present in the simulation and then
set up the global wavelength grid and initial populations.
All atoms start passive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>list of AtomicModel</em>) – The atomic models to be used in the simulation (active, detailed, and
background).</p></li>
<li><p><strong>abundance</strong> (<a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance"><em>AtomicAbundance</em></a><em>, </em><em>optional</em>) – The abundance to be used for each species.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.abundance">
<code class="sig-name descname">abundance</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.abundance" title="Permalink to this definition">¶</a></dt>
<dd><p>The abundances in use.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">AtomicAbundance</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.elements">
<code class="sig-name descname">elements</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.elements" title="Permalink to this definition">¶</a></dt>
<dd><p>The elements present in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of Elements</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.atoms">
<code class="sig-name descname">atoms</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Mapping from Element to associated model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[<a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a>, <a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">AtomicModel</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.passiveSet">
<code class="sig-name descname">passiveSet</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.passiveSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Set of atoms (designmated by their Elements) set to passive in the
simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set of Elements</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.detailedStaticSet">
<code class="sig-name descname">detailedStaticSet</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.detailedStaticSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Set of atoms (designmated by their Elements) set to “detailed static” in the
simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set of Elements</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.activeSet">
<code class="sig-name descname">activeSet</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.activeSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Set of atoms (designmated by their Elements) set to active in the
simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set of Elements</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.activeAtoms">
<em class="property">property </em><code class="sig-name descname">activeAtoms</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.activeAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>List of AtomicModels set to active.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.compute_eq_pops">
<code class="sig-name descname">compute_eq_pops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">lightweaver.atmosphere.Atmosphere</span></em>, <em class="sig-param"><span class="n">mols</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable">lightweaver.molecule.MolecularTable</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nlteStartingPops</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Dict<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.compute_eq_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the starting populations for the simulation with all NLTE
atoms in LTE or otherwise using the provided populations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere for which to compute the populations.</p></li>
<li><p><strong>mols</strong> (<a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable"><em>MolecularTable</em></a><em>, </em><em>optional</em>) – Molecules to be included in the populations (default: None)</p></li>
<li><p><strong>nlteStartingPops</strong> (<em>Dict</em><em>[</em><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element"><em>Element</em></a><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Starting population override for any active or detailed static
species.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eqPops</strong> – The configured initial populations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SpeciesStatTable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.compute_wavelength_grid">
<code class="sig-name descname">compute_wavelength_grid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">extraWavelengths</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lambdaReference</span><span class="o">=</span><span class="default_value">500.0</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration">lightweaver.atomic_set.SpectrumConfiguration</a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.compute_wavelength_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the global wavelength grid from the current configuration of
the RadiativeSet.
:param extraWavelengths: Extra wavelengths to add to the global array [nm].
:type extraWavelengths: np.ndarray, optional
:param lambdaReference: If a difference reference wavelength is to be used then it should</p>
<blockquote>
<div><p>be specified here to ensure it is in the global array.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>spect</strong> – The configured wavelength grids needed to set up the backend.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration">SpectrumConfiguration</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.detailedAtoms">
<em class="property">property </em><code class="sig-name descname">detailedAtoms</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.detailedAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>List of AtomicModels set to detailed static.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.is_active">
<code class="sig-name descname">is_active</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>str<span class="p">, </span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.is_active" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if an atom (designated by int, (int, int), str, or Element) is
active.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.is_detailed">
<code class="sig-name descname">is_detailed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>str<span class="p">, </span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.is_detailed" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if an atom (designated by int, (int, int), str, or Element) is
passive.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.is_passive">
<code class="sig-name descname">is_passive</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>str<span class="p">, </span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.is_passive" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if an atom (designated by int, (int, int), str, or Element) is
passive.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.iterate_lte_ne_eq_pops">
<code class="sig-name descname">iterate_lte_ne_eq_pops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">lightweaver.atmosphere.Atmosphere</span></em>, <em class="sig-param"><span class="n">mols</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable">lightweaver.molecule.MolecularTable</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nlteStartingPops</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Dict<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">direct</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable">lightweaver.atomic_set.SpeciesStateTable</a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.iterate_lte_ne_eq_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the starting populations for the simulation with all NLTE
atoms in LTE or otherwise using the provided populations.
Additionally computes a self-consistent LTE electron density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere for which to compute the populations.</p></li>
<li><p><strong>mols</strong> (<a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable"><em>MolecularTable</em></a><em>, </em><em>optional</em>) – Molecules to be included in the populations (default: None)</p></li>
<li><p><strong>nlteStartingPops</strong> (<em>Dict</em><em>[</em><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element"><em>Element</em></a><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Starting population override for any active or detailed static
species.</p></li>
<li><p><strong>direct</strong> (<em>bool</em>) – Whether to use the direct electron density solver (essentially, Lambda iteration for the fixpoint), this may require many more iterations than the Newton-Krylov solver used otherwise, but may also be more robust.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eqPops</strong> – The configured initial populations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SpeciesStatTable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.passiveAtoms">
<em class="property">property </em><code class="sig-name descname">passiveAtoms</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.passiveAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>List of AtomicModels set to passive.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.set_active">
<code class="sig-name descname">set_active</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.set_active" title="Permalink to this definition">¶</a></dt>
<dd><p>Set one (or multiple) atoms active.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.set_detailed_static">
<code class="sig-name descname">set_detailed_static</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.set_detailed_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Set one (or multiple) atoms to detailed static</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.set_passive">
<code class="sig-name descname">set_passive</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.set_passive" title="Permalink to this definition">¶</a></dt>
<dd><p>Set one (or multiple) atoms passive.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_set.SpeciesStateTable">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">SpeciesStateTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmosphere</span><span class="p">:</span> <span class="n">lightweaver.atmosphere.Atmosphere</span></em>, <em class="sig-param"><span class="n">abundance</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">lightweaver.atomic_table.AtomicAbundance</a></span></em>, <em class="sig-param"><span class="n">atomicPops</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable">lightweaver.atomic_set.AtomicStateTable</a></span></em>, <em class="sig-param"><span class="n">molecularTable</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable">lightweaver.molecule.MolecularTable</a></span></em>, <em class="sig-param"><span class="n">molecularPops</span><span class="p">:</span> <span class="n">List<span class="p">[</span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">HminPops</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for the species populations in the simulation. Similar to
AtomicStateTable but also holding the molecular populations and the
atmosphere object.</p>
<p>The __getitem__ is intended to be smart, returning in order of priority
on the name match (int, str, Element), H- populations, molecular
populations, NLTE atomic populations, LTE atomic populations.
This object is not normally constructed directly by the user, but will
instead be interacted with as a means of transporting information to and
from the backend.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.atmosphere">
<code class="sig-name descname">atmosphere</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.atmosphere" title="Permalink to this definition">¶</a></dt>
<dd><p>The atmosphere object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Atmosphere</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.abundance">
<code class="sig-name descname">abundance</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.abundance" title="Permalink to this definition">¶</a></dt>
<dd><p>The abundance of all species present in the atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">AtomicAbundance</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.atomicPops">
<code class="sig-name descname">atomicPops</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.atomicPops" title="Permalink to this definition">¶</a></dt>
<dd><p>The atomic populations state container.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable">AtomicStateTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.molecularTable">
<code class="sig-name descname">molecularTable</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.molecularTable" title="Permalink to this definition">¶</a></dt>
<dd><p>The molecules present in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable">MolecularTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.molecularPops">
<code class="sig-name descname">molecularPops</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.molecularPops" title="Permalink to this definition">¶</a></dt>
<dd><p>The populations of each molecule in the molecularTable</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.HminPops">
<code class="sig-name descname">HminPops</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.HminPops" title="Permalink to this definition">¶</a></dt>
<dd><p>H- ion populations throughout the atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.SpeciesStateTable.dimensioned_unit_view">
<code class="sig-name descname">dimensioned_unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.dimensioned_unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of SpeciesStateTable reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model,
and the correct <cite>astropy.units</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.SpeciesStateTable.dimensioned_view">
<code class="sig-name descname">dimensioned_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.dimensioned_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of SpeciesStateTable reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model, as
these are all stored under a flat scheme.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.SpeciesStateTable.unit_view">
<code class="sig-name descname">unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of the SpeciesStateTable with the correct
<cite>astropy.units</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.SpeciesStateTable.update_lte_atoms_Hmin_pops">
<code class="sig-name descname">update_lte_atoms_Hmin_pops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">lightweaver.atmosphere.Atmosphere</span></em>, <em class="sig-param"><span class="n">conserveCharge</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">updateTotals</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">maxIter</span><span class="o">=</span><span class="default_value">2000</span></em>, <em class="sig-param"><span class="n">quiet</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.001</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.update_lte_atoms_Hmin_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Under the assumption that the atmosphere has changed, update the LTE
atomic populations and the H- populations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere object.</p></li>
<li><p><strong>conserveCharge</strong> (<em>bool</em>) – Whether to conserveCharge and adjust the electron density in
atmos based on the change in ionisation of the non-detailed
species (default: False).</p></li>
<li><p><strong>updateTotals</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to update the totals of each species from the abundance
and total hydrogen density (default: False).</p></li>
<li><p><strong>maxIter</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of iterations to take looking for a stable
solution (default: 2000).</p></li>
<li><p><strong>quiet</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print information about the update (default: False)</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – The tolerance of relative change at which to consider the
populations converged (default: 1e-3)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_set.SpectrumConfiguration">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">SpectrumConfiguration</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">radSet</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_set.RadiativeSet" title="lightweaver.atomic_set.RadiativeSet">lightweaver.atomic_set.RadiativeSet</a></span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">models</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">lightweaver.atomic_model.AtomicModel</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">transWavelengths</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>Tuple<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">blueIdx</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>Tuple<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">activeTrans</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>Tuple<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>bool<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">activeWavelengths</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>Tuple<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for the configuration of common wavelength grid and species
active at each wavelength.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.radSet">
<code class="sig-name descname">radSet</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.radSet" title="Permalink to this definition">¶</a></dt>
<dd><p>The set of atoms involved in the creation of this simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.RadiativeSet" title="lightweaver.atomic_set.RadiativeSet">RadiativeSet</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.wavelength">
<code class="sig-name descname">wavelength</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>The common wavelength array used for this simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.models">
<code class="sig-name descname">models</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.models" title="Permalink to this definition">¶</a></dt>
<dd><p>The models for the active and detailed static atoms present in this
simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of AtomicModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.transWavelengths">
<code class="sig-name descname">transWavelengths</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.transWavelengths" title="Permalink to this definition">¶</a></dt>
<dd><p>The local wavelength grid for each transition stored in a dictionary
by transition ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[(<a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a>, i, j), np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.blueIdx">
<code class="sig-name descname">blueIdx</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.blueIdx" title="Permalink to this definition">¶</a></dt>
<dd><p>The index at which each local grid starts in the global wavelength
array.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[(<a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a>, i, j), int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.activeTrans">
<code class="sig-name descname">activeTrans</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.activeTrans" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this transition is ever active (contributing in either an
active or detailed static sense) over the range of wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[(<a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a>, i, j), bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.activeWavelengths">
<code class="sig-name descname">activeWavelengths</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.activeWavelengths" title="Permalink to this definition">¶</a></dt>
<dd><p>A mask of the wavelengths at which this transition is active.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[(<a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a>, i, j), np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.subset_configuration">
<code class="sig-name descname">subset_configuration</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelengths</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration">lightweaver.atomic_set.SpectrumConfiguration</a><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.subset_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a SpectrumConfiguration for a sub-region of the global wavelength array.</p>
<p>This is typically used for computing a final formal solution on a single ray through the atmosphere. In this situation all lines are set to contribute throughout the entire grid, to avoid situations where small jumps in intensity occur from lines being cut off.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelengths</strong> (<em>np.ndarray</em>) – The grid on which to produce the new SpectrumConfiguration.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spectrumConfig</strong> – The subset spectrum configuration.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration">SpectrumConfiguration</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_set.chemical_equilibrium_fixed_ne">
<code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">chemical_equilibrium_fixed_ne</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">lightweaver.atmosphere.Atmosphere</span></em>, <em class="sig-param"><span class="n">molecules</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable">lightweaver.molecule.MolecularTable</a></span></em>, <em class="sig-param"><span class="n">atomicPops</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable">lightweaver.atomic_set.AtomicStateTable</a></span></em>, <em class="sig-param"><span class="n">abundance</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">lightweaver.atomic_table.AtomicAbundance</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable">lightweaver.atomic_set.SpeciesStateTable</a><a class="headerlink" href="#lightweaver.atomic_set.chemical_equilibrium_fixed_ne" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the molecular populations from the current atmospheric model and
atomic populations.</p>
<p>This method assumes that the number of electrons bound in molecules is
insignificant, and neglects this.
Intended for internal use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The model atmosphere of the simulation.</p></li>
<li><p><strong>molecules</strong> (<a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable"><em>MolecularTable</em></a>) – The molecules to consider.</p></li>
<li><p><strong>atomicPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable"><em>AtomicStateTable</em></a>) – The atomic populations.</p></li>
<li><p><strong>abundance</strong> (<a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance"><em>AtomicAbundance</em></a>) – The abundance of each species in the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – The combined state object of atomic and molecular populations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SpeciesState</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_set.hminus_pops">
<code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">hminus_pops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">lightweaver.atmosphere.Atmosphere</span></em>, <em class="sig-param"><span class="n">hPops</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState">lightweaver.atomic_set.AtomicState</a></span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_set.hminus_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the H- ion populations for a given atmosphere</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere object.</p></li>
<li><p><strong>hPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState"><em>AtomicState</em></a>) – The hydrogen populations state associated with atmos.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>HminPops</strong> – The H- populations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_set.lte_pops">
<code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">lte_pops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atomicModel</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">lightweaver.atomic_model.AtomicModel</a></span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ne</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">nTotal</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">nStar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">debye</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_set.lte_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the LTE populations for a given atomic model under given
thermodynamic conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atomicModel</strong> (<a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel"><em>AtomicModel</em></a>) – The atomic model to consider.</p></li>
<li><p><strong>temperature</strong> (<em>np.ndarray</em>) – The temperature structure in the atmosphere.</p></li>
<li><p><strong>ne</strong> (<em>np.ndarray</em>) – The electron density in the atmosphere.</p></li>
<li><p><strong>nTotal</strong> (<em>np.ndarray</em>) – The total population of the species at each point in the atmosphere.</p></li>
<li><p><strong>nStar</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – An optional array to store the result in.</p></li>
<li><p><strong>debye</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to consider Debye shielding (default: True).1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ltePops</strong> – The ltePops for the species.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.atomic_table">
<span id="lightweaver-atomic-table-module"></span><h2>lightweaver.atomic_table module<a class="headerlink" href="#module-lightweaver.atomic_table" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.atomic_table.AtomicAbundance">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">AtomicAbundance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">abundanceData</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">abundDex</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">metallicity</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container and accessor for atomic abundance data. This can be
instantiated with a subset of atomic abundances, which will be used in
conjunction with the the default values for non-specified elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>abundanceData</strong> (<em>dict</em><em>, </em><em>optional</em>) – Contains the abundance data to override. For elements this should be
dict[Element] = abundance, and for isotopes dict[Isotope] = isotope
fraction.</p></li>
<li><p><strong>abundDex</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the supplied abundance is in dex (with Hydrogen abundance of
12.0) or in relative Hydrogen abundance (default: True i.e. in dex).</p></li>
<li><p><strong>metallicity</strong> (<em>float</em><em>, </em><em>optional</em>) – Enhance the metallic abundance by a factor of 10**metallicity,
(default: 0.0).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.apply_metallicity">
<em class="property">static </em><code class="sig-name descname">apply_metallicity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">abunds</span></em>, <em class="sig-param"><span class="n">metallicity</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.apply_metallicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to adjust the metallicity of the abundances, by a fraction
10**metallicity.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.compute_stats">
<code class="sig-name descname">compute_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.compute_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the total abundance (totalAbundance), mass per H atom
(massPerH), and average mass per Element (avgMass).</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.convert_isotopes_to_abundances">
<code class="sig-name descname">convert_isotopes_to_abundances</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.convert_isotopes_to_abundances" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the isotope fractions to relative Hydrogen abundance.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.dex_to_decimal">
<em class="property">static </em><code class="sig-name descname">dex_to_decimal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">abunds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.dex_to_decimal" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to convert from absolute abundance in dex to relative fractional
abundance.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.get_primary_isotope">
<code class="sig-name descname">get_primary_isotope</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_table.Isotope" title="lightweaver.atomic_table.Isotope">lightweaver.atomic_table.Isotope</a><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.get_primary_isotope" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Isotope with the highest abundance of a particular
Element.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.load_default_abundance_data">
<em class="property">static </em><code class="sig-name descname">load_default_abundance_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.load_default_abundance_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the default abundances and convert to required format for
AtomicAbundance class (i.e. dict where dict[Element] = abundance, and
dict[Isotope] = isotope fraction).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_table.Element">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">Element</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Z</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_table.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A simple value comparable description of an element (just proton number
Z), that can be quickly and easily compared, whilst allowing access to
things from the periodic table.</p>
<dl class="py method">
<dt id="lightweaver.atomic_table.Element.mass">
<em class="property">property </em><code class="sig-name descname">mass</code><a class="headerlink" href="#lightweaver.atomic_table.Element.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mass of the element in AMU.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.Element.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#lightweaver.atomic_table.Element.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the element as a string.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_table.Isotope">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">Isotope</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">Z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_table.Isotope" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_table.Element</span></code></a></p>
<p>A simple value comparable isotope description, inheriting from Element.</p>
<dl class="py method">
<dt id="lightweaver.atomic_table.Isotope.element">
<em class="property">property </em><code class="sig-name descname">element</code><a class="headerlink" href="#lightweaver.atomic_table.Isotope.element" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the underlying Element of which this isotope is a family
member.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.Isotope.element_mass">
<em class="property">property </em><code class="sig-name descname">element_mass</code><a class="headerlink" href="#lightweaver.atomic_table.Isotope.element_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average mass of the element.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.Isotope.element_name">
<em class="property">property </em><code class="sig-name descname">element_name</code><a class="headerlink" href="#lightweaver.atomic_table.Isotope.element_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the Element as a string.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.Isotope.mass">
<em class="property">property </em><code class="sig-name descname">mass</code><a class="headerlink" href="#lightweaver.atomic_table.Isotope.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mass of the isotope in AMU.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.Isotope.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#lightweaver.atomic_table.Isotope.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the isotope as a string.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_table.KuruczPf">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">KuruczPf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a></span></em>, <em class="sig-param"><span class="n">abundance</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">Tpf</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">pf</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ionPot</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage and functions relating to Bob Kurucz’s partition functions.
Based on the data used in RH.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_table.KuruczPf.element">
<code class="sig-name descname">element</code><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.element" title="Permalink to this definition">¶</a></dt>
<dd><p>The element associated with this partition funciton.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_table.KuruczPf.abundance">
<code class="sig-name descname">abundance</code><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.abundance" title="Permalink to this definition">¶</a></dt>
<dd><p>The abundance of this element.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_table.KuruczPf.Tpf">
<code class="sig-name descname">Tpf</code><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.Tpf" title="Permalink to this definition">¶</a></dt>
<dd><p>The temperature grid on which the partition function is defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_table.KuruczPf.pf">
<code class="sig-name descname">pf</code><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.pf" title="Permalink to this definition">¶</a></dt>
<dd><p>The partition function data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_table.KuruczPf.ionPot">
<code class="sig-name descname">ionPot</code><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.ionPot" title="Permalink to this definition">¶</a></dt>
<dd><p>The ionisation potential of each level.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.KuruczPf.fj">
<code class="sig-name descname">fj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.fj" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the fractional population of the species in each ionisation
stage and partial derivative wrt n_e for each location in a given
atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere in which to compute the populations.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fj</strong> (<em>np.ndarray</em>) – The fractional populations [Nstage x Nspace].</p></li>
<li><p><strong>dfj</strong> (<em>np.ndarray</em>) – The derivatives of the fractional populations [Nstage x Nspace].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.KuruczPf.fjk">
<code class="sig-name descname">fjk</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">k</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.fjk" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the fractional population of the species in each ionisation
stage and partial derivative wrt n_e at one point in a given
atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere in which to compute the populations.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – The spatial index at which to compute the populations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fj</strong> (<em>np.ndarray</em>) – The fractional populations [Nstage].</p></li>
<li><p><strong>dfj</strong> (<em>np.ndarray</em>) – The derivatives of the fractional populations [Nstage].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.KuruczPf.lte_ionisation">
<code class="sig-name descname">lte_ionisation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.lte_ionisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the population of the species in each ionisation
stage in a given atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere in which to compute the populations.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pops</strong> – The LTE ionisation populations [Nstage x Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_table.KuruczPfTable">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">KuruczPfTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atomicAbundance</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">lightweaver.atomic_table.AtomicAbundance</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kuruczPfPath</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_table.KuruczPfTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for all of the Kurucz partition function data, allowing
different paths and AtomicAbundances to be used. Serves to construct the
KuruczPf objects if used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atomicAbundance</strong> (<a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance"><em>AtomicAbundance</em></a><em>, </em><em>optional</em>) – The abundance data to use, if non-standard.</p></li>
<li><p><strong>kuruczPfPath</strong> (<em>str</em>) – The path to the Kurucz parition function data in RH’s XDR format, if
non-standard.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_table.PeriodicTableData">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">PeriodicTableData</code><a class="headerlink" href="#lightweaver.atomic_table.PeriodicTableData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container and accessor for the periodic table data. Not intended to be
instantiated by users, instead use the pre-instantiated PeriodicTable
instance.</p>
<dl class="py method">
<dt id="lightweaver.atomic_table.PeriodicTableData.elements">
<em class="property">property </em><code class="sig-name descname">elements</code><a class="headerlink" href="#lightweaver.atomic_table.PeriodicTableData.elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sorted list of Elements by proton number Z.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.PeriodicTableData.get_isotopes">
<em class="property">classmethod </em><code class="sig-name descname">get_isotopes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a></span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Isotope" title="lightweaver.atomic_table.Isotope">lightweaver.atomic_table.Isotope</a><span class="p">]</span><a class="headerlink" href="#lightweaver.atomic_table.PeriodicTableData.get_isotopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all isotopes associated with a certain Element.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.PeriodicTableData.isotopes">
<em class="property">property </em><code class="sig-name descname">isotopes</code><a class="headerlink" href="#lightweaver.atomic_table.PeriodicTableData.isotopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sorted list of Isotopes by proton number Z.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.PeriodicTableData.nuclides">
<em class="property">property </em><code class="sig-name descname">nuclides</code><a class="headerlink" href="#lightweaver.atomic_table.PeriodicTableData.nuclides" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all nuclides (Elements and Isotopes).</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_table.load_periodic_table_data">
<code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">load_periodic_table_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.atomic_table.load_periodic_table_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal use function to load data from the AtomicMassesNames.pickle data
file.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_table.normalise_atom_name">
<code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">normalise_atom_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#lightweaver.atomic_table.normalise_atom_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalises Element names to be two characters long with an uppercase
first letter, and lower case second, or a space in the case of single
character names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<em>str</em>) – The name to normalise.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – The normalised name.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.barklem">
<span id="lightweaver-barklem-module"></span><h2>lightweaver.barklem module<a class="headerlink" href="#module-lightweaver.barklem" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.barklem.Barklem">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.barklem.</code><code class="sig-name descname">Barklem</code><a class="headerlink" href="#lightweaver.barklem.Barklem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage for all three Barklem cross-section cases and application via the
<cite>get_active_cross_section</cite> function.</p>
<dl class="py method">
<dt id="lightweaver.barklem.Barklem.get_active_cross_section">
<em class="property">classmethod </em><code class="sig-name descname">get_active_cross_section</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span><span class="p">:</span> <span class="n">AtomicModel</span></em>, <em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n">AtomicLine</span></em>, <em class="sig-param"><span class="n">vals</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Sequence<span class="p">[</span>float<span class="p">]</span><a class="headerlink" href="#lightweaver.barklem.Barklem.get_active_cross_section" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cross section data for use in the Van der Waals collisional broadening routines.
See</p>
<blockquote>
<div><p>Anstee &amp; O’Mara 1995, MNRAS 276, 859-866
Barklem &amp; O’Mara 1998, MNRAS 300, 863-871
Unsold:
Traving 1960, “Uber die Theorie der Druckverbreiterung</p>
<blockquote>
<div><p>von Spektrallinien”, p 91-97</p>
</div></blockquote>
<p>Mihalas 1978, p. 282ff, and Table 9-1/</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>result</strong> – Barklem cross-section, Barklem alpha, Helium contribution
following Unsold (always 1.0)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of 3 float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="lightweaver.barklem.BarklemCrossSectionError">
<em class="property">exception </em><code class="sig-prename descclassname">lightweaver.barklem.</code><code class="sig-name descname">BarklemCrossSectionError</code><a class="headerlink" href="#lightweaver.barklem.BarklemCrossSectionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raised if the Barklem cross-section cannot be applied to the atom in
question.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.barklem.BarklemTable">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.barklem.</code><code class="sig-name descname">BarklemTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">neff0</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.barklem.BarklemTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage for each table of Barklem data for Van der Waals approximation.</p>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.broadening">
<span id="lightweaver-broadening-module"></span><h2>lightweaver.broadening module<a class="headerlink" href="#module-lightweaver.broadening" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.broadening.HydrogenLinearStarkBroadening">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">HydrogenLinearStarkBroadening</code><a class="headerlink" href="#lightweaver.broadening.HydrogenLinearStarkBroadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.StandardLineBroadener</span></code></a></p>
<p>Linear Stark broadening for the case of Hydrogen from Sutton 1978 (like
RH).</p>
<dl class="py method">
<dt id="lightweaver.broadening.HydrogenLinearStarkBroadening.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.broadening.HydrogenLinearStarkBroadening.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.LineBroadener">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">LineBroadener</code><a class="headerlink" href="#lightweaver.broadening.LineBroadener" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for broadening implementations. To be used if your broadener
does something special and can’t just return an array.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.LineBroadening">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">LineBroadening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">natural</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener">lightweaver.broadening.StandardLineBroadener</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">elastic</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener">lightweaver.broadening.StandardLineBroadener</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span><a class="reference internal" href="#lightweaver.broadening.LineBroadener" title="lightweaver.broadening.LineBroadener">lightweaver.broadening.LineBroadener</a><span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.broadening.LineBroadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Standard component of AtomicLine to compute the broadening parameters in
a flexible way.</p>
<p>For most Voigt-like situations, this should be usable without
modifications, but this class can be inherited from to make substantial
modifications.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>natural</strong> (<em>list of StandardLineBroadener</em>) – List of broadening terms that are not elastic collisions (separated for PRD).</p></li>
<li><p><strong>elastic</strong> (<em>list of StandardLineBroadener</em>) – List of elastic broadening terms.</p></li>
<li><p><strong>other</strong> (<em>list of LineBroadener</em><em>, </em><em>optional</em>) – List of other broadening terms, not used by the VoigtLine by default,
but existing to provide _options_ (default: None)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="lightweaver.broadening.LineBroadening.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.broadening.LineBroadeningResult" title="lightweaver.broadening.LineBroadeningResult">lightweaver.broadening.LineBroadeningResult</a><a class="headerlink" href="#lightweaver.broadening.LineBroadening.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the broadening, this function is called by the AtomicLine object.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.broadening.LineBroadening.compute_other_broadening">
<em class="property">static </em><code class="sig-name descname">compute_other_broadening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">broadeners</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span><a class="reference internal" href="#lightweaver.broadening.LineBroadener" title="lightweaver.broadening.LineBroadener">lightweaver.broadening.LineBroadener</a><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>List<span class="p">]</span><a class="headerlink" href="#lightweaver.broadening.LineBroadening.compute_other_broadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the computed broadening terms.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.broadening.LineBroadening.sum_broadening_list">
<em class="property">static </em><code class="sig-name descname">sum_broadening_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">broadeners</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener">lightweaver.broadening.StandardLineBroadener</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span><a class="headerlink" href="#lightweaver.broadening.LineBroadening.sum_broadening_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Sums a list of StandardLineBroadeners.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.LineBroadeningResult">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">LineBroadeningResult</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">natural</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">Qelast</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.broadening.LineBroadeningResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Result expected from instances of <cite>LineBroadening.broaden</cite>.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.MultiplicativeStarkBroadening">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">MultiplicativeStarkBroadening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coeff</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.broadening.MultiplicativeStarkBroadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.StandardLineBroadener</span></code></a></p>
<p>Simple expression for multiplicative Stark broadening, assumes that this
can be expresed as a constant * ne.</p>
<dl class="py method">
<dt id="lightweaver.broadening.MultiplicativeStarkBroadening.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.broadening.MultiplicativeStarkBroadening.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.QuadraticStarkBroadening">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">QuadraticStarkBroadening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coeff</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.broadening.QuadraticStarkBroadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.StandardLineBroadener</span></code></a></p>
<p>Lindholm theory result for Quadratic Stark broadening by electrons and
singly ionised particles.
Follows HM2014 pp. 238-239, uses C4 from Traving 1960 via RH.</p>
<dl class="py method">
<dt id="lightweaver.broadening.QuadraticStarkBroadening.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.broadening.QuadraticStarkBroadening.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.RadiativeBroadening">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">RadiativeBroadening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gamma</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.broadening.RadiativeBroadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.StandardLineBroadener</span></code></a></p>
<p>Simple constant radiative broadening with coefficient gamma.</p>
<dl class="py method">
<dt id="lightweaver.broadening.RadiativeBroadening.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.broadening.RadiativeBroadening.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.StandardLineBroadener">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">StandardLineBroadener</code><a class="headerlink" href="#lightweaver.broadening.StandardLineBroadener" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.LineBroadener" title="lightweaver.broadening.LineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.LineBroadener</span></code></a></p>
<p>Standard base class for broadening implementations. Unless you need to do
something weird, inherit from this one.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.VdwApprox">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">VdwApprox</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.broadening.VdwApprox" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.StandardLineBroadener</span></code></a></p>
<p>Base class for van der Waals approximation using a list of coefficients
(vals).</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.VdwBarklem">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">VdwBarklem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.broadening.VdwBarklem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.VdwApprox" title="lightweaver.broadening.VdwApprox"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.VdwApprox</span></code></a></p>
<p>Implementation of the Barklem method for van der Waals broadening.</p>
<dl class="py method">
<dt id="lightweaver.broadening.VdwBarklem.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.broadening.VdwBarklem.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.VdwUnsold">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">VdwUnsold</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.broadening.VdwUnsold" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.VdwApprox" title="lightweaver.broadening.VdwApprox"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.VdwApprox</span></code></a></p>
<p>Implementation of the Unsold method for van der Waals broadening.</p>
<dl class="py method">
<dt id="lightweaver.broadening.VdwUnsold.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.broadening.VdwUnsold.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="lightweaver-collisional-rates-module">
<h2>lightweaver.collisional_rates module<a class="headerlink" href="#lightweaver-collisional-rates-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="lightweaver-fal-module">
<h2>lightweaver.fal module<a class="headerlink" href="#lightweaver-fal-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-lightweaver.molecule">
<span id="lightweaver-molecule-module"></span><h2>lightweaver.molecule module<a class="headerlink" href="#module-lightweaver.molecule" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.molecule.MolecularTable">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.molecule.</code><code class="sig-name descname">MolecularTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">paths</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.molecule.MolecularTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stores a set of molecular models, can be indexed by model name to return
the associated model (as a string).</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.molecule.Molecule">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.molecule.</code><code class="sig-name descname">Molecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filePath</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.molecule.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Simple class for working with RH molecule definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filePath</strong> (<em>str</em>) – Path from which to load molecular data. Use
<cite>get_default_molecule_path</cite> for the path to the default RH
distribution of molecule files (C2, CH, CN, CO, CaH, H2+, H2, H2O,
HF, LiH, MgH, N2, NH, NO, O2, OH, SiO, TiO) all of which have the
‘.molecule’ extension.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.multi">
<span id="lightweaver-multi-module"></span><h2>lightweaver.multi module<a class="headerlink" href="#module-lightweaver.multi" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.multi.MultiMetadata">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.multi.</code><code class="sig-name descname">MultiMetadata</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">logG</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.multi.MultiMetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Metadata that is stored in a MULTI atmosphere, but doesn’t really belong
in a Lightweaver atmosphere.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.multi.read_multi_atmos">
<code class="sig-prename descclassname">lightweaver.multi.</code><code class="sig-name descname">read_multi_atmos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span><a class="reference internal" href="#lightweaver.multi.MultiMetadata" title="lightweaver.multi.MultiMetadata">lightweaver.multi.MultiMetadata</a><span class="p">, </span>lightweaver.atmosphere.Atmosphere<span class="p">]</span><a class="headerlink" href="#lightweaver.multi.read_multi_atmos" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a MULTI atmosphere definition from a file for use in Lightweaver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The path to load the file from.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>meta</strong> (<em>MultiMetadata</em>) – Additional metadata from the MULTI metadata that doesn’t appear in a Lightweaver atmosphere (name, gravitational acceleration used).</p></li>
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere loaded into the standard Lightweaver format.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError if file isn't found</strong><strong>, or </strong><strong>cannot be parsed correctly.</strong> – </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.nr_update">
<span id="lightweaver-nr-update-module"></span><h2>lightweaver.nr_update module<a class="headerlink" href="#module-lightweaver.nr_update" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="lightweaver.nr_update.nr_post_update">
<code class="sig-prename descclassname">lightweaver.nr_update.</code><code class="sig-name descname">nr_post_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">fdCollisionRates</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">hOnly</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">timeDependentData</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chunkSize</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">ngUpdate</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">printUpdate</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.nr_update.nr_post_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Newton-Raphson terms for updating the electron density
through charge conservation. Is attached to the Context object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fdCollisionRates</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use a finite difference approximation to the collisional
rates to find the population gradient WRT ne (default: True i.e. use
finite-difference, if False, collisional rates are ignored for this
process.)</p></li>
<li><p><strong>hOnly</strong> (<em>bool</em><em>, </em><em>optional</em>) – Ignore atoms other than Hydrogen (the primary electron contributor)
(default: False)</p></li>
<li><p><strong>timeDependentData</strong> (<em>dict</em><em>, </em><em>optional</em>) – The presence of this argument indicates that the time-dependent
formalism should be used. Should contain the keys ‘dt’ with a
floating point timestep, and ‘nPrev’ with a list of population
vectors from the start of the time integration step, in the order of
the active atoms. This latter term can be obtained from the previous
state provied by <cite>Context.time_dep_update</cite>.</p></li>
<li><p><strong>chunkSize</strong> (<em>int</em><em>, </em><em>optional</em>) – Not currently used.</p></li>
<li><p><strong>ngUpdate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply Ng Acceleration (default: None, to apply automatic
behaviour), will only accelerate if the counter on the Ng accelerator
has seen enough steps since the previous acceleration (set in Context
initialisation).</p></li>
<li><p><strong>printUpdate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print information on the size of the update (default:
None, to apply automatic behaviour).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dPops</strong> – The maximum relative change of any of the NLTE populations in the
atmosphere.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="lightweaver-rh-atoms-module">
<h2>lightweaver.rh_atoms module<a class="headerlink" href="#lightweaver-rh-atoms-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-lightweaver.utils">
<span id="lightweaver-utils-module"></span><h2>lightweaver.utils module<a class="headerlink" href="#module-lightweaver.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="lightweaver.utils.ConvergenceError">
<em class="property">exception </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">ConvergenceError</code><a class="headerlink" href="#lightweaver.utils.ConvergenceError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raised by some iteration schemes, can also be used in user code.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.utils.CrswIterator">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">CrswIterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">initVal</span><span class="o">=</span><span class="default_value">1000.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.utils.CrswIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic iterator to be used for controlling the scale of the collisional
radiative switching (of Hummer &amp; Voels) multiplicative paramter. Can be
inherited to provide different behaviour. By default starts from a factor
of 1e3 and scales this factor by 0.1**(1.0/value) each iteration, as is
the default behaviour in RH.</p>
</dd></dl>

<dl class="py exception">
<dt id="lightweaver.utils.ExplodingMatrixError">
<em class="property">exception </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">ExplodingMatrixError</code><a class="headerlink" href="#lightweaver.utils.ExplodingMatrixError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raised by the linear system matrix solver in the case of unsolvable
systems.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.utils.InitialSolution">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">InitialSolution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.utils.InitialSolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Initial solutions to use for atomic populations, either LTE, Zero
radiation (not yet supported), or second order escape probability.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.utils.NgOptions">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">NgOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Norder</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">Nperiod</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">Ndelay</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.utils.NgOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for the options related to Ng acceleration.
.. attribute:: Norder</p>
<blockquote>
<div><p>The order of the extrapolation to use (default: 0, i.e. none).</p>
<dl class="field-list simple">
<dt class="field-odd">type</dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</div></blockquote>
<dl class="py attribute">
<dt id="lightweaver.utils.NgOptions.Nperiod">
<code class="sig-name descname">Nperiod</code><a class="headerlink" href="#lightweaver.utils.NgOptions.Nperiod" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of iterations to run between extrapolations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.utils.NgOptions.Ndelay">
<code class="sig-name descname">Ndelay</code><a class="headerlink" href="#lightweaver.utils.NgOptions.Ndelay" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of iterations to run before starting acceleration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.utils.UnityCrswIterator">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">UnityCrswIterator</code><a class="headerlink" href="#lightweaver.utils.UnityCrswIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.utils.CrswIterator" title="lightweaver.utils.CrswIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.utils.CrswIterator</span></code></a></p>
<p>A specific case representing no collisional radiative switching (i.e.
parameter always 1).</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.air_to_vac">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">air_to_vac</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.utils.air_to_vac" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert air wavelength to vacuum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelength</strong> (<em>float</em><em> or </em><em>array-like</em><em> or </em><em>astropy.Quantity</em>) – If no units then the wavelength is assumed to be in [nm], otherwise the provided units are used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – The converted wavelength in [nm].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like or astropy.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.convert_specific_intensity">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">convert_specific_intensity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">specInt</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">outUnits</span></em><span class="sig-paren">)</span> &#x2192; astropy.units.quantity.Quantity<a class="headerlink" href="#lightweaver.utils.convert_specific_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a specific intensity between different units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelength</strong> (<em>np.ndarray</em><em> or </em><em>astropy.Quantity</em>) – If no units are provided then this is assumed to be in nm.</p></li>
<li><p><strong>specInt</strong> (<em>np.ndarray</em><em> or </em><em>astropy.Quantity</em>) – If no units are provided then this is assumed to be in J/s/m2/sr/Hz,
the default for Lightweaver.</p></li>
<li><p><strong>outUnits</strong> (<em>str</em><em> or </em><em>astropy.Unit</em>) – The units to convert specInt to e.g. ‘erg/s/cm2/sr/A’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – specInt converted to the desired units.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.gaunt_bf">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">gaunt_bf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wvl</span></em>, <em class="sig-param"><span class="n">nEff</span></em>, <em class="sig-param"><span class="n">charge</span></em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#lightweaver.utils.gaunt_bf" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaunt factor for bound-free transitions, from Seaton (1960), Rep. Prog.
Phys. 23, 313, as used in RH.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wvl</strong> (<em>float</em><em> or </em><em>array-like</em>) – The wavelength at which to compute the Gaunt factor [nm].</p></li>
<li><p><strong>nEff</strong> (<em>float</em>) – Principal quantum number.</p></li>
<li><p><strong>charge</strong> (<em>float</em>) – Charge of free state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – Gaunt factor for bound-free transitions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.get_data_path">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">get_data_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.utils.get_data_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the location of the Lightweaver support data.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.get_default_molecule_path">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">get_default_molecule_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.utils.get_default_molecule_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the location of the default molecules taken from RH.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.planck">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">planck</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temp</span></em>, <em class="sig-param"><span class="n">wav</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.utils.planck" title="Permalink to this definition">¶</a></dt>
<dd><p>Planck black-body function B_nu(T) from wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em> or </em><em>array-like</em>) – Temperature [K]</p></li>
<li><p><strong>wav</strong> (<em>float</em><em> or </em><em>array-like</em>) – The wavelength at which to compute B_nu [nm].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – B_nu(T)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.sequence_repr">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">sequence_repr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">Sequence</span></em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#lightweaver.utils.sequence_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Uniform representation of arrays and lists as lists for use in
round-tripping AtomicModels.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.vac_to_air">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">vac_to_air</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.utils.vac_to_air" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert vacuum wavelength to air.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelength</strong> (<em>float</em><em> or </em><em>array-like</em><em> or </em><em>astropy.Quantity</em>) – If no units then the wavelength is assumed to be in [nm], otherwise the provided units are used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – The converted wavelength in [nm].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like or astropy.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.view_flatten">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">view_flatten</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#lightweaver.utils.view_flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a flattened view over an array, will raise an Exception if it
cannot be represented as a flat array without copy.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.voigt_H">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">voigt_H</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">v</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.utils.voigt_H" title="Permalink to this definition">¶</a></dt>
<dd><p>Scalar Voigt profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>float</em><em> or </em><em>array-like</em>) – The a damping parameter to be used in the Voigt profile.</p></li>
<li><p><strong>v</strong> (<em>float</em><em> or </em><em>array-like</em>) – The position in the line profile in Doppler units.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.witt">
<span id="lightweaver-witt-module"></span><h2>lightweaver.witt module<a class="headerlink" href="#module-lightweaver.witt" title="Permalink to this headline">¶</a></h2>
<p>Simple EOS and background opacity package
Coded in python by J. de la Cruz Rodriguez (ISP-SU 2017)</p>
<dl class="py class">
<dt id="lightweaver.witt.witt">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.witt.</code><code class="sig-name descname">witt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">abund_init</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">prec</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">pf_file</span><span class="o">=</span><span class="default_value">'pf_Kurucz.input'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.witt.witt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>EOS described in Mihalas (1970) “Stellar atmospheres”
It considers in detail H, H+, H- and H2, no other molecules.</p>
<p>This particular implementation was taken from Wittmann’s routines.
Partition functions from Kurucz.</p>
<p>Coded in python by J. de la Cruz Rodriguez (ISP-SU 2017)
Messed with by C. Osborne (University of Glasgow 2019-2020)</p>
<blockquote>
<div><p>Don’t blame Jaime for EOS bugs in Lightweaver!</p>
</div></blockquote>
<p>Dependencies: pf_Kurucz.input containing the partition function data.</p>
<dl class="py method">
<dt id="lightweaver.witt.witt.partition_f">
<code class="sig-name descname">partition_f</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">only</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.witt.witt.partition_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the partition function of element “n” for a given temperature</p>
<dl class="simple">
<dt>input:</dt><dd><p>n: Atomic number of the atom -1 (H is 0).
t: Temperature in K.</p>
</dd>
<dt>Keywords:</dt><dd><dl class="simple">
<dt>only: (=int) only return this number first levels of the atom.</dt><dd><p>The default is to return all the levels</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lightweaver.zeeman">
<span id="lightweaver-zeeman-module"></span><h2>lightweaver.zeeman module<a class="headerlink" href="#module-lightweaver.zeeman" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.zeeman.ZeemanComponents">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">ZeemanComponents</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">strength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">shift</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.zeeman.ZeemanComponents" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage for communicating the Zeeman components between functions, also
shared with the backend, giving a slightly tighter contract than usual:
all arrays must be contiguous and alpha must be of dtype np.int32.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.zeeman.compute_zeeman_components">
<code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">compute_zeeman_components</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n">AtomicLine</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.zeeman.ZeemanComponents" title="lightweaver.zeeman.ZeemanComponents">lightweaver.zeeman.ZeemanComponents</a><span class="p">]</span><a class="headerlink" href="#lightweaver.zeeman.compute_zeeman_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes, if possible, the set of Zeeman components for an atomic line.</p>
<p>If gLandeEff is specified on the line, then basic three-component Zeeman
splitting will be computed directly.
Otherwise, if both the lower and upper levels of the line support
LS-coupling (i.e. J, L, and S all specified, and J &lt;= L + S), then the
LS-coupling formalism is applied to compute the components of “anomalous”
Zeeman splitting.
If neither of these cases are fulfilled, then None is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>line</strong> (<a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine"><em>AtomicLine</em></a>) – The line to attempt to compute the Zeeman components from.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>components</strong> – The Zeeman splitting components, if possible.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.zeeman.ZeemanComponents" title="lightweaver.zeeman.ZeemanComponents">ZeemanComponents</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.zeeman.effective_lande">
<code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">effective_lande</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n">AtomicLine</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.zeeman.effective_lande" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the effective Lande g-factor for an atomic line.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.zeeman.fraction_range">
<code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">fraction_range</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">stop</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">step</span><span class="p">:</span> <span class="n">fractions.Fraction</span> <span class="o">=</span> <span class="default_value">Fraction(1, 1)</span></em><span class="sig-paren">)</span> &#x2192; Iterator<span class="p">[</span>fractions.Fraction<span class="p">]</span><a class="headerlink" href="#lightweaver.zeeman.fraction_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Works like range, but with Fractions. Does no checking, so best to make
sure the range you’re asking for is sane and divides down properly.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.zeeman.lande_factor">
<code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">lande_factor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">J</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">L</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">S</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#lightweaver.zeeman.lande_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Lande g-factor for an atomic level from the J, L, and S
quantum numbers.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.zeeman.zeeman_strength">
<code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">zeeman_strength</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Ju</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">Mu</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">Jl</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">Ml</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#lightweaver.zeeman.zeeman_strength" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the strength of a Zeeman component, following del Toro Iniesta
(p. 137) albeit larger by a factor of 2 which is corrected by
normalisation.
Takes J upper and lower (u and l respectively), and M upper and lower.</p>
</dd></dl>

</div>
<div class="section" id="lightweaver-lwcompiled-module">
<h2>lightweaver.LwCompiled module<a class="headerlink" href="#lightweaver-lwcompiled-module" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to Lightweaver’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, C. Osborne

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>