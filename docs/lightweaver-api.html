

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Lightweaver API Documentation &mdash; Lightweaver  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Computing a simple NLTE 8542 line profile in a FAL C atmosphere" href="auto_examples/plot_SimpleLineTest.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Lightweaver
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Lightweaver Examples Gallery</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lightweaver API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.atmosphere">lightweaver.atmosphere module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.atomic_model">lightweaver.atomic_model module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.atomic_set">lightweaver.atomic_set module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.atomic_table">lightweaver.atomic_table module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.barklem">lightweaver.barklem module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.broadening">lightweaver.broadening module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.collisional_rates">lightweaver.collisional_rates module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.fal">lightweaver.fal module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.molecule">lightweaver.molecule module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.multi">lightweaver.multi module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.nr_update">lightweaver.nr_update module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.rh_atoms">lightweaver.rh_atoms module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.utils">lightweaver.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.witt">lightweaver.witt module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.zeeman">lightweaver.zeeman module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightweaver.LwCompiled">lightweaver.LwCompiled module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Lightweaver</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Lightweaver API Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/lightweaver-api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="lightweaver-api-documentation">
<h1>Lightweaver API Documentation<a class="headerlink" href="#lightweaver-api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-lightweaver.atmosphere">
<span id="lightweaver-atmosphere-module"></span><h2>lightweaver.atmosphere module<a class="headerlink" href="#module-lightweaver.atmosphere" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.atmosphere.Atmosphere">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atmosphere.</code><code class="sig-name descname">Atmosphere</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.Layout" title="lightweaver.atmosphere.Layout">lightweaver.atmosphere.Layout</a></span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vturb</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ne</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">nHTot</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">B</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gammaB</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chiB</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Atmosphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage for all atmospheric data. These arrays will be shared directly
with the backend, so a modification here also modifies the data seen by
the backend. Be careful to modify these arrays <em>in place</em>, as their data
is shared by direct memory reference. Use the class methods to construct
atmospheres of different dimensionality.</p>
<dl class="py attribute">
<dt id="lightweaver.atmosphere.Atmosphere.structure">
<code class="sig-name descname">structure</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>A layout structure holding the atmospheric stratification, and
velocity description.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.Layout" title="lightweaver.atmosphere.Layout">Layout</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Atmosphere.temperature">
<code class="sig-name descname">temperature</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>The atmospheric temperature structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Atmosphere.vturb">
<code class="sig-name descname">vturb</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.vturb" title="Permalink to this definition">¶</a></dt>
<dd><p>The atmospheric microturbulent velocity structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Atmosphere.ne">
<code class="sig-name descname">ne</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.ne" title="Permalink to this definition">¶</a></dt>
<dd><p>The electron density structure in the atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Atmosphere.nHTot">
<code class="sig-name descname">nHTot</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.nHTot" title="Permalink to this definition">¶</a></dt>
<dd><p>The total hydrogen number density distribution throughout the
atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Atmosphere.B">
<code class="sig-name descname">B</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.B" title="Permalink to this definition">¶</a></dt>
<dd><p>The magnitude of the stratified magnetic field throughout the
atmosphere (Tesla).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Atmosphere.gammaB">
<code class="sig-name descname">gammaB</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.gammaB" title="Permalink to this definition">¶</a></dt>
<dd><p>Co-altitude of magnetic field vector (radians) throughout the
atmosphere from the local vertical.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Atmosphere.chiB">
<code class="sig-name descname">chiB</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.chiB" title="Permalink to this definition">¶</a></dt>
<dd><p>Azimuth of magnetic field vector (radians) in the x-y plane, measured
from the x-axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.Ndim">
<em class="property">property </em><code class="sig-name descname">Ndim</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.Ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>int
The dimensionality (1, 2, or 3) of the atmospheric model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Ndim</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.Noutgoing">
<em class="property">property </em><code class="sig-name descname">Noutgoing</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.Noutgoing" title="Permalink to this definition">¶</a></dt>
<dd><p>int
The number of cells at the top of the atmosphere (that each produce a
spectrum).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Noutgoing</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.Nrays">
<em class="property">property </em><code class="sig-name descname">Nrays</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.Nrays" title="Permalink to this definition">¶</a></dt>
<dd><p>int
Number of rays in angular discretisation used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Nrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.Nspace">
<em class="property">property </em><code class="sig-name descname">Nspace</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.Nspace" title="Permalink to this definition">¶</a></dt>
<dd><p>int
Total number of points in the atmospheric spatial discretistaion.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Nspace</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.Nx">
<em class="property">property </em><code class="sig-name descname">Nx</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.Nx" title="Permalink to this definition">¶</a></dt>
<dd><p>int
The number of points in the x-direction discretisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Nx</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.Ny">
<em class="property">property </em><code class="sig-name descname">Ny</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.Ny" title="Permalink to this definition">¶</a></dt>
<dd><p>int
The number of points in the y-direction discretisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Ny</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.Nz">
<em class="property">property </em><code class="sig-name descname">Nz</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.Nz" title="Permalink to this definition">¶</a></dt>
<dd><p>int
The number of points in the y-direction discretisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Nz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.cmass">
<em class="property">property </em><code class="sig-name descname">cmass</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.cmass" title="Permalink to this definition">¶</a></dt>
<dd><p>np.ndarray
Column mass [kg m-2].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>cmass</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.dimensioned_unit_view">
<code class="sig-name descname">dimensioned_unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Atmosphere.dimensioned_unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.dimensioned_unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of Layout reshaped so all data has
the correct (1/2/3D) dimensionality for the atmospheric model, and
the correct <cite>astropy.units</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.dimensioned_view">
<code class="sig-name descname">dimensioned_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Atmosphere.dimensioned_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.dimensioned_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of Layout reshaped so all data has
the correct (1/2/3D) dimensionality for the atmospheric model, as
these are all stored under a flat scheme.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.make_1d">
<em class="property">classmethod </em><code class="sig-name descname">make_1d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scale</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.ScaleType" title="lightweaver.atmosphere.ScaleType">lightweaver.atmosphere.ScaleType</a></span></em>, <em class="sig-param"><span class="n">depthScale</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vlos</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vturb</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ne</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">hydrogenPops</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nHTot</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">B</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gammaB</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chiB</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lowerBc</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">upperBc</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">convertScales</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">abundance</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">lightweaver.atomic_table.AtomicAbundance</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logG</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">2.44</span></em>, <em class="sig-param"><span class="n">Pgas</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Pe</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Ptop</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">PeTop</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Atmosphere.make_1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.make_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for 1D Atmosphere objects. Optionally will use an
equation of state (EOS) to estimate missing parameters.</p>
<p>If sufficient information is provided (i.e. all required parameters
and ne and (hydrogenPops or nHTot)) then the EOS is not invoked to
estimate any thermodynamic properties. If both of nHTot and
hydrogenPops are omitted, then the electron pressure will be used
with the Wittmann equation of state to estimate the mass density, and
the hydrogen number density will be inferred from this and the
abundances. If, instead, ne is omitted, then the mass density will be
used with the Wittmann EOS to estimate the electron pressure.
If both of these are omitted then the EOS will be used to estimate
both. If:</p>
<blockquote>
<div><ul class="simple">
<li><p>Pgas is provided, then this gas pressure will define the
atmospheric stratification and will be used with the EOS.</p></li>
<li><p>Pe is provided, then this electron pressure will define the
atmospheric stratification and will be used with the EOS.</p></li>
<li><p>Ptop is provided, then this gas pressure at the top of the
atmosphere will be used with the log gravitational acceleration
logG, and the EOS to estimate the missing parameters assuming
hydrostatic equilibrium.</p></li>
<li><p>PeTop is provided, then this electron pressure at the top of
the atmosphere will be used with the log gravitational
acceleration logG, and the EOS to estimate the missing parameters
assuming hydrostatic equilibrium.</p></li>
<li><p>If all of Pgas, Pe, Ptop, PeTop are omitted then Ptop will be
estimated from the gas pressure in the FALC model at the
temperature at the top boundary. The hydrostatic reconstruction
will then continue as usual.</p></li>
</ul>
</div></blockquote>
<p>convertScales will substantially slow down this function due to the
slow calculation of background opacities used to compute tauRef. If
an atmosphere is constructed with a Geometric stratification, and an
estimate of tauRef is not required before running the main RT module,
then this can be set to False.
All of these parameters can be provided as astropy Quantities, and
will be converted in the constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale</strong> (<a class="reference internal" href="#lightweaver.atmosphere.ScaleType" title="lightweaver.atmosphere.ScaleType"><em>ScaleType</em></a>) – The type of stratification used along the z-axis.</p></li>
<li><p><strong>depthScale</strong> (<em>np.ndarray</em>) – The z-coordinates used along the chosen stratification. The
stratification is expected to start at the top of the atmosphere
(closest to the observer), and descend along the observer’s line
of sight.</p></li>
<li><p><strong>temperature</strong> (<em>np.ndarray</em>) – Temperature structure of the atmosphere [K].</p></li>
<li><p><strong>vlos</strong> (<em>np.ndarray</em>) – Velocity structure of the atmosphere along z [m/s].</p></li>
<li><p><strong>vturb</strong> (<em>np.ndarray</em>) – Microturbulent velocity structure of the atmosphere [m/s].</p></li>
<li><p><strong>ne</strong> (<em>np.ndarray</em>) – Electron density structure of the atmosphere [m-3].</p></li>
<li><p><strong>hydrogenPops</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Detailed (per level) hydrogen number density structure of the
atmosphere [m-3], 2D array [Nlevel, Nspace].</p></li>
<li><p><strong>nHTot</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Total hydrogen number density structure of the atmosphere [m-3]</p></li>
<li><p><strong>B</strong> (<em>np.ndarray</em><em>, </em><em>optional.</em>) – Magnetic field strength [T].</p></li>
<li><p><strong>gammaB</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Co-altitude of magnetic field vector [radians].</p></li>
<li><p><strong>chiB</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Azimuth of magnetic field vector (in x-y plane, from x) [radians].</p></li>
<li><p><strong>lowerBc</strong> (<a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition"><em>BoundaryCondition</em></a><em>, </em><em>optional</em>) – Boundary condition for incoming radiation at the minimal z
coordinate (default: ThermalisedRadiation).</p></li>
<li><p><strong>upperBc</strong> (<a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition"><em>BoundaryCondition</em></a><em>, </em><em>optional</em>) – Boundary condition for incoming radiation at the maximal z
coordinate (default: ZeroRadiation).</p></li>
<li><p><strong>convertScales</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to automatically compute tauRef and cmass for an
atmosphere given in a stratification of m (default: True).</p></li>
<li><p><strong>abundance</strong> (<a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance"><em>AtomicAbundance</em></a><em>, </em><em>optional</em>) – An instance of AtomicAbundance giving the abundances of each
atomic species in the given atmosphere, only used if the EOS is
invoked. (default: DefaultAtomicAbundance)</p></li>
<li><p><strong>logG</strong> (<em>float</em><em>, </em><em>optional</em>) – The log10 of the magnitude of gravitational acceleration [m/s2]
(default: 2.44).</p></li>
<li><p><strong>Pgas</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The gas pressure stratification of the atmosphere [Pa],
optionally used by the EOS.</p></li>
<li><p><strong>Pe</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The electron pressure stratification of the atmosphere [Pa],
optionally used by the EOS.</p></li>
<li><p><strong>Ptop</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The gas pressure at the top of the atmosphere [Pa], optionally
used by the EOS for a hydrostatic reconstruction.</p></li>
<li><p><strong>Petop</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The electron pressure at the top of the atmosphere [Pa],
optionally used by the EOS for a hydrostatic reconstruction.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Explain decisions made with the EOS to estimate missing
parameters (if invoked) through print calls (default: False).</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if incorrect arguments or unable to construct estimate missing
    parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.make_2d">
<em class="property">classmethod </em><code class="sig-name descname">make_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">height</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vx</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vz</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vturb</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ne</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nHTot</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">B</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gammaB</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chiB</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xUpperBc</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xLowerBc</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zUpperBc</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zLowerBc</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">abundance</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">lightweaver.atomic_table.AtomicAbundance</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Atmosphere.make_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.make_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for 2D Atmosphere objects.</p>
<p>No provision for estimating parameters using hydrostatic equilibrium
is provided, but one of ne, or nHTot can be omitted and inferred by
use of the Wittmann equation of state.
The atmosphere must be defined on a geometric stratification.
All atmospheric parameters are expected in a 2D [z, x] array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>height</strong> (<em>np.ndarray</em>) – The z-coordinates of the atmospheric grid. The stratification is
expected to start at the top of the atmosphere (closest to the
observer), and descend along the observer’s line of sight.</p></li>
<li><p><strong>x</strong> (<em>np.ndarray</em>) – The (horizontal) x-coordinates of the atmospheric grid.</p></li>
<li><p><strong>temperature</strong> (<em>np.ndarray</em>) – Temperature structure of the atmosphere [K].</p></li>
<li><p><strong>vx</strong> (<em>np.ndarray</em>) – x-component of the atmospheric velocity [m/s].</p></li>
<li><p><strong>vz</strong> (<em>np.ndarray</em>) – z-component of the atmospheric velocity [m/s].</p></li>
<li><p><strong>vturb</strong> (<em>np.ndarray</em>) – Microturbulent velocity structure [m/s].</p></li>
<li><p><strong>ne</strong> (<em>np.ndarray</em>) – Electron density structure of the atmosphere [m-3].</p></li>
<li><p><strong>nHTot</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Total hydrogen number density structure of the atmosphere [m-3].</p></li>
<li><p><strong>B</strong> (<em>np.ndarray</em><em>, </em><em>optional.</em>) – Magnetic field strength [T].</p></li>
<li><p><strong>gammaB</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Co-altitude of magnetic field vector [radians].</p></li>
<li><p><strong>chiB</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Azimuth of magnetic field vector (in x-y plane, from x) [radians].</p></li>
<li><p><strong>xLowerBc</strong> (<a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition"><em>BoundaryCondition</em></a><em>, </em><em>optional</em>) – Boundary condition for incoming radiation at the minimal x
coordinate (default: PeriodicRadiation).</p></li>
<li><p><strong>xUpperBc</strong> (<a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition"><em>BoundaryCondition</em></a><em>, </em><em>optional</em>) – Boundary condition for incoming radiation at the maximal x
coordinate (default: PeriodicRadiation).</p></li>
<li><p><strong>zLowerBc</strong> (<a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition"><em>BoundaryCondition</em></a><em>, </em><em>optional</em>) – Boundary condition for incoming radiation at the minimal z
coordinate (default: ThermalisedRadiation).</p></li>
<li><p><strong>zUpperBc</strong> (<a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition"><em>BoundaryCondition</em></a><em>, </em><em>optional</em>) – Boundary condition for incoming radiation at the maximal z
coordinate (default: ZeroRadiation).</p></li>
<li><p><strong>convertScales</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to automatically compute tauRef and cmass for an
atmosphere given in a stratification of m (default: True).</p></li>
<li><p><strong>abundance</strong> (<a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance"><em>AtomicAbundance</em></a><em>, </em><em>optional</em>) – An instance of AtomicAbundance giving the abundances of each
atomic species in the given atmosphere, only used if the EOS is
invoked. (default: DefaultAtomicAbundance)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Explain decisions made with the EOS to estimate missing
parameters (if invoked) through print calls (default: False).</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if incorrect arguments or unable to construct estimate missing
    parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.quadrature">
<code class="sig-name descname">quadrature</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Nrays</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mu</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wmu</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Atmosphere.quadrature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.quadrature" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the angular quadrature for solving the RTE and Kinetic
Equilibrium in a given atmosphere.</p>
<p>Procedure varies with dimensionality.</p>
<dl>
<dt>1D:</dt><dd><p>If a number of rays is given (typically 3 or 5), then the
Gauss-Legendre quadrature for this set is used.
If mu and wmu are instead given then these will be validated and
used.</p>
</dd>
<dt>2+D:</dt><dd><p>If the number of rays selected is in the list of near optimal
quadratures for unpolarised radiation provided by Stepan et al
2020 (A&amp;A, 646 A24), then this is used. Otherwise an exception is
raised.</p>
<p>The available quadratures are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 53%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Points</p></th>
<th class="head"><p>Order</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>9</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>11</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>13</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>15</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Nrays</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of rays to use in the quadrature. See notes above.</p></li>
<li><p><strong>mu</strong> (<em>sequence of float</em><em>, </em><em>optional</em>) – The cosine of the angle made between the between each of the set
of rays and the z axis, only used in 1D.</p></li>
<li><p><strong>wmu</strong> (<em>sequence of float</em><em>, </em><em>optional</em>) – The integration weights for each mu, must be provided if mu is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – on incorrect input.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.rays">
<code class="sig-name descname">rays</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">muz</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>float<span class="p">, </span>Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">mux</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>float<span class="p">, </span>Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">muy</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>float<span class="p">, </span>Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wmu</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>float<span class="p">, </span>Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Atmosphere.rays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.rays" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the rays on the Atmosphere for computing the intensity in a
particular direction (or set of directions).</p>
<p>If only the z angle is set then the ray is assumed in the x-z plane.
If either muz or muy is omitted then this angle is inferred by
normalisation of the projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>muz</strong> (<em>float</em><em> or </em><em>sequence of float</em><em>, </em><em>optional</em>) – The angular projections along the z axis.</p></li>
<li><p><strong>mux</strong> (<em>float</em><em> or </em><em>sequence of float</em><em>, </em><em>optional</em>) – The angular projections along the x axis.</p></li>
<li><p><strong>muy</strong> (<em>float</em><em> or </em><em>sequence of float</em><em>, </em><em>optional</em>) – The angular projections along the y axis.</p></li>
<li><p><strong>wmu</strong> (<em>float</em><em> or </em><em>sequence of float</em><em>, </em><em>optional</em>) – The integration weights for the given ray if J is to be
integrated for angle set.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the angular projections or integration weights are incorrectly
    normalised.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.tauRef">
<em class="property">property </em><code class="sig-name descname">tauRef</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.tauRef" title="Permalink to this definition">¶</a></dt>
<dd><p>np.ndarray
Reference optical depth at 500 nm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tauRef</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.unit_view">
<code class="sig-name descname">unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Atmosphere.unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of the Layout with the correct
<cite>astropy.units</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.vlos">
<em class="property">property </em><code class="sig-name descname">vlos</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.vlos" title="Permalink to this definition">¶</a></dt>
<dd><p>np.ndarray
z component of plasma velocity (present for all Ndim) [m/s]. Only
available when Ndim==1`.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>vz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.vx">
<em class="property">property </em><code class="sig-name descname">vx</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.vx" title="Permalink to this definition">¶</a></dt>
<dd><p>np.ndarray
x component of plasma velocity (present for Ndim &gt;= 2) [m/s].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>vx</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.vy">
<em class="property">property </em><code class="sig-name descname">vy</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.vy" title="Permalink to this definition">¶</a></dt>
<dd><p>np.ndarray
y component of plasma velocity (present for Ndim == 3) [m/s].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>vy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.vz">
<em class="property">property </em><code class="sig-name descname">vz</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.vz" title="Permalink to this definition">¶</a></dt>
<dd><p>np.ndarray
z component of plasma velocity (present for all Ndim) [m/s]. Aliased
to <cite>vlos</cite> when <cite>Ndim==1</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>vz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.x">
<em class="property">property </em><code class="sig-name descname">x</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.x" title="Permalink to this definition">¶</a></dt>
<dd><p>np.ndarray
Ordinates of grid points along the x-axis (present for Ndim &gt;= 2) [m].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.xLowerBc">
<em class="property">property </em><code class="sig-name descname">xLowerBc</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.xLowerBc" title="Permalink to this definition">¶</a></dt>
<dd><p>BoundaryCondition
Boundary condition for the plane of minimal x-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>xLowerBc</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.xUpperBc">
<em class="property">property </em><code class="sig-name descname">xUpperBc</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.xUpperBc" title="Permalink to this definition">¶</a></dt>
<dd><p>BoundaryCondition
Boundary condition for the plane of maximal x-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>xUpperBc</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.y">
<em class="property">property </em><code class="sig-name descname">y</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.y" title="Permalink to this definition">¶</a></dt>
<dd><p>np.ndarray
Ordinates of grid points along the y-axis (present for Ndim == 3) [m].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>y</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.yLowerBc">
<em class="property">property </em><code class="sig-name descname">yLowerBc</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.yLowerBc" title="Permalink to this definition">¶</a></dt>
<dd><p>BoundaryCondition
Boundary condition for the plane of minimal y-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>yLowerBc</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.yUpperBc">
<em class="property">property </em><code class="sig-name descname">yUpperBc</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.yUpperBc" title="Permalink to this definition">¶</a></dt>
<dd><p>BoundaryCondition
Boundary condition for the plane of maximal y-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>yUpperBc</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.z">
<em class="property">property </em><code class="sig-name descname">z</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.z" title="Permalink to this definition">¶</a></dt>
<dd><p>np.ndarray
Ordinates of grid points along the z-axis (present for all Ndim) [m].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>z</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.zLowerBc">
<em class="property">property </em><code class="sig-name descname">zLowerBc</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.zLowerBc" title="Permalink to this definition">¶</a></dt>
<dd><p>BoundaryCondition
Boundary condition for the plane of minimal z-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>zLowerBc</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Atmosphere.zUpperBc">
<em class="property">property </em><code class="sig-name descname">zUpperBc</code><a class="headerlink" href="#lightweaver.atmosphere.Atmosphere.zUpperBc" title="Permalink to this definition">¶</a></dt>
<dd><p>BoundaryCondition
Boundary condition for the plane of maximal z-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>zUpperBc</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atmosphere.BoundaryCondition">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atmosphere.</code><code class="sig-name descname">BoundaryCondition</code><a class="reference internal" href="_modules/lightweaver/atmosphere.html#BoundaryCondition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.BoundaryCondition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for boundary conditions.</p>
<p>Defines the interface; do not use directly.</p>
<dl class="py method">
<dt id="lightweaver.atmosphere.BoundaryCondition.compute_bc">
<code class="sig-name descname">compute_bc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">Atmosphere</a></span></em>, <em class="sig-param"><span class="n">spect</span><span class="p">:</span> <span class="n">LwSpectrum</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atmosphere.html#BoundaryCondition.compute_bc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.BoundaryCondition.compute_bc" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when the radiation boundary condition is needed by the backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmospheric object in which to compute the radiation.</p></li>
<li><p><strong>spect</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.LwSpectrum" title="lightweaver.LwCompiled.LwSpectrum"><em>LwSpectrum</em></a>) – The computational spectrum object provided by the Context.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – This function needs to return a contiguous array of shape [Nwave,
Nrays, Nbc], where Nwave is the number of wavelengths in the
wavelength grid, Nrays is the number of rays in the angular
quadrature (also including up/down directions) ordered as per
[mu[0] down, mu[0] up, mu[1] down…], Nbc is the number of
spatial positions the boundary condition needs to be defined at
ordered in a flattened [Nz, Ny, Nx] fashion. (dtype: &lt;f8)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atmosphere.Layout">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atmosphere.</code><code class="sig-name descname">Layout</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Ndim</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">z</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vx</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vy</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vz</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">xLowerBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">xUpperBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">yLowerBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">yUpperBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">zLowerBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">zUpperBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">stratifications</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atmosphere.Stratifications" title="lightweaver.atmosphere.Stratifications">lightweaver.atmosphere.Stratifications</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Layout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage for basic atmospheric parameters whose presence is determined by problem dimensionality, boundary conditions and optional stratifications.</p>
<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.Ndim">
<code class="sig-name descname">Ndim</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.Ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of dimensions in model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.x">
<code class="sig-name descname">x</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.x" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordinates of grid points along the x-axis (present for Ndim &gt;= 2) [m].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.y">
<code class="sig-name descname">y</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.y" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordinates of grid points along the y-axis (present for Ndim == 3) [m].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.z">
<code class="sig-name descname">z</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.z" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordinates of grid points along the z-axis (present for all Ndim) [m].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.vx">
<code class="sig-name descname">vx</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.vx" title="Permalink to this definition">¶</a></dt>
<dd><p>x component of plasma velocity (present for Ndim &gt;= 2) [m/s].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.vy">
<code class="sig-name descname">vy</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.vy" title="Permalink to this definition">¶</a></dt>
<dd><p>y component of plasma velocity (present for Ndim == 3) [m/s].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.vz">
<code class="sig-name descname">vz</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.vz" title="Permalink to this definition">¶</a></dt>
<dd><p>z component of plasma velocity (present for all Ndim) [m/s]. Aliased to <cite>vlos</cite> when <cite>Ndim==1</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.xLowerBc">
<code class="sig-name descname">xLowerBc</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.xLowerBc" title="Permalink to this definition">¶</a></dt>
<dd><p>Boundary condition for the plane of minimal x-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">BoundaryCondition</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.xUpperBc">
<code class="sig-name descname">xUpperBc</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.xUpperBc" title="Permalink to this definition">¶</a></dt>
<dd><p>Boundary condition for the plane of maximal x-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">BoundaryCondition</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.yLowerBc">
<code class="sig-name descname">yLowerBc</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.yLowerBc" title="Permalink to this definition">¶</a></dt>
<dd><p>Boundary condition for the plane of minimal y-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">BoundaryCondition</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.yUpperBc">
<code class="sig-name descname">yUpperBc</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.yUpperBc" title="Permalink to this definition">¶</a></dt>
<dd><p>Boundary condition for the plane of maximal y-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">BoundaryCondition</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.zLowerBc">
<code class="sig-name descname">zLowerBc</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.zLowerBc" title="Permalink to this definition">¶</a></dt>
<dd><p>Boundary condition for the plane of minimal z-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">BoundaryCondition</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Layout.zUpperBc">
<code class="sig-name descname">zUpperBc</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.zUpperBc" title="Permalink to this definition">¶</a></dt>
<dd><p>Boundary condition for the plane of maximal z-coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">BoundaryCondition</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.Noutgoing">
<em class="property">property </em><code class="sig-name descname">Noutgoing</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.Noutgoing" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of grid points at which the outgoing radiation is computed.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.Nspace">
<em class="property">property </em><code class="sig-name descname">Nspace</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.Nspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of spatial points present in the grid.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.Nx">
<em class="property">property </em><code class="sig-name descname">Nx</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.Nx" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of grid points along the x-axis.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.Ny">
<em class="property">property </em><code class="sig-name descname">Ny</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.Ny" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of grid points along the y-axis.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.Nz">
<em class="property">property </em><code class="sig-name descname">Nz</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.Nz" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of grid points along the z-axis.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.cmass">
<em class="property">property </em><code class="sig-name descname">cmass</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.cmass" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias to <cite>self.stratifications.cmass</cite>, if computed.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.dimensioned_shape">
<em class="property">property </em><code class="sig-name descname">dimensioned_shape</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.dimensioned_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple defining the shape to which the arrays of atmospheric paramters
can be reshaped to be indexed in a 1/2/3D fashion.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.dimensioned_unit_view">
<code class="sig-name descname">dimensioned_unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atmosphere.Layout" title="lightweaver.atmosphere.Layout">lightweaver.atmosphere.Layout</a><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Layout.dimensioned_unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Layout.dimensioned_unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of Layout reshaped so all data has
the correct (1/2/3D) dimensionality for the atmospheric model, and
the correct <cite>astropy.units</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.dimensioned_view">
<code class="sig-name descname">dimensioned_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atmosphere.Layout" title="lightweaver.atmosphere.Layout">lightweaver.atmosphere.Layout</a><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Layout.dimensioned_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Layout.dimensioned_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of Layout reshaped so all data has
the correct (1/2/3D) dimensionality for the atmospheric model, as
these are all stored under a flat scheme.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.make_1d">
<em class="property">classmethod </em><code class="sig-name descname">make_1d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vz</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">lowerBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">upperBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">stratifications</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atmosphere.Stratifications" title="lightweaver.atmosphere.Stratifications">lightweaver.atmosphere.Stratifications</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atmosphere.Layout" title="lightweaver.atmosphere.Layout">lightweaver.atmosphere.Layout</a><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Layout.make_1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Layout.make_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct 1D Layout.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.make_2d">
<em class="property">classmethod </em><code class="sig-name descname">make_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">z</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vx</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vz</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">xLowerBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">xUpperBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">zLowerBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">zUpperBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">stratifications</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atmosphere.Stratifications" title="lightweaver.atmosphere.Stratifications">lightweaver.atmosphere.Stratifications</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atmosphere.Layout" title="lightweaver.atmosphere.Layout">lightweaver.atmosphere.Layout</a><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Layout.make_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Layout.make_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct 2D Layout.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.make_3d">
<em class="property">classmethod </em><code class="sig-name descname">make_3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">z</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vx</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vy</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vz</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">xLowerBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">xUpperBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">yLowerBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">yUpperBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">zLowerBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">zUpperBc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition">lightweaver.atmosphere.BoundaryCondition</a></span></em>, <em class="sig-param"><span class="n">stratifications</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atmosphere.Stratifications" title="lightweaver.atmosphere.Stratifications">lightweaver.atmosphere.Stratifications</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atmosphere.Layout" title="lightweaver.atmosphere.Layout">lightweaver.atmosphere.Layout</a><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Layout.make_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Layout.make_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct 3D Layout.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.tauRef">
<em class="property">property </em><code class="sig-name descname">tauRef</code><a class="headerlink" href="#lightweaver.atmosphere.Layout.tauRef" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias to <cite>self.stratifications.tauRef</cite>, if computed.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Layout.unit_view">
<code class="sig-name descname">unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atmosphere.Layout" title="lightweaver.atmosphere.Layout">lightweaver.atmosphere.Layout</a><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Layout.unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Layout.unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of the Layout with the correct
<cite>astropy.units</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atmosphere.NoBc">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atmosphere.</code><code class="sig-name descname">NoBc</code><a class="reference internal" href="_modules/lightweaver/atmosphere.html#NoBc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.NoBc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atmosphere.BoundaryCondition</span></code></a></p>
<p>Indicates no boundary condition on the axis because it is invalid for the
current simulation.
Used only by the backend.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.atmosphere.PeriodicRadiation">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atmosphere.</code><code class="sig-name descname">PeriodicRadiation</code><a class="reference internal" href="_modules/lightweaver/atmosphere.html#PeriodicRadiation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.PeriodicRadiation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atmosphere.BoundaryCondition</span></code></a></p>
<p>Periodic boundary condition.
Commonly used on the x-axis in 2D simulations.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.atmosphere.ScaleType">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atmosphere.</code><code class="sig-name descname">ScaleType</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#ScaleType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.ScaleType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Atmospheric scales used in the definition of 1D atmospheres to allow the
correct conversion to a height based system.
Options:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>Geometric</cite></p></li>
<li><p><cite>ColumnMass</cite></p></li>
<li><p><cite>Tau500</cite></p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.atmosphere.Stratifications">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atmosphere.</code><code class="sig-name descname">Stratifications</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cmass</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">tauRef</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Stratifications"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Stratifications" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stores the optional derived z-stratifications of an atmospheric model.</p>
<dl class="py attribute">
<dt id="lightweaver.atmosphere.Stratifications.cmass">
<code class="sig-name descname">cmass</code><a class="headerlink" href="#lightweaver.atmosphere.Stratifications.cmass" title="Permalink to this definition">¶</a></dt>
<dd><p>Column mass [kg m-2].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atmosphere.Stratifications.tauRef">
<code class="sig-name descname">tauRef</code><a class="headerlink" href="#lightweaver.atmosphere.Stratifications.tauRef" title="Permalink to this definition">¶</a></dt>
<dd><p>Reference optical depth at 500 nm.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Stratifications.dimensioned_unit_view">
<code class="sig-name descname">dimensioned_unit_view</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atmosphere.Stratifications" title="lightweaver.atmosphere.Stratifications">lightweaver.atmosphere.Stratifications</a><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Stratifications.dimensioned_unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Stratifications.dimensioned_unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes an instance of <cite>Stratifications</cite> reshaped to the provided shape
with the correct <cite>astropy.units</cite> for multi-dimensional atmospheres.
For internal use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>tuple</em>) – Shape to reform the stratifications, provided by
<cite>Layout.dimensioned_shape</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>stratifications</strong> – Reshaped stratifications with units.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.Stratifications" title="lightweaver.atmosphere.Stratifications">Stratifications</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Stratifications.dimensioned_view">
<code class="sig-name descname">dimensioned_view</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atmosphere.Stratifications" title="lightweaver.atmosphere.Stratifications">lightweaver.atmosphere.Stratifications</a><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Stratifications.dimensioned_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Stratifications.dimensioned_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes an instance of <cite>Stratifications</cite> reshaped to the provided
shape for multi-dimensional atmospheres.
For internal use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>tuple</em>) – Shape to reform the stratifications, provided by
<cite>Layout.dimensioned_shape</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>stratifications</strong> – Reshaped stratifications.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.Stratifications" title="lightweaver.atmosphere.Stratifications">Stratifications</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atmosphere.Stratifications.unit_view">
<code class="sig-name descname">unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atmosphere.Stratifications" title="lightweaver.atmosphere.Stratifications">lightweaver.atmosphere.Stratifications</a><a class="reference internal" href="_modules/lightweaver/atmosphere.html#Stratifications.unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.Stratifications.unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes an instance of <cite>Stratifications</cite>  with the correct <cite>astropy.units</cite>
For internal use.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>stratifications</strong> – The same data with units applied.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#lightweaver.atmosphere.Stratifications" title="lightweaver.atmosphere.Stratifications">Stratifications</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atmosphere.ThermalisedRadiation">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atmosphere.</code><code class="sig-name descname">ThermalisedRadiation</code><a class="reference internal" href="_modules/lightweaver/atmosphere.html#ThermalisedRadiation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.ThermalisedRadiation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atmosphere.BoundaryCondition</span></code></a></p>
<p>Thermalised radiation (blackbody) boundary condition.
Commonly used for photospheric situations.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.atmosphere.ZeroRadiation">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atmosphere.</code><code class="sig-name descname">ZeroRadiation</code><a class="reference internal" href="_modules/lightweaver/atmosphere.html#ZeroRadiation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.ZeroRadiation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atmosphere.BoundaryCondition" title="lightweaver.atmosphere.BoundaryCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atmosphere.BoundaryCondition</span></code></a></p>
<p>Zero radiation boundary condition.
Commonly used for coronal situations.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.atmosphere.get_top_pressure">
<code class="sig-prename descclassname">lightweaver.atmosphere.</code><code class="sig-name descname">get_top_pressure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eos</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.witt.witt" title="lightweaver.witt.witt">lightweaver.witt.witt</a></span></em>, <em class="sig-param"><span class="n">temp</span></em>, <em class="sig-param"><span class="n">ne</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rho</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atmosphere.html#get_top_pressure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atmosphere.get_top_pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pressure for the top of atmosphere.
For internal use.</p>
<dl class="simple">
<dt>In order this is deduced from:</dt><dd><ul class="simple">
<li><p>the electron density <cite>ne</cite>, if provided</p></li>
<li><p>the mass density <cite>rho</cite>, if provided</p></li>
<li><p>the electron pressure present in FALC</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>pressure</strong> – pressure IN CGS [dyn cm-2]</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.atomic_model">
<span id="lightweaver-atomic-model-module"></span><h2>lightweaver.atomic_model module<a class="headerlink" href="#module-lightweaver.atomic_model" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.atomic_model.AtomicContinuum">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">AtomicContinuum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicContinuum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.AtomicTransition" title="lightweaver.atomic_model.AtomicTransition"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.AtomicTransition</span></code></a></p>
<p>Base class for atomic continua.</p>
<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.alpha">
<code class="sig-name descname">alpha</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicContinuum.alpha"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cross-section as a function of wavelength</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelength</strong> (<em>np.ndarray</em>) – The wavelengths at which to compute the cross-section</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>alpha</strong> – The cross-section for each wavelength</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.lambda0">
<em class="property">property </em><code class="sig-name descname">lambda0</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.lambda0" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum (edge) wavelength at which this transition contributes [nm].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.lambda0_m">
<em class="property">property </em><code class="sig-name descname">lambda0_m</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.lambda0_m" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum (edge) wavelength at which this transition contributes [m].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.lambdaEdge">
<em class="property">property </em><code class="sig-name descname">lambdaEdge</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.lambdaEdge" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum (edge) wavelength at which this transition contributes [nm].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.minLambda">
<em class="property">property </em><code class="sig-name descname">minLambda</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.minLambda" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum wavelength at which this transition contributes.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicContinuum.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicContinuum.wavelength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicContinuum.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>The wavelength grid on which this continuum’s cross section is defined.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.AtomicLevel">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">AtomicLevel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">E</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">g</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">label</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">stage</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">J</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>fractions.Fraction<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">L</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">S</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>fractions.Fraction<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicLevel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Description of atomic level in model atom.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.E">
<code class="sig-name descname">E</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.E" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy above ground state [cm-1]</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.g">
<code class="sig-name descname">g</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.g" title="Permalink to this definition">¶</a></dt>
<dd><p>Statistical weight of level</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.label">
<code class="sig-name descname">label</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Name for level</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.stage">
<code class="sig-name descname">stage</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Ionisation of level with 0 being neutral</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.atom">
<code class="sig-name descname">atom</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.atom" title="Permalink to this definition">¶</a></dt>
<dd><p>AtomicModel that holds this level, will be initialised by the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">AtomicModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.J">
<code class="sig-name descname">J</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.J" title="Permalink to this definition">¶</a></dt>
<dd><p>Total quantum angular momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Fraction, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.L">
<code class="sig-name descname">L</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.L" title="Permalink to this definition">¶</a></dt>
<dd><p>Orbital angular momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLevel.S">
<code class="sig-name descname">S</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.S" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Fraction, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLevel.E_SI">
<em class="property">property </em><code class="sig-name descname">E_SI</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.E_SI" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns E in Joule.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLevel.E_eV">
<em class="property">property </em><code class="sig-name descname">E_eV</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.E_eV" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns E in electron volt.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLevel.lsCoupling">
<em class="property">property </em><code class="sig-name descname">lsCoupling</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLevel.lsCoupling" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether the L-S coupling formalism can be applied to this
level.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.AtomicLine">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">AtomicLine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">f</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">type</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineType" title="lightweaver.atomic_model.LineType">lightweaver.atomic_model.LineType</a></span></em>, <em class="sig-param"><span class="n">quadrature</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineQuadrature" title="lightweaver.atomic_model.LineQuadrature">lightweaver.atomic_model.LineQuadrature</a></span></em>, <em class="sig-param"><span class="n">broadening</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.broadening.LineBroadening" title="lightweaver.broadening.LineBroadening">lightweaver.broadening.LineBroadening</a></span></em>, <em class="sig-param"><span class="n">gLandeEff</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.AtomicTransition" title="lightweaver.atomic_model.AtomicTransition"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.AtomicTransition</span></code></a></p>
<p>Base class for atomic lines, holding their specialised information over
transitions.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLine.f">
<code class="sig-name descname">f</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Oscillator strength.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLine.type">
<code class="sig-name descname">type</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Should the line be treated in PRD or CRD.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.LineType" title="lightweaver.atomic_model.LineType">LineType</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLine.quadrature">
<code class="sig-name descname">quadrature</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.quadrature" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavelength quadrature for integrating line properties over.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.LineQuadrature" title="lightweaver.atomic_model.LineQuadrature">LineQuadrature</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLine.broadening">
<code class="sig-name descname">broadening</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.broadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Object describing the broadening processes to be used in conjunction
with the quadrature to generate the line profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.broadening.LineBroadening" title="lightweaver.broadening.LineBroadening">LineBroadening</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicLine.gLandeEff">
<code class="sig-name descname">gLandeEff</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.gLandeEff" title="Permalink to this definition">¶</a></dt>
<dd><p>Optionally override LS-coupling (if available for this transition),
and just directly set the effective Lande g factor (if it isn’t).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.Aji">
<em class="property">property </em><code class="sig-name descname">Aji</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.Aji" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Einstein A coefficient for this line.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.Bij">
<em class="property">property </em><code class="sig-name descname">Bij</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.Bij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Einstein B_{ij} coefficient for this line.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.Bji">
<em class="property">property </em><code class="sig-name descname">Bji</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.Bji" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Einstein B_{ji} coefficient for this line.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.compute_phi">
<code class="sig-name descname">compute_phi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineProfileState" title="lightweaver.atomic_model.LineProfileState">lightweaver.atomic_model.LineProfileState</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_model.LineProfileResult" title="lightweaver.atomic_model.LineProfileResult">lightweaver.atomic_model.LineProfileResult</a><a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicLine.compute_phi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.compute_phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the line profile, intended to be called from the backend.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.lambda0">
<em class="property">property </em><code class="sig-name descname">lambda0</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.lambda0" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the line rest wavelength [nm].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.lambda0_m">
<em class="property">property </em><code class="sig-name descname">lambda0_m</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.lambda0_m" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the line rest wavelength [m].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.overlyingContinuumLevel">
<em class="property">property </em><code class="sig-name descname">overlyingContinuumLevel</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.overlyingContinuumLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the first overlying continuum level.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.polarisable">
<em class="property">property </em><code class="sig-name descname">polarisable</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.polarisable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether sufficient information is available to compute full
Stokes solutions for this line.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vMicroChar</span><span class="o">=</span><span class="default_value">3000.0</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicLine.wavelength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the wavelength grid for this transition based on the
LineQuadrature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vMicroChar</strong> (<em>float</em><em>, </em><em>optional</em>) – Characterisitc microturbulent velocity to assume when computing
the line quadrature (default 3e3 m/s).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicLine.zeeman_components">
<code class="sig-name descname">zeeman_components</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.zeeman.ZeemanComponents" title="lightweaver.zeeman.ZeemanComponents">lightweaver.zeeman.ZeemanComponents</a><span class="p">]</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicLine.zeeman_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicLine.zeeman_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Zeeman components of a line, if possible or None.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.AtomicModel">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">AtomicModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a></span></em>, <em class="sig-param"><span class="n">levels</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_model.AtomicLevel" title="lightweaver.atomic_model.AtomicLevel">AtomicLevel</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">lines</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine">AtomicLine</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">continua</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_model.AtomicContinuum" title="lightweaver.atomic_model.AtomicContinuum">AtomicContinuum</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">collisions</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>CollisionalRates<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container class for the complete description of a model atom.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicModel.element">
<code class="sig-name descname">element</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.element" title="Permalink to this definition">¶</a></dt>
<dd><p>The element or ion represented by this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicModel.levels">
<code class="sig-name descname">levels</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.levels" title="Permalink to this definition">¶</a></dt>
<dd><p>The levels in use in this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of AtomicLevel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicModel.lines">
<code class="sig-name descname">lines</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.lines" title="Permalink to this definition">¶</a></dt>
<dd><p>The atomic lines present in this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of AtomicLine</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicModel.continua">
<code class="sig-name descname">continua</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.continua" title="Permalink to this definition">¶</a></dt>
<dd><p>The atomic continua present in this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of AtomicContinuum</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.AtomicModel.collisions">
<code class="sig-name descname">collisions</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.collisions" title="Permalink to this definition">¶</a></dt>
<dd><p>The collisional rates present in this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of CollisionalRates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicModel.transitions">
<em class="property">property </em><code class="sig-name descname">transitions</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.transitions" title="Permalink to this definition">¶</a></dt>
<dd><p>List of all atomic transitions present on the model.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicModel.vBroad">
<code class="sig-name descname">vBroad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicModel.vBroad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicModel.vBroad" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the atomic broadening velocity structure for a given
atmosphere from the thermal motions and microturbulent velocity.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.AtomicTransition">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">AtomicTransition</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#AtomicTransition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.AtomicTransition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic storage class for atomic transitions. Both lines and continua are
derived from this.</p>
<dl class="py method">
<dt id="lightweaver.atomic_model.AtomicTransition.transId">
<em class="property">property </em><code class="sig-name descname">transId</code><a class="headerlink" href="#lightweaver.atomic_model.AtomicTransition.transId" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique identifier (transition ID) for transition (assuming one copy
of each Element), used in creating a SpectrumConfiguration etc.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.ExplicitContinuum">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">ExplicitContinuum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">wavelengthGrid</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">alphaGrid</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#ExplicitContinuum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.ExplicitContinuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.AtomicContinuum" title="lightweaver.atomic_model.AtomicContinuum"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.AtomicContinuum</span></code></a></p>
<p>Specific version of atomic continuum with tabulated cross-section against
wavelength. Interpolated using weno4.
.. attribute:: wavelengthGrid</p>
<blockquote>
<div><p>Wavelengths at which cross-section is tabulated [nm].</p>
<dl class="field-list simple">
<dt class="field-odd">type</dt>
<dd class="field-odd"><p>list of float</p>
</dd>
</dl>
</div></blockquote>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.ExplicitContinuum.alphaGrid">
<code class="sig-name descname">alphaGrid</code><a class="headerlink" href="#lightweaver.atomic_model.ExplicitContinuum.alphaGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Tabulated cross-sections [m2].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.ExplicitContinuum.alpha">
<code class="sig-name descname">alpha</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#ExplicitContinuum.alpha"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.ExplicitContinuum.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cross-section as a function of wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelength</strong> (<em>np.ndarray</em>) – Wavelengths at which to compute the cross-section [nm].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>alpha</strong> – Cross-section at associated wavelength.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.ExplicitContinuum.minLambda">
<em class="property">property </em><code class="sig-name descname">minLambda</code><a class="headerlink" href="#lightweaver.atomic_model.ExplicitContinuum.minLambda" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum wavelength at which this transition contributes.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.ExplicitContinuum.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#ExplicitContinuum.wavelength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.ExplicitContinuum.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the wavelength grid at which this transition needs to be
computed to be correctly integrated. Specific handling is added to
ensure that it is treated properly close to the edge.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.HydrogenicContinuum">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">HydrogenicContinuum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">NlambdaGen</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">alpha0</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">minWavelength</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#HydrogenicContinuum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.AtomicContinuum" title="lightweaver.atomic_model.AtomicContinuum"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.AtomicContinuum</span></code></a></p>
<p>Specific case of a Hydrogenic continuum, approximately falling off as
1/nu**3 towards higher frequencies (additional effects from Gaunt
factor).</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.NlambaGen">
<code class="sig-name descname">NlambaGen</code><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.NlambaGen" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of points to generate for the wavelength grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.alpha0">
<code class="sig-name descname">alpha0</code><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.alpha0" title="Permalink to this definition">¶</a></dt>
<dd><p>The cross-section at the edge wavelength [m2].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.minWavelength">
<code class="sig-name descname">minWavelength</code><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.minWavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum wavelength below which this transition is assumed to no
longer contribute [nm].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.alpha">
<code class="sig-name descname">alpha</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#HydrogenicContinuum.alpha"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cross-section as a function of wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelength</strong> (<em>np.ndarray</em>) – Wavelengths at which to compute the cross-section [nm].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>alpha</strong> – Cross-section at associated wavelength.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.minLambda">
<em class="property">property </em><code class="sig-name descname">minLambda</code><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.minLambda" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum wavelength at which this transition contributes.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.HydrogenicContinuum.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#HydrogenicContinuum.wavelength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.HydrogenicContinuum.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the wavelength grid at which this transition needs to be
computed to be correctly integrated.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.LineProfileResult">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">LineProfileResult</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phi</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">aDamp</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">Qelast</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#LineProfileResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.LineProfileResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Dataclass for returning the line profile and associated data that needs
to be saved (damping parameter and elastic collision rate) from the
frontend to the backend.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.LineProfileState">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">LineProfileState</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vlosMu</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em>, <em class="sig-param"><span class="n">default_voigt_callback</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">vBroad</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#LineProfileState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Dataclass used to communicate line profile calculations from the backend
to the frontend whilst allowing the backend to provide an overrideable
optimised voigt implementation for the default case.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.wavelength">
<code class="sig-name descname">wavelength</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavelengths at which to compute the line profile [nm]</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.vlosMu">
<code class="sig-name descname">vlosMu</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.vlosMu" title="Permalink to this definition">¶</a></dt>
<dd><p>Bulk velocity projected onto each ray in the angular integration scheme [m/s] in an array of [Nmu, Nspace].</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.atmos">
<code class="sig-name descname">atmos</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.atmos" title="Permalink to this definition">¶</a></dt>
<dd><p>The associated atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">Atmosphere</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.eqPops">
<code class="sig-name descname">eqPops</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.eqPops" title="Permalink to this definition">¶</a></dt>
<dd><p>The associated populations for each species present in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable">SpeciesStateTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.default_voigt_callback">
<code class="sig-name descname">default_voigt_callback</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.default_voigt_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Voigt profile for the default case, takes the damping
parameter aDamp and broadening velocity vBroad as arguments, and
returns the line profile phi (in this case phi_num in the tech report).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_model.LineProfileState.vBroad">
<code class="sig-name descname">vBroad</code><a class="headerlink" href="#lightweaver.atomic_model.LineProfileState.vBroad" title="Permalink to this definition">¶</a></dt>
<dd><p>Cache to avoid recomputing vBroad every time. May be None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray, optional</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.LineQuadrature">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">LineQuadrature</code><a class="reference internal" href="_modules/lightweaver/atomic_model.html#LineQuadrature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.LineQuadrature" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Describes the wavelength quadrature to be used for integrating properties
associated with a line.</p>
<dl class="py method">
<dt id="lightweaver.atomic_model.LineQuadrature.doppler_units">
<code class="sig-name descname">doppler_units</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine">lightweaver.atomic_model.AtomicLine</a></span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#LineQuadrature.doppler_units"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.LineQuadrature.doppler_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadrature in Doppler units.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.LineQuadrature.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine">lightweaver.atomic_model.AtomicLine</a></span></em>, <em class="sig-param"><span class="n">vMicroChar</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">3000.0</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#LineQuadrature.wavelength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.LineQuadrature.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadrature in nm.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.LineType">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">LineType</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#LineType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.LineType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Enum to show if the line should be treated in CRD or PRD.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.LinearCoreExpWings">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">LinearCoreExpWings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">qCore</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">qWing</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">Nlambda</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#LinearCoreExpWings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.LinearCoreExpWings" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.LineQuadrature" title="lightweaver.atomic_model.LineQuadrature"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.LineQuadrature</span></code></a></p>
<p>RH-Style line quadrature, with approximately linear core spacing and
exponential wing spacing, by using a function of the form
q(n) = a*(n + (exp(b*n)-1))
with n in [0, N) satisfying the following conditions:</p>
<blockquote>
<div><ul class="simple">
<li><p>q[0] = 0</p></li>
<li><p>q[(N-1)/2] = qcore</p></li>
<li><p>q[N-1] = qwing.</p></li>
</ul>
</div></blockquote>
<dl class="py method">
<dt id="lightweaver.atomic_model.LinearCoreExpWings.doppler_units">
<code class="sig-name descname">doppler_units</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine">lightweaver.atomic_model.AtomicLine</a></span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#LinearCoreExpWings.doppler_units"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.LinearCoreExpWings.doppler_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadrature in Doppler units.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.LinearCoreExpWings.wavelength">
<code class="sig-name descname">wavelength</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine">lightweaver.atomic_model.AtomicLine</a></span></em>, <em class="sig-param"><span class="n">vMicroChar</span><span class="o">=</span><span class="default_value">3000.0</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_model.html#LinearCoreExpWings.wavelength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.LinearCoreExpWings.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadrature in nm.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_model.VoigtLine">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">VoigtLine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">f</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">type</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineType" title="lightweaver.atomic_model.LineType">lightweaver.atomic_model.LineType</a></span></em>, <em class="sig-param"><span class="n">quadrature</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineQuadrature" title="lightweaver.atomic_model.LineQuadrature">lightweaver.atomic_model.LineQuadrature</a></span></em>, <em class="sig-param"><span class="n">broadening</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.broadening.LineBroadening" title="lightweaver.broadening.LineBroadening">lightweaver.broadening.LineBroadening</a></span></em>, <em class="sig-param"><span class="n">gLandeEff</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#VoigtLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.VoigtLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_model.AtomicLine</span></code></a></p>
<p>Specialised line profile for the default case of a Voigt profile.</p>
<dl class="py method">
<dt id="lightweaver.atomic_model.VoigtLine.compute_phi">
<code class="sig-name descname">compute_phi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.LineProfileState" title="lightweaver.atomic_model.LineProfileState">lightweaver.atomic_model.LineProfileState</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_model.LineProfileResult" title="lightweaver.atomic_model.LineProfileResult">lightweaver.atomic_model.LineProfileResult</a><a class="reference internal" href="_modules/lightweaver/atomic_model.html#VoigtLine.compute_phi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.VoigtLine.compute_phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the line profile.</p>
<p>In the case of a VoigtLine the line profile simply uses the
default_voigt_callback from the backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="#lightweaver.atomic_model.LineProfileState" title="lightweaver.atomic_model.LineProfileState"><em>LineProfileState</em></a>) – The information from the backend</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – The line profile, as well as the damping parameter ‘a’ and and
the broadening velocity.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.LineProfileResult" title="lightweaver.atomic_model.LineProfileResult">LineProfileResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_model.VoigtLine.damping">
<code class="sig-name descname">damping</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em>, <em class="sig-param"><span class="n">vBroad</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#VoigtLine.damping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.VoigtLine.damping" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the damping parameter and elastic collision rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere to consider.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations in this atmosphere.</p></li>
<li><p><strong>vBroad</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The broadening velocity, will be used if passed, or computed
using atom.vBroad if not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>aDamp</strong> (<em>np.ndarray</em>) – The Voigt damping parameter.</p></li>
<li><p><strong>Qelast</strong> (<em>np.ndarray</em>) – The rate of elastic collisions broadening the line – needed for PRD.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_model.reconfigure_atom">
<code class="sig-prename descclassname">lightweaver.atomic_model.</code><code class="sig-name descname">reconfigure_atom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">lightweaver.atomic_model.AtomicModel</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_model.html#reconfigure_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_model.reconfigure_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-perform all atomic set up after modifying parameters.</p>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.atomic_set">
<span id="lightweaver-atomic-set-module"></span><h2>lightweaver.atomic_set module<a class="headerlink" href="#module-lightweaver.atomic_set" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.atomic_set.AtomicState">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">AtomicState</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">lightweaver.atomic_model.AtomicModel</a></span></em>, <em class="sig-param"><span class="n">abundance</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">nStar</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">nTotal</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">detailed</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pops</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">radiativeRates</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Dict<span class="p">[</span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#AtomicState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.AtomicState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for the state of an atomic model during a simulation.</p>
<p>This hold both the model, as well as the simulations properties such as abundance, populations and radiative rates.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.model">
<code class="sig-name descname">model</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The python model of the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">AtomicModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.abundance">
<code class="sig-name descname">abundance</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.abundance" title="Permalink to this definition">¶</a></dt>
<dd><p>The abundance of the species as a fraction of H abundance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.nStar">
<code class="sig-name descname">nStar</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.nStar" title="Permalink to this definition">¶</a></dt>
<dd><p>The LTE populations of the species.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.nTotal">
<code class="sig-name descname">nTotal</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.nTotal" title="Permalink to this definition">¶</a></dt>
<dd><p>The total species population at each point in the atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.detailed">
<code class="sig-name descname">detailed</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.detailed" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the species has detailed populations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.pops">
<code class="sig-name descname">pops</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.pops" title="Permalink to this definition">¶</a></dt>
<dd><p>The NLTE populations for the species, if detailed is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.AtomicState.radiativeRates">
<code class="sig-name descname">radiativeRates</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.radiativeRates" title="Permalink to this definition">¶</a></dt>
<dd><p>If detailed the radiative rates for the species will be present here,
stored under (i, j) and (j, i) for each transition.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[(int, int), np.ndarray], optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.dimensioned_unit_view">
<code class="sig-name descname">dimensioned_unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#AtomicState.dimensioned_unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.dimensioned_unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of AtomicState reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model,
and the correct <cite>astropy.units</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>tuple</em>) – The shape to reshape to, this can be obtained from Atmosphere.structure.dimensioned_shape</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – An instance of self with the arrays reshaped to the appropriate
dimensionality.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState">AtomicState</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.dimensioned_view">
<code class="sig-name descname">dimensioned_view</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#AtomicState.dimensioned_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.dimensioned_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of AtomicState reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model, as
these are all stored under a flat scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>tuple</em>) – The shape to reshape to, this can be obtained from Atmosphere.structure.dimensioned_shape</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – An instance of self with the arrays reshaped to the appropriate
dimensionality.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState">AtomicState</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.element">
<em class="property">property </em><code class="sig-name descname">element</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.element" title="Permalink to this definition">¶</a></dt>
<dd><p>The element associated with this model.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.mass">
<em class="property">property </em><code class="sig-name descname">mass</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>The mass of the element associated with this model.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.n">
<em class="property">property </em><code class="sig-name descname">n</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.n" title="Permalink to this definition">¶</a></dt>
<dd><p>The NLTE populations, if present, or the LTE populations.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the element associated with this model.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.set_n_to_lte">
<code class="sig-name descname">set_n_to_lte</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#AtomicState.set_n_to_lte"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.set_n_to_lte" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the NLTE populations to LTE.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.unit_view">
<code class="sig-name descname">unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#AtomicState.unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of the AtomicState with the correct
<cite>astropy.units</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicState.update_nTotal">
<code class="sig-name descname">update_nTotal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">lightweaver.atmosphere.Atmosphere</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#AtomicState.update_nTotal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.AtomicState.update_nTotal" title="Permalink to this definition">¶</a></dt>
<dd><p>Update nTotal assuming either the abundance or nHTot have changed.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_set.AtomicStateTable">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">AtomicStateTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState">lightweaver.atomic_set.AtomicState</a><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#AtomicStateTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.AtomicStateTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for AtomicStates.</p>
<p>The __getitem__ on this class is intended to be smart, and should work
correctly with ints, strings, or Elements and return the associated
AtomicState.
This object is not normally constructed directly by the user, but will
instead be interacted with as a means of transporting information to and
from the backend.</p>
<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicStateTable.dimensioned_unit_view">
<code class="sig-name descname">dimensioned_unit_view</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#AtomicStateTable.dimensioned_unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.AtomicStateTable.dimensioned_unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of AtomicStateTable reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model,
and the correct <cite>astropy.units</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>tuple</em>) – The shape to reshape to, this can be obtained from Atmosphere.structure.dimensioned_shape</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – An instance of self with the arrays reshaped to the appropriate
dimensionality.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable">AtomicStateTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicStateTable.dimensioned_view">
<code class="sig-name descname">dimensioned_view</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#AtomicStateTable.dimensioned_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.AtomicStateTable.dimensioned_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of AtomicStateTable reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model, as
these are all stored under a flat scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>tuple</em>) – The shape to reshape to, this can be obtained from Atmosphere.structure.dimensioned_shape</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – An instance of self with the arrays reshaped to the appropriate
dimensionality.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable">AtomicStateTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.AtomicStateTable.unit_view">
<code class="sig-name descname">unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#AtomicStateTable.unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.AtomicStateTable.unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of the AtomicStateTable with the correct
<cite>astropy.units</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_set.RadiativeSet">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">RadiativeSet</code><span class="sig-paren">(</span><em class="sig-param">atoms: List[lightweaver.atomic_model.AtomicModel], abundance: lightweaver.atomic_table.AtomicAbundance = &lt;lightweaver.atomic_table.AtomicAbundance object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#RadiativeSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Used to configure the atomic models present in the simulation and then
set up the global wavelength grid and initial populations.
All atoms start passive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>list of AtomicModel</em>) – The atomic models to be used in the simulation (active, detailed, and
background).</p></li>
<li><p><strong>abundance</strong> (<a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance"><em>AtomicAbundance</em></a><em>, </em><em>optional</em>) – The abundance to be used for each species.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.abundance">
<code class="sig-name descname">abundance</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.abundance" title="Permalink to this definition">¶</a></dt>
<dd><p>The abundances in use.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">AtomicAbundance</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.elements">
<code class="sig-name descname">elements</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.elements" title="Permalink to this definition">¶</a></dt>
<dd><p>The elements present in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of Elements</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.atoms">
<code class="sig-name descname">atoms</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Mapping from Element to associated model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[<a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a>, <a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">AtomicModel</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.passiveSet">
<code class="sig-name descname">passiveSet</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.passiveSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Set of atoms (designmated by their Elements) set to passive in the
simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set of Elements</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.detailedStaticSet">
<code class="sig-name descname">detailedStaticSet</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.detailedStaticSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Set of atoms (designmated by their Elements) set to “detailed static” in the
simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set of Elements</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.RadiativeSet.activeSet">
<code class="sig-name descname">activeSet</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.activeSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Set of atoms (designmated by their Elements) set to active in the
simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set of Elements</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.activeAtoms">
<em class="property">property </em><code class="sig-name descname">activeAtoms</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.activeAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>List of AtomicModels set to active.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.compute_eq_pops">
<code class="sig-name descname">compute_eq_pops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">lightweaver.atmosphere.Atmosphere</a></span></em>, <em class="sig-param"><span class="n">mols</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable">lightweaver.molecule.MolecularTable</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nlteStartingPops</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Dict<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#RadiativeSet.compute_eq_pops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.compute_eq_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the starting populations for the simulation with all NLTE
atoms in LTE or otherwise using the provided populations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere for which to compute the populations.</p></li>
<li><p><strong>mols</strong> (<a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable"><em>MolecularTable</em></a><em>, </em><em>optional</em>) – Molecules to be included in the populations (default: None)</p></li>
<li><p><strong>nlteStartingPops</strong> (<em>Dict</em><em>[</em><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element"><em>Element</em></a><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Starting population override for any active or detailed static
species.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eqPops</strong> – The configured initial populations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SpeciesStatTable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.compute_wavelength_grid">
<code class="sig-name descname">compute_wavelength_grid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">extraWavelengths</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lambdaReference</span><span class="o">=</span><span class="default_value">500.0</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration">lightweaver.atomic_set.SpectrumConfiguration</a><a class="reference internal" href="_modules/lightweaver/atomic_set.html#RadiativeSet.compute_wavelength_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.compute_wavelength_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the global wavelength grid from the current configuration of
the RadiativeSet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extraWavelengths</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Extra wavelengths to add to the global array [nm].</p></li>
<li><p><strong>lambdaReference</strong> (<em>float</em><em>, </em><em>optional</em>) – If a difference reference wavelength is to be used then it should
be specified here to ensure it is in the global array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spect</strong> – The configured wavelength grids needed to set up the backend.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration">SpectrumConfiguration</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.detailedAtoms">
<em class="property">property </em><code class="sig-name descname">detailedAtoms</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.detailedAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>List of AtomicModels set to detailed static.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.is_active">
<code class="sig-name descname">is_active</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>str<span class="p">, </span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/lightweaver/atomic_set.html#RadiativeSet.is_active"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.is_active" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if an atom (designated by int, (int, int), str, or Element) is
active.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.is_detailed">
<code class="sig-name descname">is_detailed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>str<span class="p">, </span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/lightweaver/atomic_set.html#RadiativeSet.is_detailed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.is_detailed" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if an atom (designated by int, (int, int), str, or Element) is
passive.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.is_passive">
<code class="sig-name descname">is_passive</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>str<span class="p">, </span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/lightweaver/atomic_set.html#RadiativeSet.is_passive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.is_passive" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if an atom (designated by int, (int, int), str, or Element) is
passive.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.iterate_lte_ne_eq_pops">
<code class="sig-name descname">iterate_lte_ne_eq_pops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">lightweaver.atmosphere.Atmosphere</a></span></em>, <em class="sig-param"><span class="n">mols</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable">lightweaver.molecule.MolecularTable</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nlteStartingPops</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Dict<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">direct</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable">lightweaver.atomic_set.SpeciesStateTable</a><a class="reference internal" href="_modules/lightweaver/atomic_set.html#RadiativeSet.iterate_lte_ne_eq_pops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.iterate_lte_ne_eq_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the starting populations for the simulation with all NLTE
atoms in LTE or otherwise using the provided populations.
Additionally computes a self-consistent LTE electron density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere for which to compute the populations.</p></li>
<li><p><strong>mols</strong> (<a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable"><em>MolecularTable</em></a><em>, </em><em>optional</em>) – Molecules to be included in the populations (default: None)</p></li>
<li><p><strong>nlteStartingPops</strong> (<em>Dict</em><em>[</em><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element"><em>Element</em></a><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – Starting population override for any active or detailed static
species.</p></li>
<li><p><strong>direct</strong> (<em>bool</em>) – Whether to use the direct electron density solver (essentially, Lambda iteration for the fixpoint), this may require many more iterations than the Newton-Krylov solver used otherwise, but may also be more robust.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eqPops</strong> – The configured initial populations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SpeciesStatTable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.passiveAtoms">
<em class="property">property </em><code class="sig-name descname">passiveAtoms</code><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.passiveAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>List of AtomicModels set to passive.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.set_active">
<code class="sig-name descname">set_active</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#RadiativeSet.set_active"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.set_active" title="Permalink to this definition">¶</a></dt>
<dd><p>Set one (or multiple) atoms active.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.set_detailed_static">
<code class="sig-name descname">set_detailed_static</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#RadiativeSet.set_detailed_static"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.set_detailed_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Set one (or multiple) atoms to detailed static</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.RadiativeSet.set_passive">
<code class="sig-name descname">set_passive</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#RadiativeSet.set_passive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.RadiativeSet.set_passive" title="Permalink to this definition">¶</a></dt>
<dd><p>Set one (or multiple) atoms passive.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_set.SpeciesStateTable">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">SpeciesStateTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmosphere</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">lightweaver.atmosphere.Atmosphere</a></span></em>, <em class="sig-param"><span class="n">abundance</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">lightweaver.atomic_table.AtomicAbundance</a></span></em>, <em class="sig-param"><span class="n">atomicPops</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable">lightweaver.atomic_set.AtomicStateTable</a></span></em>, <em class="sig-param"><span class="n">molecularTable</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable">lightweaver.molecule.MolecularTable</a></span></em>, <em class="sig-param"><span class="n">molecularPops</span><span class="p">:</span> <span class="n">List<span class="p">[</span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">HminPops</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#SpeciesStateTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for the species populations in the simulation. Similar to
AtomicStateTable but also holding the molecular populations and the
atmosphere object.</p>
<p>The __getitem__ is intended to be smart, returning in order of priority
on the name match (int, str, Element), H- populations, molecular
populations, NLTE atomic populations, LTE atomic populations.
This object is not normally constructed directly by the user, but will
instead be interacted with as a means of transporting information to and
from the backend.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.atmosphere">
<code class="sig-name descname">atmosphere</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.atmosphere" title="Permalink to this definition">¶</a></dt>
<dd><p>The atmosphere object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">Atmosphere</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.abundance">
<code class="sig-name descname">abundance</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.abundance" title="Permalink to this definition">¶</a></dt>
<dd><p>The abundance of all species present in the atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">AtomicAbundance</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.atomicPops">
<code class="sig-name descname">atomicPops</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.atomicPops" title="Permalink to this definition">¶</a></dt>
<dd><p>The atomic populations state container.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable">AtomicStateTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.molecularTable">
<code class="sig-name descname">molecularTable</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.molecularTable" title="Permalink to this definition">¶</a></dt>
<dd><p>The molecules present in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable">MolecularTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.molecularPops">
<code class="sig-name descname">molecularPops</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.molecularPops" title="Permalink to this definition">¶</a></dt>
<dd><p>The populations of each molecule in the molecularTable</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpeciesStateTable.HminPops">
<code class="sig-name descname">HminPops</code><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.HminPops" title="Permalink to this definition">¶</a></dt>
<dd><p>H- ion populations throughout the atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.SpeciesStateTable.dimensioned_unit_view">
<code class="sig-name descname">dimensioned_unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#SpeciesStateTable.dimensioned_unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.dimensioned_unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of SpeciesStateTable reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model,
and the correct <cite>astropy.units</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.SpeciesStateTable.dimensioned_view">
<code class="sig-name descname">dimensioned_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#SpeciesStateTable.dimensioned_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.dimensioned_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of SpeciesStateTable reshaped so all data
has the correct (1/2/3D) dimensionality for the atmospheric model, as
these are all stored under a flat scheme.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.SpeciesStateTable.unit_view">
<code class="sig-name descname">unit_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#SpeciesStateTable.unit_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.unit_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a view over the contents of the SpeciesStateTable with the correct
<cite>astropy.units</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.SpeciesStateTable.update_lte_atoms_Hmin_pops">
<code class="sig-name descname">update_lte_atoms_Hmin_pops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">lightweaver.atmosphere.Atmosphere</a></span></em>, <em class="sig-param"><span class="n">conserveCharge</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">updateTotals</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">maxIter</span><span class="o">=</span><span class="default_value">2000</span></em>, <em class="sig-param"><span class="n">quiet</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">0.001</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#SpeciesStateTable.update_lte_atoms_Hmin_pops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.SpeciesStateTable.update_lte_atoms_Hmin_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Under the assumption that the atmosphere has changed, update the LTE
atomic populations and the H- populations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere object.</p></li>
<li><p><strong>conserveCharge</strong> (<em>bool</em>) – Whether to conserveCharge and adjust the electron density in
atmos based on the change in ionisation of the non-detailed
species (default: False).</p></li>
<li><p><strong>updateTotals</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to update the totals of each species from the abundance
and total hydrogen density (default: False).</p></li>
<li><p><strong>maxIter</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of iterations to take looking for a stable
solution (default: 2000).</p></li>
<li><p><strong>quiet</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print information about the update (default: False)</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – The tolerance of relative change at which to consider the
populations converged (default: 1e-3)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_set.SpectrumConfiguration">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">SpectrumConfiguration</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">radSet</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_set.RadiativeSet" title="lightweaver.atomic_set.RadiativeSet">lightweaver.atomic_set.RadiativeSet</a></span></em>, <em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">models</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">lightweaver.atomic_model.AtomicModel</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">transWavelengths</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>Tuple<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">blueIdx</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>Tuple<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">activeTrans</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>Tuple<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>bool<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">activeWavelengths</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>Tuple<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a><span class="p">, </span>int<span class="p">, </span>int<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_set.html#SpectrumConfiguration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for the configuration of common wavelength grid and species
active at each wavelength.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.radSet">
<code class="sig-name descname">radSet</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.radSet" title="Permalink to this definition">¶</a></dt>
<dd><p>The set of atoms involved in the creation of this simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.RadiativeSet" title="lightweaver.atomic_set.RadiativeSet">RadiativeSet</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.wavelength">
<code class="sig-name descname">wavelength</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>The common wavelength array used for this simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.models">
<code class="sig-name descname">models</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.models" title="Permalink to this definition">¶</a></dt>
<dd><p>The models for the active and detailed static atoms present in this
simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of AtomicModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.transWavelengths">
<code class="sig-name descname">transWavelengths</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.transWavelengths" title="Permalink to this definition">¶</a></dt>
<dd><p>The local wavelength grid for each transition stored in a dictionary
by transition ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[(<a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a>, i, j), np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.blueIdx">
<code class="sig-name descname">blueIdx</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.blueIdx" title="Permalink to this definition">¶</a></dt>
<dd><p>The index at which each local grid starts in the global wavelength
array.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[(<a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a>, i, j), int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.activeTrans">
<code class="sig-name descname">activeTrans</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.activeTrans" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this transition is ever active (contributing in either an
active or detailed static sense) over the range of wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[(<a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a>, i, j), bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.activeWavelengths">
<code class="sig-name descname">activeWavelengths</code><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.activeWavelengths" title="Permalink to this definition">¶</a></dt>
<dd><p>A mask of the wavelengths at which this transition is active.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dict[(<a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a>, i, j), np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_set.SpectrumConfiguration.subset_configuration">
<code class="sig-name descname">subset_configuration</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelengths</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration">lightweaver.atomic_set.SpectrumConfiguration</a><a class="reference internal" href="_modules/lightweaver/atomic_set.html#SpectrumConfiguration.subset_configuration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.SpectrumConfiguration.subset_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a SpectrumConfiguration for a sub-region of the global wavelength array.</p>
<p>This is typically used for computing a final formal solution on a single ray through the atmosphere. In this situation all lines are set to contribute throughout the entire grid, to avoid situations where small jumps in intensity occur from lines being cut off.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelengths</strong> (<em>np.ndarray</em>) – The grid on which to produce the new SpectrumConfiguration.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spectrumConfig</strong> – The subset spectrum configuration.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration">SpectrumConfiguration</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_set.chemical_equilibrium_fixed_ne">
<code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">chemical_equilibrium_fixed_ne</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">lightweaver.atmosphere.Atmosphere</a></span></em>, <em class="sig-param"><span class="n">molecules</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable">lightweaver.molecule.MolecularTable</a></span></em>, <em class="sig-param"><span class="n">atomicPops</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable">lightweaver.atomic_set.AtomicStateTable</a></span></em>, <em class="sig-param"><span class="n">abundance</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">lightweaver.atomic_table.AtomicAbundance</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable">lightweaver.atomic_set.SpeciesStateTable</a><a class="reference internal" href="_modules/lightweaver/atomic_set.html#chemical_equilibrium_fixed_ne"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.chemical_equilibrium_fixed_ne" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the molecular populations from the current atmospheric model and
atomic populations.</p>
<p>This method assumes that the number of electrons bound in molecules is
insignificant, and neglects this.
Intended for internal use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The model atmosphere of the simulation.</p></li>
<li><p><strong>molecules</strong> (<a class="reference internal" href="#lightweaver.molecule.MolecularTable" title="lightweaver.molecule.MolecularTable"><em>MolecularTable</em></a>) – The molecules to consider.</p></li>
<li><p><strong>atomicPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.AtomicStateTable" title="lightweaver.atomic_set.AtomicStateTable"><em>AtomicStateTable</em></a>) – The atomic populations.</p></li>
<li><p><strong>abundance</strong> (<a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance"><em>AtomicAbundance</em></a>) – The abundance of each species in the simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>state</strong> – The combined state object of atomic and molecular populations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SpeciesState</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_set.hminus_pops">
<code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">hminus_pops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">lightweaver.atmosphere.Atmosphere</a></span></em>, <em class="sig-param"><span class="n">hPops</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState">lightweaver.atomic_set.AtomicState</a></span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_set.html#hminus_pops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.hminus_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the H- ion populations for a given atmosphere</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere object.</p></li>
<li><p><strong>hPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState"><em>AtomicState</em></a>) – The hydrogen populations state associated with atmos.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>HminPops</strong> – The H- populations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_set.lte_pops">
<code class="sig-prename descclassname">lightweaver.atomic_set.</code><code class="sig-name descname">lte_pops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atomicModel</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">lightweaver.atomic_model.AtomicModel</a></span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ne</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">nTotal</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">nStar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">debye</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_set.html#lte_pops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_set.lte_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the LTE populations for a given atomic model under given
thermodynamic conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atomicModel</strong> (<a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel"><em>AtomicModel</em></a>) – The atomic model to consider.</p></li>
<li><p><strong>temperature</strong> (<em>np.ndarray</em>) – The temperature structure in the atmosphere.</p></li>
<li><p><strong>ne</strong> (<em>np.ndarray</em>) – The electron density in the atmosphere.</p></li>
<li><p><strong>nTotal</strong> (<em>np.ndarray</em>) – The total population of the species at each point in the atmosphere.</p></li>
<li><p><strong>nStar</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – An optional array to store the result in.</p></li>
<li><p><strong>debye</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to consider Debye shielding (default: True).1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ltePops</strong> – The ltePops for the species.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.atomic_table">
<span id="lightweaver-atomic-table-module"></span><h2>lightweaver.atomic_table module<a class="headerlink" href="#module-lightweaver.atomic_table" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.atomic_table.AtomicAbundance">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">AtomicAbundance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">abundanceData</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">abundDex</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">metallicity</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#AtomicAbundance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container and accessor for atomic abundance data. This can be
instantiated with a subset of atomic abundances, which will be used in
conjunction with the the default values for non-specified elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>abundanceData</strong> (<em>dict</em><em>, </em><em>optional</em>) – Contains the abundance data to override. For elements this should be
dict[Element] = abundance, and for isotopes dict[Isotope] = isotope
fraction.</p></li>
<li><p><strong>abundDex</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the supplied abundance is in dex (with Hydrogen abundance of
12.0) or in relative Hydrogen abundance (default: True i.e. in dex).</p></li>
<li><p><strong>metallicity</strong> (<em>float</em><em>, </em><em>optional</em>) – Enhance the metallic abundance by a factor of 10**metallicity,
(default: 0.0).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.apply_metallicity">
<em class="property">static </em><code class="sig-name descname">apply_metallicity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">abunds</span></em>, <em class="sig-param"><span class="n">metallicity</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#AtomicAbundance.apply_metallicity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.apply_metallicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to adjust the metallicity of the abundances, by a fraction
10**metallicity.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.compute_stats">
<code class="sig-name descname">compute_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#AtomicAbundance.compute_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.compute_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the total abundance (totalAbundance), mass per H atom
(massPerH), and average mass per Element (avgMass).</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.convert_isotopes_to_abundances">
<code class="sig-name descname">convert_isotopes_to_abundances</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#AtomicAbundance.convert_isotopes_to_abundances"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.convert_isotopes_to_abundances" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the isotope fractions to relative Hydrogen abundance.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.dex_to_decimal">
<em class="property">static </em><code class="sig-name descname">dex_to_decimal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">abunds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#AtomicAbundance.dex_to_decimal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.dex_to_decimal" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to convert from absolute abundance in dex to relative fractional
abundance.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.get_primary_isotope">
<code class="sig-name descname">get_primary_isotope</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.atomic_table.Isotope" title="lightweaver.atomic_table.Isotope">lightweaver.atomic_table.Isotope</a><a class="reference internal" href="_modules/lightweaver/atomic_table.html#AtomicAbundance.get_primary_isotope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.get_primary_isotope" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Isotope with the highest abundance of a particular
Element.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.AtomicAbundance.load_default_abundance_data">
<em class="property">static </em><code class="sig-name descname">load_default_abundance_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/lightweaver/atomic_table.html#AtomicAbundance.load_default_abundance_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.AtomicAbundance.load_default_abundance_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the default abundances and convert to required format for
AtomicAbundance class (i.e. dict where dict[Element] = abundance, and
dict[Isotope] = isotope fraction).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_table.Element">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">Element</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Z</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#Element"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A simple value comparable description of an element (just proton number
Z), that can be quickly and easily compared, whilst allowing access to
things from the periodic table.</p>
<dl class="py method">
<dt id="lightweaver.atomic_table.Element.mass">
<em class="property">property </em><code class="sig-name descname">mass</code><a class="headerlink" href="#lightweaver.atomic_table.Element.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mass of the element in AMU.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.Element.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#lightweaver.atomic_table.Element.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the element as a string.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_table.Isotope">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">Isotope</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">Z</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#Isotope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.Isotope" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.atomic_table.Element</span></code></a></p>
<p>A simple value comparable isotope description, inheriting from Element.</p>
<dl class="py method">
<dt id="lightweaver.atomic_table.Isotope.element">
<em class="property">property </em><code class="sig-name descname">element</code><a class="headerlink" href="#lightweaver.atomic_table.Isotope.element" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the underlying Element of which this isotope is a family
member.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.Isotope.element_mass">
<em class="property">property </em><code class="sig-name descname">element_mass</code><a class="headerlink" href="#lightweaver.atomic_table.Isotope.element_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average mass of the element.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.Isotope.element_name">
<em class="property">property </em><code class="sig-name descname">element_name</code><a class="headerlink" href="#lightweaver.atomic_table.Isotope.element_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the Element as a string.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.Isotope.mass">
<em class="property">property </em><code class="sig-name descname">mass</code><a class="headerlink" href="#lightweaver.atomic_table.Isotope.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mass of the isotope in AMU.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.Isotope.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#lightweaver.atomic_table.Isotope.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the isotope as a string.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_table.KuruczPf">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">KuruczPf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a></span></em>, <em class="sig-param"><span class="n">abundance</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">Tpf</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">pf</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ionPot</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#KuruczPf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage and functions relating to Bob Kurucz’s partition functions.
Based on the data used in RH.</p>
<dl class="py attribute">
<dt id="lightweaver.atomic_table.KuruczPf.element">
<code class="sig-name descname">element</code><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.element" title="Permalink to this definition">¶</a></dt>
<dd><p>The element associated with this partition funciton.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">Element</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_table.KuruczPf.abundance">
<code class="sig-name descname">abundance</code><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.abundance" title="Permalink to this definition">¶</a></dt>
<dd><p>The abundance of this element.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_table.KuruczPf.Tpf">
<code class="sig-name descname">Tpf</code><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.Tpf" title="Permalink to this definition">¶</a></dt>
<dd><p>The temperature grid on which the partition function is defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_table.KuruczPf.pf">
<code class="sig-name descname">pf</code><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.pf" title="Permalink to this definition">¶</a></dt>
<dd><p>The partition function data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.atomic_table.KuruczPf.ionPot">
<code class="sig-name descname">ionPot</code><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.ionPot" title="Permalink to this definition">¶</a></dt>
<dd><p>The ionisation potential of each level.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.KuruczPf.fj">
<code class="sig-name descname">fj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#KuruczPf.fj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.fj" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the fractional population of the species in each ionisation
stage and partial derivative wrt n_e for each location in a given
atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere in which to compute the populations.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fj</strong> (<em>np.ndarray</em>) – The fractional populations [Nstage x Nspace].</p></li>
<li><p><strong>dfj</strong> (<em>np.ndarray</em>) – The derivatives of the fractional populations [Nstage x Nspace].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.KuruczPf.fjk">
<code class="sig-name descname">fjk</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">k</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#KuruczPf.fjk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.fjk" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the fractional population of the species in each ionisation
stage and partial derivative wrt n_e at one point in a given
atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere in which to compute the populations.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – The spatial index at which to compute the populations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fj</strong> (<em>np.ndarray</em>) – The fractional populations [Nstage].</p></li>
<li><p><strong>dfj</strong> (<em>np.ndarray</em>) – The derivatives of the fractional populations [Nstage].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.KuruczPf.lte_ionisation">
<code class="sig-name descname">lte_ionisation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/atomic_table.html#KuruczPf.lte_ionisation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.KuruczPf.lte_ionisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the population of the species in each ionisation
stage in a given atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere in which to compute the populations.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pops</strong> – The LTE ionisation populations [Nstage x Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_table.KuruczPfTable">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">KuruczPfTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atomicAbundance</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance">lightweaver.atomic_table.AtomicAbundance</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kuruczPfPath</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#KuruczPfTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.KuruczPfTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for all of the Kurucz partition function data, allowing
different paths and AtomicAbundances to be used. Serves to construct the
KuruczPf objects if used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atomicAbundance</strong> (<a class="reference internal" href="#lightweaver.atomic_table.AtomicAbundance" title="lightweaver.atomic_table.AtomicAbundance"><em>AtomicAbundance</em></a><em>, </em><em>optional</em>) – The abundance data to use, if non-standard.</p></li>
<li><p><strong>kuruczPfPath</strong> (<em>str</em>) – The path to the Kurucz parition function data in RH’s XDR format, if
non-standard.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.atomic_table.PeriodicTableData">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">PeriodicTableData</code><a class="reference internal" href="_modules/lightweaver/atomic_table.html#PeriodicTableData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.PeriodicTableData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container and accessor for the periodic table data. Not intended to be
instantiated by users, instead use the pre-instantiated PeriodicTable
instance.</p>
<dl class="py method">
<dt id="lightweaver.atomic_table.PeriodicTableData.elements">
<em class="property">property </em><code class="sig-name descname">elements</code><a class="headerlink" href="#lightweaver.atomic_table.PeriodicTableData.elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sorted list of Elements by proton number Z.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.PeriodicTableData.get_isotopes">
<em class="property">classmethod </em><code class="sig-name descname">get_isotopes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#lightweaver.atomic_table.Element" title="lightweaver.atomic_table.Element">lightweaver.atomic_table.Element</a></span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span><a class="reference internal" href="#lightweaver.atomic_table.Isotope" title="lightweaver.atomic_table.Isotope">lightweaver.atomic_table.Isotope</a><span class="p">]</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#PeriodicTableData.get_isotopes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.PeriodicTableData.get_isotopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all isotopes associated with a certain Element.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.PeriodicTableData.isotopes">
<em class="property">property </em><code class="sig-name descname">isotopes</code><a class="headerlink" href="#lightweaver.atomic_table.PeriodicTableData.isotopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sorted list of Isotopes by proton number Z.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.atomic_table.PeriodicTableData.nuclides">
<em class="property">property </em><code class="sig-name descname">nuclides</code><a class="headerlink" href="#lightweaver.atomic_table.PeriodicTableData.nuclides" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all nuclides (Elements and Isotopes).</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_table.load_periodic_table_data">
<code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">load_periodic_table_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/atomic_table.html#load_periodic_table_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.load_periodic_table_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal use function to load data from the AtomicMassesNames.pickle data
file.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.atomic_table.normalise_atom_name">
<code class="sig-prename descclassname">lightweaver.atomic_table.</code><code class="sig-name descname">normalise_atom_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/lightweaver/atomic_table.html#normalise_atom_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.atomic_table.normalise_atom_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalises Element names to be two characters long with an uppercase
first letter, and lower case second, or a space in the case of single
character names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<em>str</em>) – The name to normalise.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – The normalised name.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.barklem">
<span id="lightweaver-barklem-module"></span><h2>lightweaver.barklem module<a class="headerlink" href="#module-lightweaver.barklem" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.barklem.Barklem">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.barklem.</code><code class="sig-name descname">Barklem</code><a class="reference internal" href="_modules/lightweaver/barklem.html#Barklem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.barklem.Barklem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage for all three Barklem cross-section cases and application via the
<cite>get_active_cross_section</cite> function.</p>
<dl class="py method">
<dt id="lightweaver.barklem.Barklem.get_active_cross_section">
<em class="property">classmethod </em><code class="sig-name descname">get_active_cross_section</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span><span class="p">:</span> <span class="n">AtomicModel</span></em>, <em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n">AtomicLine</span></em>, <em class="sig-param"><span class="n">vals</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Sequence<span class="p">[</span>float<span class="p">]</span><a class="reference internal" href="_modules/lightweaver/barklem.html#Barklem.get_active_cross_section"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.barklem.Barklem.get_active_cross_section" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cross section data for use in the Van der Waals collisional broadening routines.
See:</p>
<blockquote>
<div><ul class="simple">
<li><p>Anstee &amp; O’Mara 1995, MNRAS 276, 859-866</p></li>
<li><p>Barklem &amp; O’Mara 1998, MNRAS 300, 863-871</p></li>
<li><p>Unsold:</p>
<ul>
<li><p>Traving 1960, “Uber die Theorie der Druckverbreiterung
von Spektrallinien”, p 91-97</p></li>
<li><p>Mihalas 1978, p. 282ff, and Table 9-1/</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>result</strong> – Barklem cross-section, Barklem alpha, Helium contribution
following Unsold (always 1.0)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of 3 float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="lightweaver.barklem.BarklemCrossSectionError">
<em class="property">exception </em><code class="sig-prename descclassname">lightweaver.barklem.</code><code class="sig-name descname">BarklemCrossSectionError</code><a class="reference internal" href="_modules/lightweaver/barklem.html#BarklemCrossSectionError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.barklem.BarklemCrossSectionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raised if the Barklem cross-section cannot be applied to the atom in
question.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.barklem.BarklemTable">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.barklem.</code><code class="sig-name descname">BarklemTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">neff0</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/barklem.html#BarklemTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.barklem.BarklemTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage for each table of Barklem data for Van der Waals approximation.</p>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.broadening">
<span id="lightweaver-broadening-module"></span><h2>lightweaver.broadening module<a class="headerlink" href="#module-lightweaver.broadening" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.broadening.HydrogenLinearStarkBroadening">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">HydrogenLinearStarkBroadening</code><a class="reference internal" href="_modules/lightweaver/broadening.html#HydrogenLinearStarkBroadening"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.HydrogenLinearStarkBroadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.StandardLineBroadener</span></code></a></p>
<p>Linear Stark broadening for the case of Hydrogen from Sutton 1978 (like
RH).</p>
<dl class="py method">
<dt id="lightweaver.broadening.HydrogenLinearStarkBroadening.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/broadening.html#HydrogenLinearStarkBroadening.broaden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.HydrogenLinearStarkBroadening.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.LineBroadener">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">LineBroadener</code><a class="reference internal" href="_modules/lightweaver/broadening.html#LineBroadener"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.LineBroadener" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for broadening implementations. To be used if your broadener
does something special and can’t just return an array.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.LineBroadening">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">LineBroadening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">natural</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener">lightweaver.broadening.StandardLineBroadener</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">elastic</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener">lightweaver.broadening.StandardLineBroadener</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span><a class="reference internal" href="#lightweaver.broadening.LineBroadener" title="lightweaver.broadening.LineBroadener">lightweaver.broadening.LineBroadener</a><span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/broadening.html#LineBroadening"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.LineBroadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Standard component of AtomicLine to compute the broadening parameters in
a flexible way.</p>
<p>For most Voigt-like situations, this should be usable without
modifications, but this class can be inherited from to make substantial
modifications.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>natural</strong> (<em>list of StandardLineBroadener</em>) – List of broadening terms that are not elastic collisions (separated for PRD).</p></li>
<li><p><strong>elastic</strong> (<em>list of StandardLineBroadener</em>) – List of elastic broadening terms.</p></li>
<li><p><strong>other</strong> (<em>list of LineBroadener</em><em>, </em><em>optional</em>) – List of other broadening terms, not used by the VoigtLine by default,
but existing to provide _options_ (default: None)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="lightweaver.broadening.LineBroadening.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#lightweaver.broadening.LineBroadeningResult" title="lightweaver.broadening.LineBroadeningResult">lightweaver.broadening.LineBroadeningResult</a><a class="reference internal" href="_modules/lightweaver/broadening.html#LineBroadening.broaden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.LineBroadening.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the broadening, this function is called by the AtomicLine object.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.broadening.LineBroadening.compute_other_broadening">
<em class="property">static </em><code class="sig-name descname">compute_other_broadening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">broadeners</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span><a class="reference internal" href="#lightweaver.broadening.LineBroadener" title="lightweaver.broadening.LineBroadener">lightweaver.broadening.LineBroadener</a><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>List<span class="p">]</span><a class="reference internal" href="_modules/lightweaver/broadening.html#LineBroadening.compute_other_broadening"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.LineBroadening.compute_other_broadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the computed broadening terms.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.broadening.LineBroadening.sum_broadening_list">
<em class="property">static </em><code class="sig-name descname">sum_broadening_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">broadeners</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener">lightweaver.broadening.StandardLineBroadener</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="_modules/lightweaver/broadening.html#LineBroadening.sum_broadening_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.LineBroadening.sum_broadening_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Sums a list of StandardLineBroadeners.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.LineBroadeningResult">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">LineBroadeningResult</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">natural</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">Qelast</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/broadening.html#LineBroadeningResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.LineBroadeningResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Result expected from instances of <cite>LineBroadening.broaden</cite>.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.MultiplicativeStarkBroadening">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">MultiplicativeStarkBroadening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coeff</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/broadening.html#MultiplicativeStarkBroadening"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.MultiplicativeStarkBroadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.StandardLineBroadener</span></code></a></p>
<p>Simple expression for multiplicative Stark broadening, assumes that this
can be expresed as a constant * ne.</p>
<dl class="py method">
<dt id="lightweaver.broadening.MultiplicativeStarkBroadening.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/broadening.html#MultiplicativeStarkBroadening.broaden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.MultiplicativeStarkBroadening.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.QuadraticStarkBroadening">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">QuadraticStarkBroadening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coeff</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/broadening.html#QuadraticStarkBroadening"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.QuadraticStarkBroadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.StandardLineBroadener</span></code></a></p>
<p>Lindholm theory result for Quadratic Stark broadening by electrons and
singly ionised particles.
Follows HM2014 pp. 238-239, uses C4 from Traving 1960 via RH.</p>
<dl class="py method">
<dt id="lightweaver.broadening.QuadraticStarkBroadening.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/broadening.html#QuadraticStarkBroadening.broaden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.QuadraticStarkBroadening.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.RadiativeBroadening">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">RadiativeBroadening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gamma</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/broadening.html#RadiativeBroadening"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.RadiativeBroadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.StandardLineBroadener</span></code></a></p>
<p>Simple constant radiative broadening with coefficient gamma.</p>
<dl class="py method">
<dt id="lightweaver.broadening.RadiativeBroadening.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/broadening.html#RadiativeBroadening.broaden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.RadiativeBroadening.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.StandardLineBroadener">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">StandardLineBroadener</code><a class="reference internal" href="_modules/lightweaver/broadening.html#StandardLineBroadener"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.StandardLineBroadener" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.LineBroadener" title="lightweaver.broadening.LineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.LineBroadener</span></code></a></p>
<p>Standard base class for broadening implementations. Unless you need to do
something weird, inherit from this one.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.VdwApprox">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">VdwApprox</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/broadening.html#VdwApprox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.VdwApprox" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.StandardLineBroadener" title="lightweaver.broadening.StandardLineBroadener"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.StandardLineBroadener</span></code></a></p>
<p>Base class for van der Waals approximation using a list of coefficients
(vals).</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.VdwBarklem">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">VdwBarklem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/broadening.html#VdwBarklem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.VdwBarklem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.VdwApprox" title="lightweaver.broadening.VdwApprox"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.VdwApprox</span></code></a></p>
<p>Implementation of the Barklem method for van der Waals broadening.</p>
<dl class="py method">
<dt id="lightweaver.broadening.VdwBarklem.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/broadening.html#VdwBarklem.broaden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.VdwBarklem.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.broadening.VdwUnsold">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.broadening.</code><code class="sig-name descname">VdwUnsold</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vals</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/broadening.html#VdwUnsold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.VdwUnsold" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.broadening.VdwApprox" title="lightweaver.broadening.VdwApprox"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.broadening.VdwApprox</span></code></a></p>
<p>Implementation of the Unsold method for van der Waals broadening.</p>
<dl class="py method">
<dt id="lightweaver.broadening.VdwUnsold.broaden">
<code class="sig-name descname">broaden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atmos</span><span class="p">:</span> <span class="n">Atmosphere</span></em>, <em class="sig-param"><span class="n">eqPops</span><span class="p">:</span> <span class="n">SpeciesStateTable</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/broadening.html#VdwUnsold.broaden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.broadening.VdwUnsold.broaden" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that is called by LineBroadening.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmosphere in which to compute the broadening.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations to use for computing the broadening.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>broad</strong> – An array detailing the broadening at each location in the
atmosphere [Nspace].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lightweaver.collisional_rates">
<span id="lightweaver-collisional-rates-module"></span><h2>lightweaver.collisional_rates module<a class="headerlink" href="#module-lightweaver.collisional_rates" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.collisional_rates.Ar85Cdi">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">Ar85Cdi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">cdi</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#Ar85Cdi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.Ar85Cdi" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.collisional_rates.CollisionalRates" title="lightweaver.collisional_rates.CollisionalRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.collisional_rates.CollisionalRates</span></code></a></p>
<p>Collisional ionisation rates based on Arnaud &amp; Rothenflug (1985, ApJS 60).
Units remain in CGS as per paper.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.collisional_rates.Burgess">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">Burgess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">fudge</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#Burgess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.Burgess" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.collisional_rates.CollisionalRates" title="lightweaver.collisional_rates.CollisionalRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.collisional_rates.CollisionalRates</span></code></a></p>
<p>Collisional ionisation from excited states from Burgess &amp; Chidichimo
(1983, MNRAS 203, 1269).
Fudge parameter is dimensionless.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.collisional_rates.CE">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">CE</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rates</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#CE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.CE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.collisional_rates.TemperatureInterpolationRates" title="lightweaver.collisional_rates.TemperatureInterpolationRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.collisional_rates.TemperatureInterpolationRates</span></code></a></p>
<p>Collisional (de-)excitation of neutrals by electrons.
Units: s^-1 K^-1/2 m^3
Rate scales as sqrt(T) exp(DeltaE)</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.collisional_rates.CH">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">CH</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rates</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#CH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.CH" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.collisional_rates.TemperatureInterpolationRates" title="lightweaver.collisional_rates.TemperatureInterpolationRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.collisional_rates.TemperatureInterpolationRates</span></code></a></p>
<p>Collisions with neutral hydrogen.
Units: s^-1 m^3</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.collisional_rates.CI">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">CI</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rates</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#CI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.CI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.collisional_rates.TemperatureInterpolationRates" title="lightweaver.collisional_rates.TemperatureInterpolationRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.collisional_rates.TemperatureInterpolationRates</span></code></a></p>
<p>Collisional ionisation by electrons.
Units: s^-1 K^-1/2 m^3
Rate scales as sqrt(T) exp(DeltaE)</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.collisional_rates.CP">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">CP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rates</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#CP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.CP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.collisional_rates.TemperatureInterpolationRates" title="lightweaver.collisional_rates.TemperatureInterpolationRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.collisional_rates.TemperatureInterpolationRates</span></code></a></p>
<p>Collisional (de-)excitation by protons.
Units: s^-1 m^3</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.collisional_rates.ChargeExchangeNeutralH">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">ChargeExchangeNeutralH</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rates</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#ChargeExchangeNeutralH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.ChargeExchangeNeutralH" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.collisional_rates.TemperatureInterpolationRates" title="lightweaver.collisional_rates.TemperatureInterpolationRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.collisional_rates.TemperatureInterpolationRates</span></code></a></p>
<p>Charge exchange with neutral hydrogen.
Units: s^-1 m^3
Note: downward rate only.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.collisional_rates.ChargeExchangeProton">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">ChargeExchangeProton</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rates</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#ChargeExchangeProton"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.ChargeExchangeProton" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.collisional_rates.TemperatureInterpolationRates" title="lightweaver.collisional_rates.TemperatureInterpolationRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.collisional_rates.TemperatureInterpolationRates</span></code></a></p>
<p>Charge exchange with protons.
Units: s^-1 m^3
Note: upward rate only.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.collisional_rates.CollisionalRates">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">CollisionalRates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#CollisionalRates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.CollisionalRates" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for all CollisionalRates.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.collisional_rates.Omega">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">Omega</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rates</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#Omega"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.Omega" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.collisional_rates.TemperatureInterpolationRates" title="lightweaver.collisional_rates.TemperatureInterpolationRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.collisional_rates.TemperatureInterpolationRates</span></code></a></p>
<p>Collisional (de-)excitation of ions by electrons (dimensionless).
Omega as in Seaton’s collision strength.
Rate scales as 1/(sqrt(T)) exp(DeltaE).</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.collisional_rates.TemperatureInterpolationRates">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.collisional_rates.</code><code class="sig-name descname">TemperatureInterpolationRates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">i</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rates</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>float<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/collisional_rates.html#TemperatureInterpolationRates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.collisional_rates.TemperatureInterpolationRates" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.collisional_rates.CollisionalRates" title="lightweaver.collisional_rates.CollisionalRates"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.collisional_rates.CollisionalRates</span></code></a></p>
<p>Base class for rates defined by interpolating a coefficient on a
temperature grid.</p>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.fal">
<span id="lightweaver-fal-module"></span><h2>lightweaver.fal module<a class="headerlink" href="#module-lightweaver.fal" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-lightweaver.molecule">
<span id="lightweaver-molecule-module"></span><h2>lightweaver.molecule module<a class="headerlink" href="#module-lightweaver.molecule" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.molecule.MolecularTable">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.molecule.</code><code class="sig-name descname">MolecularTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">paths</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/molecule.html#MolecularTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.molecule.MolecularTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stores a set of molecular models, can be indexed by model name to return
the associated model (as a string).</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.molecule.Molecule">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.molecule.</code><code class="sig-name descname">Molecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filePath</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/molecule.html#Molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.molecule.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Simple class for working with RH molecule definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filePath</strong> (<em>str</em>) – Path from which to load molecular data. Use
<cite>get_default_molecule_path</cite> for the path to the default RH
distribution of molecule files (C2, CH, CN, CO, CaH, H2+, H2, H2O,
HF, LiH, MgH, N2, NH, NO, O2, OH, SiO, TiO) all of which have the
‘.molecule’ extension.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.multi">
<span id="lightweaver-multi-module"></span><h2>lightweaver.multi module<a class="headerlink" href="#module-lightweaver.multi" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.multi.MultiMetadata">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.multi.</code><code class="sig-name descname">MultiMetadata</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">logG</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/multi.html#MultiMetadata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.multi.MultiMetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Metadata that is stored in a MULTI atmosphere, but doesn’t really belong
in a Lightweaver atmosphere.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.multi.read_multi_atmos">
<code class="sig-prename descclassname">lightweaver.multi.</code><code class="sig-name descname">read_multi_atmos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span><a class="reference internal" href="#lightweaver.multi.MultiMetadata" title="lightweaver.multi.MultiMetadata">lightweaver.multi.MultiMetadata</a><span class="p">, </span><a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere">lightweaver.atmosphere.Atmosphere</a><span class="p">]</span><a class="reference internal" href="_modules/lightweaver/multi.html#read_multi_atmos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.multi.read_multi_atmos" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a MULTI atmosphere definition from a file for use in Lightweaver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The path to load the file from.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>meta</strong> (<em>MultiMetadata</em>) – Additional metadata from the MULTI metadata that doesn’t appear in a Lightweaver atmosphere (name, gravitational acceleration used).</p></li>
<li><p><strong>atmos</strong> (<em>Atmosphere</em>) – The atmosphere loaded into the standard Lightweaver format.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if file isn’t found, or cannot be parsed correctly.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.nr_update">
<span id="lightweaver-nr-update-module"></span><h2>lightweaver.nr_update module<a class="headerlink" href="#module-lightweaver.nr_update" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="lightweaver.nr_update.nr_post_update">
<code class="sig-prename descclassname">lightweaver.nr_update.</code><code class="sig-name descname">nr_post_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">fdCollisionRates</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">hOnly</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">timeDependentData</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chunkSize</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">ngUpdate</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">printUpdate</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/nr_update.html#nr_post_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.nr_update.nr_post_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Newton-Raphson terms for updating the electron density
through charge conservation. Is attached to the Context object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fdCollisionRates</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use a finite difference approximation to the collisional
rates to find the population gradient WRT ne (default: True i.e. use
finite-difference, if False, collisional rates are ignored for this
process.)</p></li>
<li><p><strong>hOnly</strong> (<em>bool</em><em>, </em><em>optional</em>) – Ignore atoms other than Hydrogen (the primary electron contributor)
(default: False)</p></li>
<li><p><strong>timeDependentData</strong> (<em>dict</em><em>, </em><em>optional</em>) – The presence of this argument indicates that the time-dependent
formalism should be used. Should contain the keys ‘dt’ with a
floating point timestep, and ‘nPrev’ with a list of population
vectors from the start of the time integration step, in the order of
the active atoms. This latter term can be obtained from the previous
state provied by <cite>Context.time_dep_update</cite>.</p></li>
<li><p><strong>chunkSize</strong> (<em>int</em><em>, </em><em>optional</em>) – Not currently used.</p></li>
<li><p><strong>ngUpdate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply Ng Acceleration (default: None, to apply automatic
behaviour), will only accelerate if the counter on the Ng accelerator
has seen enough steps since the previous acceleration (set in Context
initialisation).</p></li>
<li><p><strong>printUpdate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print information on the size of the update (default:
None, to apply automatic behaviour).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dPops</strong> – The maximum relative change of any of the NLTE populations in the
atmosphere.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.rh_atoms">
<span id="lightweaver-rh-atoms-module"></span><h2>lightweaver.rh_atoms module<a class="headerlink" href="#module-lightweaver.rh_atoms" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-lightweaver.utils">
<span id="lightweaver-utils-module"></span><h2>lightweaver.utils module<a class="headerlink" href="#module-lightweaver.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="lightweaver.utils.ConvergenceError">
<em class="property">exception </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">ConvergenceError</code><a class="reference internal" href="_modules/lightweaver/utils.html#ConvergenceError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.ConvergenceError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raised by some iteration schemes, can also be used in user code.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.utils.CrswIterator">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">CrswIterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">initVal</span><span class="o">=</span><span class="default_value">1000.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/utils.html#CrswIterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.CrswIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic iterator to be used for controlling the scale of the collisional
radiative switching (of Hummer &amp; Voels) multiplicative paramter. Can be
inherited to provide different behaviour. By default starts from a factor
of 1e3 and scales this factor by 0.1**(1.0/value) each iteration, as is
the default behaviour in RH.</p>
</dd></dl>

<dl class="py exception">
<dt id="lightweaver.utils.ExplodingMatrixError">
<em class="property">exception </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">ExplodingMatrixError</code><a class="reference internal" href="_modules/lightweaver/utils.html#ExplodingMatrixError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.ExplodingMatrixError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raised by the linear system matrix solver in the case of unsolvable
systems.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.utils.InitialSolution">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">InitialSolution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/utils.html#InitialSolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.InitialSolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Initial solutions to use for atomic populations, either LTE, Zero
radiation (not yet supported), or second order escape probability.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.utils.NgOptions">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">NgOptions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Norder</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">Nperiod</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">Ndelay</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/utils.html#NgOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.NgOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for the options related to Ng acceleration.
.. attribute:: Norder</p>
<blockquote>
<div><p>The order of the extrapolation to use (default: 0, i.e. none).</p>
<dl class="field-list simple">
<dt class="field-odd">type</dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</div></blockquote>
<dl class="py attribute">
<dt id="lightweaver.utils.NgOptions.Nperiod">
<code class="sig-name descname">Nperiod</code><a class="headerlink" href="#lightweaver.utils.NgOptions.Nperiod" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of iterations to run between extrapolations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.utils.NgOptions.Ndelay">
<code class="sig-name descname">Ndelay</code><a class="headerlink" href="#lightweaver.utils.NgOptions.Ndelay" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of iterations to run before starting acceleration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.utils.UnityCrswIterator">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">UnityCrswIterator</code><a class="reference internal" href="_modules/lightweaver/utils.html#UnityCrswIterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.UnityCrswIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.utils.CrswIterator" title="lightweaver.utils.CrswIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.utils.CrswIterator</span></code></a></p>
<p>A specific case representing no collisional radiative switching (i.e.
parameter always 1).</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.air_to_vac">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">air_to_vac</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/utils.html#air_to_vac"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.air_to_vac" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert air wavelength to vacuum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelength</strong> (<em>float</em><em> or </em><em>array-like</em><em> or </em><em>astropy.Quantity</em>) – If no units then the wavelength is assumed to be in [nm], otherwise the provided units are used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – The converted wavelength in [nm].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like or astropy.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.compute_contribution_fn">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">compute_contribution_fn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ctx</span></em>, <em class="sig-param"><span class="n">mu</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">outgoing</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/utils.html#compute_contribution_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.compute_contribution_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the contribution function for all wavelengths in the simulation,
for a chosen angular index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> (<em>Context</em>) – A context with the full depth-dependent data (i.e. ctx.depthData.fill
= True set before the most recent formal solution).</p></li>
<li><p><strong>mu</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The angular index to use (corresponding to the order of the angular
quadratures in atmosphere), default: -1.</p></li>
<li><p><strong>outgoing</strong> (<em>Optional</em><em>[</em><em>bool</em><em>]</em>) – Whether to compute the contribution for outgoing or incoming
radiation (wrt to the atmosphere). Default: outgoing==True, i.e. to
observer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cfn</strong> – The contribution function in terms of depth and wavelength.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.compute_height_edges">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">compute_height_edges</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ctx</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/utils.html#compute_height_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.compute_height_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the edges of the height bins associated with the stratified
altitude array used in a simulation, typically used in conjunction with a
plot using pcolormesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ctx</strong> (<em>Context</em>) – The context from which to construct the height edges.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>heightEdges</strong> – The edges of the height bins.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.compute_radiative_losses">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">compute_radiative_losses</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ctx</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/utils.html#compute_radiative_losses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.compute_radiative_losses" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the radiative gains and losses for each wavelength in the grid
used by the context. Units of J/s/m3/Hz. Includes
background/contributions from overlapping lines. Convention of positive
=&gt; radiative gain, negative =&gt; radiative loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ctx</strong> (<em>Context</em>) – A context with full depth-dependent data (i.e. ctx.depthData.fill =
True set before the most recent formal solution).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>loss</strong> – The radiative gains losses for each depth and wavelength in the
simulation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.compute_wavelength_edges">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">compute_wavelength_edges</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ctx</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/utils.html#compute_wavelength_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.compute_wavelength_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the edges of the wavelength bins associated with the wavelength
array used in a simulation, typically used in conjunction with a plot
using pcolormesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ctx</strong> (<em>Context</em>) – The context from which to construct the wavelength edges.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>wlEdges</strong> – The edges of the wavelength bins.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.convert_specific_intensity">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">convert_specific_intensity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">specInt</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">outUnits</span></em><span class="sig-paren">)</span> &#x2192; astropy.units.quantity.Quantity<a class="reference internal" href="_modules/lightweaver/utils.html#convert_specific_intensity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.convert_specific_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a specific intensity between different units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelength</strong> (<em>np.ndarray</em><em> or </em><em>astropy.Quantity</em>) – If no units are provided then this is assumed to be in nm.</p></li>
<li><p><strong>specInt</strong> (<em>np.ndarray</em><em> or </em><em>astropy.Quantity</em>) – If no units are provided then this is assumed to be in J/s/m2/sr/Hz,
the default for Lightweaver.</p></li>
<li><p><strong>outUnits</strong> (<em>str</em><em> or </em><em>astropy.Unit</em>) – The units to convert specInt to e.g. ‘erg/s/cm2/sr/A’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – specInt converted to the desired units.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.gaunt_bf">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">gaunt_bf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wvl</span></em>, <em class="sig-param"><span class="n">nEff</span></em>, <em class="sig-param"><span class="n">charge</span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/lightweaver/utils.html#gaunt_bf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.gaunt_bf" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaunt factor for bound-free transitions, from Seaton (1960), Rep. Prog.
Phys. 23, 313, as used in RH.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wvl</strong> (<em>float</em><em> or </em><em>array-like</em>) – The wavelength at which to compute the Gaunt factor [nm].</p></li>
<li><p><strong>nEff</strong> (<em>float</em>) – Principal quantum number.</p></li>
<li><p><strong>charge</strong> (<em>float</em>) – Charge of free state.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – Gaunt factor for bound-free transitions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.get_data_path">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">get_data_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/utils.html#get_data_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.get_data_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the location of the Lightweaver support data.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.get_default_molecule_path">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">get_default_molecule_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/utils.html#get_default_molecule_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.get_default_molecule_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the location of the default molecules taken from RH.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.integrate_line_losses">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">integrate_line_losses</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ctx</span></em>, <em class="sig-param"><span class="n">loss</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">lines</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>AtomicLine<span class="p">, </span>Sequence<span class="p">[</span>AtomicLine<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">extendGridNm</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>Sequence<span class="p">[</span>numpy.ndarray<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="_modules/lightweaver/utils.html#integrate_line_losses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.integrate_line_losses" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate the radiative gains and losses over the band associated with a
line or list of lines. Units of J/s/m3. Includes background/contributions
from overlapping lines. Convention of positive =&gt; radiative gain,
negative =&gt; radiative loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> (<em>Context</em>) – A context with the full depth-dependent data (i.e. ctx.depthData.fill
= True set before the most recent formal solution).</p></li>
<li><p><strong>loss</strong> (<em>np.ndarray</em>) – The radiative gains/losses for each wavelength and depth computed by
<cite>compute_radiative_losses</cite>.</p></li>
<li><p><strong>lines</strong> (<a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine"><em>AtomicLine</em></a><em> or </em><em>list of AtomicLine</em>) – The lines for which to compute losses.</p></li>
<li><p><strong>extendGridNm</strong> (<em>float</em><em>, </em><em>optional</em>) – Set this to a positive value to add an additional point at each end
of the integration range to include a wider continuum/far-wing
contribution. Units: nm, default: 0.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>linesLosses</strong> – The radiative gain/losses per line at each depth.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array or list of array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.planck">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">planck</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temp</span></em>, <em class="sig-param"><span class="n">wav</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/utils.html#planck"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.planck" title="Permalink to this definition">¶</a></dt>
<dd><p>Planck black-body function B_nu(T) from wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em> or </em><em>array-like</em>) – Temperature [K]</p></li>
<li><p><strong>wav</strong> (<em>float</em><em> or </em><em>array-like</em>) – The wavelength at which to compute B_nu [nm].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – B_nu(T)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.sequence_repr">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">sequence_repr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">Sequence</span></em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/lightweaver/utils.html#sequence_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.sequence_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Uniform representation of arrays and lists as lists for use in
round-tripping AtomicModels.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.vac_to_air">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">vac_to_air</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wavelength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/utils.html#vac_to_air"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.vac_to_air" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert vacuum wavelength to air.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wavelength</strong> (<em>float</em><em> or </em><em>array-like</em><em> or </em><em>astropy.Quantity</em>) – If no units then the wavelength is assumed to be in [nm], otherwise the provided units are used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – The converted wavelength in [nm].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or array-like or astropy.Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.view_flatten">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">view_flatten</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/lightweaver/utils.html#view_flatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.view_flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a flattened view over an array, will raise an Exception if it
cannot be represented as a flat array without copy.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.utils.voigt_H">
<code class="sig-prename descclassname">lightweaver.utils.</code><code class="sig-name descname">voigt_H</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">v</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/utils.html#voigt_H"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.utils.voigt_H" title="Permalink to this definition">¶</a></dt>
<dd><p>Scalar Voigt profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>float</em><em> or </em><em>array-like</em>) – The a damping parameter to be used in the Voigt profile.</p></li>
<li><p><strong>v</strong> (<em>float</em><em> or </em><em>array-like</em>) – The position in the line profile in Doppler units.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.witt">
<span id="lightweaver-witt-module"></span><h2>lightweaver.witt module<a class="headerlink" href="#module-lightweaver.witt" title="Permalink to this headline">¶</a></h2>
<p>Simple EOS and background opacity package
Coded in python by J. de la Cruz Rodriguez (ISP-SU 2017)</p>
<dl class="py class">
<dt id="lightweaver.witt.witt">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.witt.</code><code class="sig-name descname">witt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">abund_init</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">prec</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">pf_file</span><span class="o">=</span><span class="default_value">'pf_Kurucz.input'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/witt.html#witt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.witt.witt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>EOS described in Mihalas (1970) “Stellar atmospheres”
It considers in detail H, H+, H- and H2, no other molecules.</p>
<p>This particular implementation was taken from Wittmann’s routines.
Partition functions from Kurucz.</p>
<p>Coded in python by J. de la Cruz Rodriguez (ISP-SU 2017)
Messed with by C. Osborne (University of Glasgow 2019-2020)</p>
<p>Don’t blame Jaime for EOS bugs in Lightweaver!
<strong>N.B. Everything in here is CGS.</strong></p>
<p>Dependencies: pf_Kurucz.input containing the partition function data.</p>
<dl class="py method">
<dt id="lightweaver.witt.witt.partition_f">
<code class="sig-name descname">partition_f</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">only</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/witt.html#witt.partition_f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.witt.witt.partition_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the partition function of element “n” for a given temperature</p>
<dl class="simple">
<dt>input:</dt><dd><p>n: Atomic number of the atom -1 (H is 0).
t: Temperature in K.</p>
</dd>
<dt>Keywords:</dt><dd><dl class="simple">
<dt>only: (=int) only return this number first levels of the atom.</dt><dd><p>The default is to return all the levels</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lightweaver.zeeman">
<span id="lightweaver-zeeman-module"></span><h2>lightweaver.zeeman module<a class="headerlink" href="#module-lightweaver.zeeman" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lightweaver.zeeman.ZeemanComponents">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">ZeemanComponents</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">strength</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">shift</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/zeeman.html#ZeemanComponents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.zeeman.ZeemanComponents" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage for communicating the Zeeman components between functions, also
shared with the backend, giving a slightly tighter contract than usual:
all arrays must be contiguous and alpha must be of dtype np.int32.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.zeeman.compute_zeeman_components">
<code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">compute_zeeman_components</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n">AtomicLine</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span><a class="reference internal" href="#lightweaver.zeeman.ZeemanComponents" title="lightweaver.zeeman.ZeemanComponents">lightweaver.zeeman.ZeemanComponents</a><span class="p">]</span><a class="reference internal" href="_modules/lightweaver/zeeman.html#compute_zeeman_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.zeeman.compute_zeeman_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes, if possible, the set of Zeeman components for an atomic line.</p>
<p>If gLandeEff is specified on the line, then basic three-component Zeeman
splitting will be computed directly.
Otherwise, if both the lower and upper levels of the line support
LS-coupling (i.e. J, L, and S all specified, and J &lt;= L + S), then the
LS-coupling formalism is applied to compute the components of “anomalous”
Zeeman splitting.
If neither of these cases are fulfilled, then None is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>line</strong> (<a class="reference internal" href="#lightweaver.atomic_model.AtomicLine" title="lightweaver.atomic_model.AtomicLine"><em>AtomicLine</em></a>) – The line to attempt to compute the Zeeman components from.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>components</strong> – The Zeeman splitting components, if possible.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.zeeman.ZeemanComponents" title="lightweaver.zeeman.ZeemanComponents">ZeemanComponents</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.zeeman.effective_lande">
<code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">effective_lande</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span><span class="p">:</span> <span class="n">AtomicLine</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightweaver/zeeman.html#effective_lande"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.zeeman.effective_lande" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the effective Lande g-factor for an atomic line.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.zeeman.fraction_range">
<code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">fraction_range</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">stop</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">step</span><span class="p">:</span> <span class="n">fractions.Fraction</span> <span class="o">=</span> <span class="default_value">Fraction(1, 1)</span></em><span class="sig-paren">)</span> &#x2192; Iterator<span class="p">[</span>fractions.Fraction<span class="p">]</span><a class="reference internal" href="_modules/lightweaver/zeeman.html#fraction_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.zeeman.fraction_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Works like range, but with Fractions. Does no checking, so best to make
sure the range you’re asking for is sane and divides down properly.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.zeeman.lande_factor">
<code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">lande_factor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">J</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">L</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">S</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/lightweaver/zeeman.html#lande_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.zeeman.lande_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Lande g-factor for an atomic level from the J, L, and S
quantum numbers.</p>
</dd></dl>

<dl class="py function">
<dt id="lightweaver.zeeman.zeeman_strength">
<code class="sig-prename descclassname">lightweaver.zeeman.</code><code class="sig-name descname">zeeman_strength</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Ju</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">Mu</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">Jl</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em>, <em class="sig-param"><span class="n">Ml</span><span class="p">:</span> <span class="n">fractions.Fraction</span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/lightweaver/zeeman.html#zeeman_strength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lightweaver.zeeman.zeeman_strength" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the strength of a Zeeman component, following del Toro Iniesta
(p. 137) albeit larger by a factor of 2 which is corrected by
normalisation.
Takes J upper and lower (u and l respectively), and M upper and lower.</p>
</dd></dl>

</div>
<div class="section" id="module-lightweaver.LwCompiled">
<span id="lightweaver-lwcompiled-module"></span><h2>lightweaver.LwCompiled module<a class="headerlink" href="#module-lightweaver.LwCompiled" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="lightweaver.LwCompiled.BC_to_enum">
<code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">BC_to_enum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.BC_to_enum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the C++ enum associated with the type of python BoundaryCondition
object.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.BackgroundProvider">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">BackgroundProvider</code><a class="headerlink" href="#lightweaver.LwCompiled.BackgroundProvider" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for implementing background packages. Inherit from this to
implement a new background scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The populations of all species present in the simulation.</p></li>
<li><p><strong>radSet</strong> (<a class="reference internal" href="#lightweaver.atomic_set.RadiativeSet" title="lightweaver.atomic_set.RadiativeSet"><em>RadiativeSet</em></a>) – The atomic models and configuration data.</p></li>
<li><p><strong>wavelength</strong> (<em>np.ndarray</em>) – The array of wavelengths at which to compute the background.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="lightweaver.LwCompiled.BackgroundProvider.compute_background">
<code class="sig-name descname">compute_background</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.BackgroundProvider.compute_background" title="Permalink to this definition">¶</a></dt>
<dd><p>The function called by the backend to compute the background.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.LwAtmosphere" title="lightweaver.LwCompiled.LwAtmosphere"><em>LwAtmosphere</em></a>) – The atmospheric model.</p></li>
<li><p><strong>chi</strong> (<em>np.ndarray</em>) – Array in which to store the background opacity [Nlambda, Nspace].</p></li>
<li><p><strong>eta</strong> (<em>np.ndarray</em>) – Array in which to store the background emissivity [Nlambda,
Nspace].</p></li>
<li><p><strong>sca</strong> (<em>np.ndarray</em>) – Array in which to store the background scattering [Nlambda,
Nspace].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.BasicBackground">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">BasicBackground</code><a class="headerlink" href="#lightweaver.LwCompiled.BasicBackground" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.LwCompiled.BackgroundProvider" title="lightweaver.LwCompiled.BackgroundProvider"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.LwCompiled.BackgroundProvider</span></code></a></p>
<p>Basic background implementation used by default in Lightweaver;
equivalent to RH’s treatment i.e. H- opacity, CH, OH, H2 continuum
opacities if present, continua from all passive atoms in the
RadiativeSet, Thomson and Rayleigh scattering (from H and He).</p>
<dl class="py method">
<dt id="lightweaver.LwCompiled.BasicBackground.bf_opacities">
<code class="sig-name descname">bf_opacities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.BasicBackground.bf_opacities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.BasicBackground.compute_background">
<code class="sig-name descname">compute_background</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.BasicBackground.compute_background" title="Permalink to this definition">¶</a></dt>
<dd><p>The function called by the backend to compute the background.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.LwAtmosphere" title="lightweaver.LwCompiled.LwAtmosphere"><em>LwAtmosphere</em></a>) – The atmospheric model.</p></li>
<li><p><strong>chi</strong> (<em>np.ndarray</em>) – Array in which to store the background opacity [Nlambda, Nspace].</p></li>
<li><p><strong>eta</strong> (<em>np.ndarray</em>) – Array in which to store the background emissivity [Nlambda,
Nspace].</p></li>
<li><p><strong>sca</strong> (<em>np.ndarray</em>) – Array in which to store the background scattering [Nlambda,
Nspace].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.BasicBackground.rayleigh_scattering">
<code class="sig-name descname">rayleigh_scattering</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.BasicBackground.rayleigh_scattering" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.FastBackground">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">FastBackground</code><a class="headerlink" href="#lightweaver.LwCompiled.FastBackground" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightweaver.LwCompiled.BackgroundProvider" title="lightweaver.LwCompiled.BackgroundProvider"><code class="xref py py-class docutils literal notranslate"><span class="pre">lightweaver.LwCompiled.BackgroundProvider</span></code></a></p>
<p>A faster implementation (due to C++ implementations) of BasicBackground
supporting multiple threads.</p>
<dl class="py method">
<dt id="lightweaver.LwCompiled.FastBackground.compute_background">
<code class="sig-name descname">compute_background</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.FastBackground.compute_background" title="Permalink to this definition">¶</a></dt>
<dd><p>The function called by the backend to compute the background.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.LwAtmosphere" title="lightweaver.LwCompiled.LwAtmosphere"><em>LwAtmosphere</em></a>) – The atmospheric model.</p></li>
<li><p><strong>chi</strong> (<em>np.ndarray</em>) – Array in which to store the background opacity [Nlambda, Nspace].</p></li>
<li><p><strong>eta</strong> (<em>np.ndarray</em>) – Array in which to store the background emissivity [Nlambda,
Nspace].</p></li>
<li><p><strong>sca</strong> (<em>np.ndarray</em>) – Array in which to store the background scattering [Nlambda,
Nspace].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.LwAtmosphere">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">LwAtmosphere</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage for the C++ class, ensuring all of the arrays remained pinned
from python. Usually constructed by the Context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The python atmosphere object.</p></li>
<li><p><strong>Nwavelengths</strong> (<em>int</em>) – The number of wavelengths used in the wavelength grid.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.B">
<code class="sig-name descname">B</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.B" title="Permalink to this definition">¶</a></dt>
<dd><p>The magnetic field structure for the atmosphereic model (flat array).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.Ndim">
<code class="sig-name descname">Ndim</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.Ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>The dimensionality of the atmosphere.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.Nrays">
<code class="sig-name descname">Nrays</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.Nrays" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of rays in the angular quadrature.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.Nspace">
<code class="sig-name descname">Nspace</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.Nspace" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of points in the atmosphere.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.Nx">
<code class="sig-name descname">Nx</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.Nx" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of points along the x dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.Ny">
<code class="sig-name descname">Ny</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.Ny" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of points along the y dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.Nz">
<code class="sig-name descname">Nz</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.Nz" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of points along the z dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.chiB">
<code class="sig-name descname">chiB</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.chiB" title="Permalink to this definition">¶</a></dt>
<dd><p>Magnetic field azimuth</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwAtmosphere.compute_bcs">
<code class="sig-name descname">compute_bcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.compute_bcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwAtmosphere.configure_bcs">
<code class="sig-name descname">configure_bcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.configure_bcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.cos2chi">
<code class="sig-name descname">cos2chi</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.cos2chi" title="Permalink to this definition">¶</a></dt>
<dd><p>cosine of 2*chi</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.cosGamma">
<code class="sig-name descname">cosGamma</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.cosGamma" title="Permalink to this definition">¶</a></dt>
<dd><p>cosine of gammaB</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.gammaB">
<code class="sig-name descname">gammaB</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.gammaB" title="Permalink to this definition">¶</a></dt>
<dd><p>Magnetic field co-altitude.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.height">
<code class="sig-name descname">height</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.height" title="Permalink to this definition">¶</a></dt>
<dd><p>The z (altitude) grid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.mux">
<code class="sig-name descname">mux</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.mux" title="Permalink to this definition">¶</a></dt>
<dd><p>Cosine of angle with x-axis for each ray.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.muy">
<code class="sig-name descname">muy</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.muy" title="Permalink to this definition">¶</a></dt>
<dd><p>Cosine of angle with y-axis for each ray.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.muz">
<code class="sig-name descname">muz</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.muz" title="Permalink to this definition">¶</a></dt>
<dd><p>Cosine of angle with z-axis for each ray.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.nHTot">
<code class="sig-name descname">nHTot</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.nHTot" title="Permalink to this definition">¶</a></dt>
<dd><p>Total hydrogen number density strucutre.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.ne">
<code class="sig-name descname">ne</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.ne" title="Permalink to this definition">¶</a></dt>
<dd><p>The electron density structure of the atmospheric model (flat array).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.pyAtmos">
<code class="sig-name descname">pyAtmos</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.pyAtmos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.sin2chi">
<code class="sig-name descname">sin2chi</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.sin2chi" title="Permalink to this definition">¶</a></dt>
<dd><p>sine of 2*chi</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.temperature">
<code class="sig-name descname">temperature</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>The temperature structure of the atmospheric model (flat array).</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwAtmosphere.update_projections">
<code class="sig-name descname">update_projections</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.update_projections" title="Permalink to this definition">¶</a></dt>
<dd><p>Update all arrays of projected terms in the atmospheric model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.vlos">
<code class="sig-name descname">vlos</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.vlos" title="Permalink to this definition">¶</a></dt>
<dd><p>The z-velocity structure of the atmospheric model for 1D atmospheres
(flat array).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.vlosMu">
<code class="sig-name descname">vlosMu</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.vlosMu" title="Permalink to this definition">¶</a></dt>
<dd><p>The projected line of sight veloctity for each ray in the atmosphere.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.vturb">
<code class="sig-name descname">vturb</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.vturb" title="Permalink to this definition">¶</a></dt>
<dd><p>Microturbelent velocity structure of the atmospheric model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.vx">
<code class="sig-name descname">vx</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.vx" title="Permalink to this definition">¶</a></dt>
<dd><p>The x-velocity structure of the atmospheric model (flat array).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.vy">
<code class="sig-name descname">vy</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.vy" title="Permalink to this definition">¶</a></dt>
<dd><p>The y-velocity structure of the atmospheric model (flat array).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.vz">
<code class="sig-name descname">vz</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.vz" title="Permalink to this definition">¶</a></dt>
<dd><p>The z-velocity structure of the atmospheric model (flat array).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.wmu">
<code class="sig-name descname">wmu</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.wmu" title="Permalink to this definition">¶</a></dt>
<dd><p>Integration weights for angular quadrature.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.x">
<code class="sig-name descname">x</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.x" title="Permalink to this definition">¶</a></dt>
<dd><p>The x grid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.y">
<code class="sig-name descname">y</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.y" title="Permalink to this definition">¶</a></dt>
<dd><p>The y grid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtmosphere.z">
<code class="sig-name descname">z</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtmosphere.z" title="Permalink to this definition">¶</a></dt>
<dd><p>The z grid.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.LwAtom">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">LwAtom</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage and access to computational atomic data used by backend. Sets up
the computations transitions (LwTransition) present on the model.
Instantiated by Context.</p>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.atomicModel">
<code class="sig-name descname">atomicModel</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.atomicModel" title="Permalink to this definition">¶</a></dt>
<dd><p>The atomic model object associated with this computational atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel">AtomicModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.modelPops">
<code class="sig-name descname">modelPops</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.modelPops" title="Permalink to this definition">¶</a></dt>
<dd><p>The population data for this species, in a python accessible form.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.AtomicState" title="lightweaver.atomic_set.AtomicState">AtomicState</a></p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom</strong> (<a class="reference internal" href="#lightweaver.atomic_model.AtomicModel" title="lightweaver.atomic_model.AtomicModel"><em>AtomicModel</em></a>) – The atomic model object associated with this computational atom.</p></li>
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.LwAtmosphere" title="lightweaver.LwCompiled.LwAtmosphere"><em>LwAtmosphere</em></a>) – The computational atmosphere to be used in the simulation.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The population of species present in the simulation.</p></li>
<li><p><strong>spect</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration"><em>SpectrumConfiguration</em></a>) – The configuration of the spectral grids.</p></li>
<li><p><strong>background</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.LwBackground" title="lightweaver.LwCompiled.LwBackground"><em>LwBackground</em></a>) – The background opacity terms, currently only used in the case of
escape probability initial solution.</p></li>
<li><p><strong>detailed</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the atom is in detailed static or fully active mode (default:
False).</p></li>
<li><p><strong>initSol</strong> (<a class="reference internal" href="#lightweaver.utils.InitialSolution" title="lightweaver.utils.InitialSolution"><em>InitialSolution</em></a><em>, </em><em>optional</em>) – The initial solution to use for the atomic populations (default: LTE).</p></li>
<li><p><strong>ngOptions</strong> (<a class="reference internal" href="#lightweaver.utils.NgOptions" title="lightweaver.utils.NgOptions"><em>NgOptions</em></a><em>, </em><em>optional</em>) – The Ng acceleration options (default: None)</p></li>
<li><p><strong>conserveCharge</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to conserve charge whilst setting populations from escape probability (ignored otherwise) (default: False).</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.C">
<code class="sig-name descname">C</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.C" title="Permalink to this definition">¶</a></dt>
<dd><p>The collisional rates matrix [Nlevel, Nlevel, Nspace]. This is filled
s.t. C_{ji} is C[i, j] to facilitate addition to Gamma.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.Gamma">
<code class="sig-name descname">Gamma</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.Gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>The Gamma iteration matrix [Nlevel, Nlevel, Nspace].</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.Nlevel">
<code class="sig-name descname">Nlevel</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.Nlevel" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of levels in the atomic model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.Ntrans">
<code class="sig-name descname">Ntrans</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.Ntrans" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of transitions in the atomic model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id0">
<code class="sig-name descname">atomicModel</code><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwAtom.compute_collisions">
<code class="sig-name descname">compute_collisions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.compute_collisions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwAtom.compute_profiles">
<code class="sig-name descname">compute_profiles</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.compute_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the line profiles for the spectral lines on the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>polarised</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, and the lines are polarised, then the full Stokes line
profiles will be computed, otherwise the scalar case will be
computed (default: False).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.element">
<code class="sig-name descname">element</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.element" title="Permalink to this definition">¶</a></dt>
<dd><p>The element identifier for this atomic model.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwAtom.load_pops_rates_prd_from_state">
<code class="sig-name descname">load_pops_rates_prd_from_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.load_pops_rates_prd_from_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id1">
<code class="sig-name descname">modelPops</code><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.n">
<code class="sig-name descname">n</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.n" title="Permalink to this definition">¶</a></dt>
<dd><p>The atomic populations (NLTE if in use) [Nlevel, Nspace].</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.nStar">
<code class="sig-name descname">nStar</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.nStar" title="Permalink to this definition">¶</a></dt>
<dd><p>The LTE populations for this species in this atmosphere [Nlevel, Nspace].</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.nTotal">
<code class="sig-name descname">nTotal</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.nTotal" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number density of the model throughout the atmosphere.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwAtom.set_pops_escape_probability">
<code class="sig-name descname">set_pops_escape_probability</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.set_pops_escape_probability" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwAtom.setup_wavelength">
<code class="sig-name descname">setup_wavelength</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.setup_wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the wavelength dependent arrays for the wavelength at
index la.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.trans">
<code class="sig-name descname">trans</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.trans" title="Permalink to this definition">¶</a></dt>
<dd><p>List of computational transitions (LwTransition).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwAtom.vBroad">
<code class="sig-name descname">vBroad</code><a class="headerlink" href="#lightweaver.LwCompiled.LwAtom.vBroad" title="Permalink to this definition">¶</a></dt>
<dd><p>The broadening velocity associated with this atomic model in this
atmosphere.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.LwBackground">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">LwBackground</code><a class="headerlink" href="#lightweaver.LwCompiled.LwBackground" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage and driver for the background computations in Lightweaver. The
storage is allocated and managed by this class, before being passed to
C++ when necessary. This class is also responsible for calling the
BackgroundProvider instance used (by default BasicBackground).</p>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwBackground.chi">
<code class="sig-name descname">chi</code><a class="headerlink" href="#lightweaver.LwCompiled.LwBackground.chi" title="Permalink to this definition">¶</a></dt>
<dd><p>The background opacity [Nlambda, Nspace].</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwBackground.eta">
<code class="sig-name descname">eta</code><a class="headerlink" href="#lightweaver.LwCompiled.LwBackground.eta" title="Permalink to this definition">¶</a></dt>
<dd><p>The background eta [Nlambda, Nspace].</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwBackground.sca">
<code class="sig-name descname">sca</code><a class="headerlink" href="#lightweaver.LwCompiled.LwBackground.sca" title="Permalink to this definition">¶</a></dt>
<dd><p>The background scattering [Nlambda, Nspace].</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwBackground.update_background">
<code class="sig-name descname">update_background</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwBackground.update_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Recompute the background opacities, perhaps in the case where, for
example, the atmospheric parameters have been updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.LwAtmosphere" title="lightweaver.LwCompiled.LwAtmosphere"><em>LwAtmosphere</em></a>) – The atmosphere in which to compute the background opacities and
emissivities.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.LwContext">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">LwContext</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Context that configures and drives the backend. Whilst the class is named
LwContext (to avoid cython collisions) it is exposed from the lightweaver
package as Context.</p>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.kwargs">
<code class="sig-name descname">kwargs</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of all inputs provided to the context, stored as the
under the argument names to <cite>__init__</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.eqPops">
<code class="sig-name descname">eqPops</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.eqPops" title="Permalink to this definition">¶</a></dt>
<dd><p>The populations of each species in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable">SpeciesStateTable</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.conserveCharge">
<code class="sig-name descname">conserveCharge</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.conserveCharge" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether charge is being conserved in the calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.crswCallback">
<code class="sig-name descname">crswCallback</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.crswCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>The object controlling the value of the Collisional Radiative
Switching term.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.utils.CrswIterator" title="lightweaver.utils.CrswIterator">CrswIterator</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.crswDone">
<code class="sig-name descname">crswDone</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.crswDone" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether CRSW is done (i.e. the parameter has reached 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a>) – The atmospheric structure object.</p></li>
<li><p><strong>spect</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration"><em>SpectrumConfiguration</em></a>) – The configuration of wavelength grids and active atoms/transitions.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a>) – The initial populations and storage for these populations during the
simulation.</p></li>
<li><p><strong>ngOptions</strong> (<a class="reference internal" href="#lightweaver.utils.NgOptions" title="lightweaver.utils.NgOptions"><em>NgOptions</em></a><em>, </em><em>optional</em>) – The parameters for Ng acceleration in the simulation (default: No
acceleration).</p></li>
<li><p><strong>initSol</strong> (<a class="reference internal" href="#lightweaver.utils.InitialSolution" title="lightweaver.utils.InitialSolution"><em>InitialSolution</em></a><em>, </em><em>optional</em>) – The starting solution for the population of all active species
(default: LTE).</p></li>
<li><p><strong>conserveCharge</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to conserve charge in the simulation (default: False).</p></li>
<li><p><strong>hprd</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use the Hybrid PRD method to account for velocity shifts in the atmosphere (if PRD is used otherwise, then it is angle-averaged).</p></li>
<li><p><strong>crswCallback</strong> (<a class="reference internal" href="#lightweaver.utils.CrswIterator" title="lightweaver.utils.CrswIterator"><em>CrswIterator</em></a><em>, </em><em>optional</em>) – An instance of CrswIterator (or derived thereof) to control
collisional radiative swtiching (default: None for UnityCrswIterator
i.e. no CRSW).</p></li>
<li><p><strong>Nthreads</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of threads to use in the computation of the formal solution,
default 1.</p></li>
<li><p><strong>backgroundProvider</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.BackgroundProvider" title="lightweaver.LwCompiled.BackgroundProvider"><em>BackgroundProvider</em></a><em>, </em><em>optional</em>) – Implementation for the background, if non-standard. Must follow the
BackgroundProvider interface.</p></li>
<li><p><strong>formalSolver</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of formalSolver registered with the FormalSolvers object.</p></li>
<li><p><strong>interpFn</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of interpolation function to use in the multi-dimensional formal
solver. Must be registered with InterpFns.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.Nthreads">
<code class="sig-name descname">Nthreads</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.Nthreads" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of threads used by the formal solver. A new value can be
assigned to this, and the necessary support structures will be
automatically allocated.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.activeAtoms">
<code class="sig-name descname">activeAtoms</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.activeAtoms" title="Permalink to this definition">¶</a></dt>
<dd><p>All active computational atomic models (LwAtom).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.atmos">
<code class="sig-name descname">atmos</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.atmos" title="Permalink to this definition">¶</a></dt>
<dd><p>The atmospheric model storage object (LwAtmosphere).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.background">
<code class="sig-name descname">background</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.background" title="Permalink to this definition">¶</a></dt>
<dd><p>The background storage object (LwBackground).</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.clear_ng">
<code class="sig-name descname">clear_ng</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.clear_ng" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets Ng acceleration objects on all active atoms.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.compute_profiles">
<code class="sig-name descname">compute_profiles</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.compute_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the line profiles for the spectral lines on all active and
detailed atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>polarised</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, and the lines are polarised, then the full Stokes line
profiles will be computed, otherwise the scalar case will be
computed (default: False).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.compute_rays">
<code class="sig-name descname">compute_rays</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.compute_rays" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the formal solution through a converged simulation for a
particular ray (or set of rays). The wavelength range can be adjusted
to focus on particular lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelengths</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The wavelengths at which to compute the solution (default: None,
i.e. the original grid).</p></li>
<li><p><strong>mus</strong> (<em>float</em><em> or </em><em>sequence of float</em><em> or </em><em>dict</em>) – The cosines of the angles between the rays and the z-axis to use,
if a float or sequence of float then these are taken as muz. If a
dict, then it is expected to be dictionary unpackable
(double-splat) into atmos.rays, and can then be used for
multi-dimensional atmospheres.</p></li>
<li><p><strong>stokes</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to compute a full Stokes solution (default: False).</p></li>
<li><p><strong>refinePrd</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to update the rhoPrd term by reevaluating the scattering
integral on the new wavelength grid. This can sometimes visually
improve the final solution, but is quite computationally costly.
(default: False i.e. not reevaluated, instead if the wavelength
grid is different, rhoPrd is interpolated onto the new grid).</p></li>
<li><p><strong>squeeze</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to squeeze singular dimensions from the output array
(default: True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>intensity</strong> – The outgoing intensity for the chosen rays. If <cite>stokes=True</cite> then
the first dimension indicates, in order, the I, Q, U, V
components.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id2">
<code class="sig-name descname">conserveCharge</code><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.construct_from_state_dict_with">
<em class="property">static </em><code class="sig-name descname">construct_from_state_dict_with</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.construct_from_state_dict_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a new Context informed by a state dictionary with changes
provided to this function. This function is primarily aimed at making
similar versions of a Context, as this can be duplicated much more
easily by <cite>deepcopy</cite> or <cite>pickle.loads(pickle.dumps(ctx))</cite>. For
example, wanting to replace the SpectrumConfiguration to run a
different set of active atoms in the same atmospheric model.
N.B. stateDict will not be deepcopied by this function – do that
yourself if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sd</strong> (<em>dict</em>) – The state dictionary, from Context.state_dict.</p></li>
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.atmosphere.Atmosphere" title="lightweaver.atmosphere.Atmosphere"><em>Atmosphere</em></a><em>, </em><em>optional</em>) – Atmospheric model to use instead of the one present in stateDict.</p></li>
<li><p><strong>spect</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration"><em>SpectrumConfiguration</em></a><em>, </em><em>optional</em>) – Spectral configuration to use instead of the one present in
stateDict.</p></li>
<li><p><strong>eqPops</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpeciesStateTable" title="lightweaver.atomic_set.SpeciesStateTable"><em>SpeciesStateTable</em></a><em>, </em><em>optional</em>) – Species population object to use instead of the one present in
stateDict.</p></li>
<li><p><strong>ngOptions</strong> (<a class="reference internal" href="#lightweaver.utils.NgOptions" title="lightweaver.utils.NgOptions"><em>NgOptions</em></a><em>, </em><em>optional</em>) – Ng acceleration options to use.</p></li>
<li><p><strong>initSol</strong> (<a class="reference internal" href="#lightweaver.utils.InitialSolution" title="lightweaver.utils.InitialSolution"><em>InitialSolution</em></a><em>, </em><em>optional</em>) – Initial solution to use, only matters if <cite>fromScratch</cite> is True.</p></li>
<li><p><strong>conserveCharge</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to conserve charge.</p></li>
<li><p><strong>hprd</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use Hybrid-PRD.</p></li>
<li><p><strong>preserveProfiles</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to copy the current line profiles, or compute new ones
(default: recompute).</p></li>
<li><p><strong>fromScratch</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to construct the new Context, but not make any
modifications, such as copying profiles and rates.</p></li>
<li><p><strong>backgroundProvider</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.BackgroundProvider" title="lightweaver.LwCompiled.BackgroundProvider"><em>BackgroundProvider</em></a><em>, </em><em>optional</em>) – The background package to use instead of the one present in
stateDict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ctx</strong> – The new context object for the simulation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Context</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id3">
<code class="sig-name descname">crswCallback</code><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id4">
<code class="sig-name descname">crswDone</code><a class="headerlink" href="#id4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.depthData">
<code class="sig-name descname">depthData</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.depthData" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration and storage for full depth-dependent data of large
parameters (LwDepthData).</p>
</dd></dl>

<dl class="py attribute">
<dt id="id5">
<code class="sig-name descname">eqPops</code><a class="headerlink" href="#id5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.formal_sol">
<code class="sig-name descname">formal_sol</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.formal_sol" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the formal solution across all wavelengths (single threaded,
rarely used due to the almost insignificant cost of the Gamma terms
in <cite>formal_sol_gamma_matrices</cite>, but currently still used by
<cite>compute_rays</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>dJ</strong> – The maximum relative change in J in the atmosphere.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.formal_sol_gamma_matrices">
<code class="sig-name descname">formal_sol_gamma_matrices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.formal_sol_gamma_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the formal solution across all wavelengths and fill in the
Gamma matrix for each active atom, allowing the populations to then
be updated using the radiative information.</p>
<p>Will use Nthreads for the formal solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fixCollisionalRates</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to not recompute the collisional rates (default: False
i.e. recompute them).</p></li>
<li><p><strong>lambdaIterate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use Lambda iteration (setting the approximate Lambda
term to zero), may be useful in certain unstable situations
(default: False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dJ</strong> – The maximum relative change in J in the atmosphere.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.hprd">
<code class="sig-name descname">hprd</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.hprd" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether PRD calculations are using the Hybrid PRD mode.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id6">
<code class="sig-name descname">kwargs</code><a class="headerlink" href="#id6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.prd_redistribute">
<code class="sig-name descname">prd_redistribute</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.prd_redistribute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.rel_diff_ng_accelerate">
<code class="sig-name descname">rel_diff_ng_accelerate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.rel_diff_ng_accelerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.rel_diff_pops">
<code class="sig-name descname">rel_diff_pops</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.rel_diff_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.set_formal_solver">
<code class="sig-name descname">set_formal_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.set_formal_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>For internal use. Set the formal solver through the constructor.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.set_interp_fn">
<code class="sig-name descname">set_interp_fn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.set_interp_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>For internal use. Set the interpolation function through the
constructor.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.setup_stokes">
<code class="sig-name descname">setup_stokes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.setup_stokes" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the Context for Full Stokes radiative transfer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>recompute</strong> (<em>bool</em><em>, </em><em>optional</em>) – If previously called, and called again with <cite>recompute = True</cite>
the line profiles will be recomputed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.single_stokes_fs">
<code class="sig-name descname">single_stokes_fs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.single_stokes_fs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a full Stokes formal solution across all wakelengths in the
grid, setting up the Context first (it is rarely necessary to call
setup_stokes directly).</p>
<p>The full Stokes formal solution is not currently multi-threaded, as
it is usually only called once at the end of a simulation, however
this could easily be changed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>recompute</strong> (<em>bool</em><em>, </em><em>optional</em>) – If previously called, and called again with <cite>recompute = True</cite>
the line profiles will be recomputed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwContext.spect">
<code class="sig-name descname">spect</code><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.spect" title="Permalink to this definition">¶</a></dt>
<dd><p>The spectrum storage object (LwSpectrum).</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.stat_equil">
<code class="sig-name descname">stat_equil</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.stat_equil" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the populations of active atoms using the current values of
their Gamma matrices. This function solves the time-independent statistical
equilibrium equations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>printUpdate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print information on the size of the update (default:
None, to apply automatic behaviour).</p></li>
<li><p><strong>chunkSize</strong> (<em>int</em><em>, </em><em>optional</em>) – Not currently used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dPops</strong> – The maximum relative change of any of the NLTE populations in the
atmosphere.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.state_dict">
<code class="sig-name descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state dictionary for the Context, which can be used to
serialise the entire Context and/or reconstruct it.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.time_dep_restore_prev_pops">
<code class="sig-name descname">time_dep_restore_prev_pops</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.time_dep_restore_prev_pops" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore the populations to their state prior to the time-dependent
updates for this timestep. Also resets I and J to 0. May be useful in
cases where a problem was encountered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prevTimePops</strong> (<em>list of np.ndarray</em>) – <cite>prevTimePops</cite> returned by time_dep_update.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.time_dep_update">
<code class="sig-name descname">time_dep_update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.time_dep_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the populations of active atoms using the current values of
their Gamma matrices. This function solves the time-dependent kinetic
equilibrium equations (ignoring advective terms). Currently uses a
fully implicit (theta = 0) integrator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<em>float</em>) – The timestep length [s].</p></li>
<li><p><strong>prevTimePops</strong> (<em>list of np.ndarray</em><em> or </em><em>None</em>) – The NLTE populations for each active atom at the start of the
timestep (order matching that of Context.activeAtoms). This does
not need to be provided the first time time_dep_update is called
for a timestep, as if this parameter is None then this list will
be constructed, and returned as the second return value, and can
then be passed in again for additional iterations on a timestep.</p></li>
<li><p><strong>ngUpdate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply Ng Acceleration (default: None, to apply automatic
behaviour), will only accelerate if the counter on the Ng accelerator
has seen enough steps since the previous acceleration (set in Context
initialisation).</p></li>
<li><p><strong>printUpdate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print information on the size of the update (default:
None, to apply automatic behaviour).</p></li>
<li><p><strong>chunkSize</strong> (<em>int</em><em>, </em><em>optional</em>) – Not currently used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dPops</strong> (<em>float</em>) – The maximum relative change of any of the NLTE populations in the
atmosphere.</p></li>
<li><p><strong>prevTimePops</strong> (<em>list of np.ndarray</em>) – The input needed as <cite>prevTimePops</cite> if this function is to be called
again for this timestep.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.update_deps">
<code class="sig-name descname">update_deps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.update_deps" title="Permalink to this definition">¶</a></dt>
<dd><p>Update various dependent parameters in the simulation after changes
to different components. If a component has not been adjust then its
associated argument can be set to False. By default, all standard
dependent components are recomputed (e.g. projected velocities, line
profiles, LTE populations, background terms).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the temperature has been modified.</p></li>
<li><p><strong>ne</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the electron density has been modified.</p></li>
<li><p><strong>vturb</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the microturbulent velocity has been modified.</p></li>
<li><p><strong>vlos</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the bulk velocity field has been modified.</p></li>
<li><p><strong>B</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the magnetic field has been modified.</p></li>
<li><p><strong>background</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the background needs updating.</p></li>
<li><p><strong>hprd</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the hybrid PRD terms need updating.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.update_hprd_coeffs">
<code class="sig-name descname">update_hprd_coeffs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.update_hprd_coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the values of the H-PRD coefficients, this needs to be called
if changes are made to the atmospheric structure to ensure that the
interpolation parameters are correct.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.update_projections">
<code class="sig-name descname">update_projections</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.update_projections" title="Permalink to this definition">¶</a></dt>
<dd><p>Update all arrays of projected terms in the atmospheric model.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwContext.update_threads">
<code class="sig-name descname">update_threads</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwContext.update_threads" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.LwDepthData">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">LwDepthData</code><a class="headerlink" href="#lightweaver.LwCompiled.LwDepthData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Simple object to lazily hold data that isn’t usually stored during the
Formal Solution (full angularly dependent emissivity, opacity, and
intensity at every point), due to the high memory cost. This is a part of
the Context and doesn’t need to be instantiated directly.</p>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwDepthData.I">
<code class="sig-name descname">I</code><a class="headerlink" href="#lightweaver.LwCompiled.LwDepthData.I" title="Permalink to this definition">¶</a></dt>
<dd><p>Full depth dependent intensity [Nlambda, Nmu, Up/Down, Nspace].</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwDepthData.chi">
<code class="sig-name descname">chi</code><a class="headerlink" href="#lightweaver.LwCompiled.LwDepthData.chi" title="Permalink to this definition">¶</a></dt>
<dd><p>Full depth dependent opacity [Nlambda, Nmu, Up/Down, Nspace].</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwDepthData.eta">
<code class="sig-name descname">eta</code><a class="headerlink" href="#lightweaver.LwCompiled.LwDepthData.eta" title="Permalink to this definition">¶</a></dt>
<dd><p>Full depth dependent emissivity [Nlambda, Nmu, Up/Down, Nspace].</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwDepthData.fill">
<code class="sig-name descname">fill</code><a class="headerlink" href="#lightweaver.LwCompiled.LwDepthData.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Set this to True to fill the arrays, this will take care of
allocating the space if not previously done.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.LwFormalSolverManager">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">LwFormalSolverManager</code><a class="headerlink" href="#lightweaver.LwCompiled.LwFormalSolverManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage and enumeration of the different formal solvers loaded for use in
Lightweaver. There is no need to instantiate this class directly, instead
there is a single instance of it instantiated as <cite>FormalSolvers</cite>, which
should be used.</p>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwFormalSolverManager.paths">
<code class="sig-name descname">paths</code><a class="headerlink" href="#lightweaver.LwCompiled.LwFormalSolverManager.paths" title="Permalink to this definition">¶</a></dt>
<dd><p>The currently loaded paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwFormalSolverManager.names">
<code class="sig-name descname">names</code><a class="headerlink" href="#lightweaver.LwCompiled.LwFormalSolverManager.names" title="Permalink to this definition">¶</a></dt>
<dd><p>The names of all available formal solvers, each of which can be
passed to the Context constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwFormalSolverManager.default_formal_solver">
<code class="sig-name descname">default_formal_solver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwFormalSolverManager.default_formal_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the default formal solver for a given dimensionality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Ndim</strong> (<em>int</em>) – The dimensionality of the simulation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>name</strong> – The name of the default formal solver.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwFormalSolverManager.load_fs_from_path">
<code class="sig-name descname">load_fs_from_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwFormalSolverManager.load_fs_from_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to load a formal solver, following the Lightweaver API, from
a shared library at <cite>path</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – The path from which to load the formal solver.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id7">
<code class="sig-name descname">names</code><a class="headerlink" href="#id7" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id8">
<code class="sig-name descname">paths</code><a class="headerlink" href="#id8" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.LwInterpFnManager">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">LwInterpFnManager</code><a class="headerlink" href="#lightweaver.LwCompiled.LwInterpFnManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage and enumeration of the different interpolation functions for
multi-dimensional formal solvers loaded for use in Lightweaver. There is
no need to instantiate this class directly, instead there is a single
instance of it instantiated as <cite>InterpFns</cite>, which should be used.</p>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwInterpFnManager.paths">
<code class="sig-name descname">paths</code><a class="headerlink" href="#lightweaver.LwCompiled.LwInterpFnManager.paths" title="Permalink to this definition">¶</a></dt>
<dd><p>The currently loaded paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwInterpFnManager.names">
<code class="sig-name descname">names</code><a class="headerlink" href="#lightweaver.LwCompiled.LwInterpFnManager.names" title="Permalink to this definition">¶</a></dt>
<dd><p>The names of all available interpolation functions, each of which can
be passed to the Context constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwInterpFnManager.default_interp">
<code class="sig-name descname">default_interp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwInterpFnManager.default_interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the default interpolation function for a given
dimensionality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Ndim</strong> (<em>int</em>) – The dimensionality of the simulation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>name</strong> – The name of the default interpolation function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwInterpFnManager.load_interp_fn_from_path">
<code class="sig-name descname">load_interp_fn_from_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwInterpFnManager.load_interp_fn_from_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to load an interpolation function, following the Lightweaver
API, from a shared library at <cite>path</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – The path from which to load the interpolation function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id9">
<code class="sig-name descname">names</code><a class="headerlink" href="#id9" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id10">
<code class="sig-name descname">paths</code><a class="headerlink" href="#id10" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.LwSpectrum">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">LwSpectrum</code><a class="headerlink" href="#lightweaver.LwCompiled.LwSpectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage and access to spectrum data used by backend. Instantiated by
Context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelength</strong> (<em>np.ndarray</em>) – The wavelength grid used in the simulation [nm].</p></li>
<li><p><strong>Nrays</strong> (<em>int</em>) – The number of rays in the angular quadrature.</p></li>
<li><p><strong>Nspace</strong> (<em>int</em>) – The number of points in the atmospheric model.</p></li>
<li><p><strong>Noutgoing</strong> (<em>int</em>) – The number of outgoing point in the atmosphere, essentially
max(Ny*Nx, Nx, 1), (when used in an array these elements will be
ordered as a flattened array of [Ny, Nx]).</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwSpectrum.I">
<code class="sig-name descname">I</code><a class="headerlink" href="#lightweaver.LwCompiled.LwSpectrum.I" title="Permalink to this definition">¶</a></dt>
<dd><p>Intensity [J/s/m2/sr/Hz], shape is squeeze([Nlambda, Nmu, Noutgoing]).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwSpectrum.J">
<code class="sig-name descname">J</code><a class="headerlink" href="#lightweaver.LwCompiled.LwSpectrum.J" title="Permalink to this definition">¶</a></dt>
<dd><p>Angle-averaged intensity [J/s/m2/sr/Hz], shape is squeeze([Nlambda, Nspace]).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwSpectrum.Quv">
<code class="sig-name descname">Quv</code><a class="headerlink" href="#lightweaver.LwCompiled.LwSpectrum.Quv" title="Permalink to this definition">¶</a></dt>
<dd><p>Q, U and V Stokes parameters [J/s/m2/sr/Hz], shape is squeeze([3,
Nlambda, Nmu, Noutgoing]).</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwSpectrum.interp_J_from_state">
<code class="sig-name descname">interp_J_from_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwSpectrum.interp_J_from_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwSpectrum.setup_stokes">
<code class="sig-name descname">setup_stokes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwSpectrum.setup_stokes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwSpectrum.wavelength">
<code class="sig-name descname">wavelength</code><a class="headerlink" href="#lightweaver.LwCompiled.LwSpectrum.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavelength grid used [nm].</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.LwTransition">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">LwTransition</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Storage and access to transition data used by backend. Instantiated by
Context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trans</strong> (<a class="reference internal" href="#lightweaver.atomic_model.AtomicTransition" title="lightweaver.atomic_model.AtomicTransition"><em>AtomicTransition</em></a>) – The transition model object.</p></li>
<li><p><strong>compAtom</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.LwAtom" title="lightweaver.LwCompiled.LwAtom"><em>LwAtom</em></a>) – The computational atom to which this computational transition
belongs.</p></li>
<li><p><strong>atmos</strong> (<a class="reference internal" href="#lightweaver.LwCompiled.LwAtmosphere" title="lightweaver.LwCompiled.LwAtmosphere"><em>LwAtmosphere</em></a>) – The computational atmosphere in which this transition is to be used.</p></li>
<li><p><strong>spect</strong> (<a class="reference internal" href="#lightweaver.atomic_set.SpectrumConfiguration" title="lightweaver.atomic_set.SpectrumConfiguration"><em>SpectrumConfiguration</em></a>) – The spectral configuration of the simulation.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.transModel">
<code class="sig-name descname">transModel</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.transModel" title="Permalink to this definition">¶</a></dt>
<dd><p>The transition model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lightweaver.atomic_model.AtomicTransition" title="lightweaver.atomic_model.AtomicTransition">AtomicTransition</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.Aji">
<code class="sig-name descname">Aji</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.Aji" title="Permalink to this definition">¶</a></dt>
<dd><p>Einstein A for transition.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.Bij">
<code class="sig-name descname">Bij</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.Bij" title="Permalink to this definition">¶</a></dt>
<dd><p>Einstein Bij for transition.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.Bji">
<code class="sig-name descname">Bji</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.Bji" title="Permalink to this definition">¶</a></dt>
<dd><p>Einstein Bji for transition.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.Nblue">
<code class="sig-name descname">Nblue</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.Nblue" title="Permalink to this definition">¶</a></dt>
<dd><p>Index into global wavelength grid where this transition’s local grid
starts.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.Qelast">
<code class="sig-name descname">Qelast</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.Qelast" title="Permalink to this definition">¶</a></dt>
<dd><p>The elastic collision rate for this transition in the atmosphere,
needed for PRD.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.Rij">
<code class="sig-name descname">Rij</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.Rij" title="Permalink to this definition">¶</a></dt>
<dd><p>Upwards radiative rates for the transition throughout the atmosphere.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.Rji">
<code class="sig-name descname">Rji</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.Rji" title="Permalink to this definition">¶</a></dt>
<dd><p>Downward radiative rates for the transition throughout the atmosphere.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.aDamp">
<code class="sig-name descname">aDamp</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.aDamp" title="Permalink to this definition">¶</a></dt>
<dd><p>The Voigt damping parameter for this transition in the atmosphere.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.active">
<code class="sig-name descname">active</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.active" title="Permalink to this definition">¶</a></dt>
<dd><p>The active wavelength mask for this transition.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.alpha">
<code class="sig-name descname">alpha</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>The wavelength-dependent cross-section for a continuum.
AttributeError for lines.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.atom">
<code class="sig-name descname">atom</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.atom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwTransition.compute_phi">
<code class="sig-name descname">compute_phi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.compute_phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the line profile phi (phi_num in the technical report), by
calling compute_phi on the line object. Provides a callback to the
default Voigt implementation used in the backend.
Does nothing if called on a continuum.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwTransition.compute_polarised_profiles">
<code class="sig-name descname">compute_polarised_profiles</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.compute_polarised_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the polarised line profiles (all of phi, phi_{Q, U, V}, and
psi_{Q, U, V}) for a Voigt line, this currently doesn’t support
non-standard line profile types, but could do so quite simply by
following compute_phi.
Does nothing if the transitions is a continuum or the line is not
polarisable.
By calling this and iterating the Context as usual, a field</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.i">
<code class="sig-name descname">i</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.i" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of lower level.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.iLevel">
<code class="sig-name descname">iLevel</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.iLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Access the lower level on the model object.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.j">
<code class="sig-name descname">j</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.j" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of upper level.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.jLevel">
<code class="sig-name descname">jLevel</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.jLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Access the upper level on the model object.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.lambda0">
<code class="sig-name descname">lambda0</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.lambda0" title="Permalink to this definition">¶</a></dt>
<dd><p>Line rest wavelength or continuum edge wavelength.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwTransition.load_rates_prd_from_state">
<code class="sig-name descname">load_rates_prd_from_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.load_rates_prd_from_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.phi">
<code class="sig-name descname">phi</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerical line profile. AttributeError for continua.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.phiQ">
<code class="sig-name descname">phiQ</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.phiQ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.phiU">
<code class="sig-name descname">phiU</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.phiU" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.phiV">
<code class="sig-name descname">phiV</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.phiV" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.polarisable">
<code class="sig-name descname">polarisable</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.polarisable" title="Permalink to this definition">¶</a></dt>
<dd><p>The polarisability of the transition, based on model data.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.psiQ">
<code class="sig-name descname">psiQ</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.psiQ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.psiU">
<code class="sig-name descname">psiU</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.psiU" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.psiV">
<code class="sig-name descname">psiV</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.psiV" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.rhoPrd">
<code class="sig-name descname">rhoPrd</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.rhoPrd" title="Permalink to this definition">¶</a></dt>
<dd><p>Ratio of emission to absorption profiles throughout the atmosphere,
in the case of PRD lines.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id11">
<code class="sig-name descname">transModel</code><a class="headerlink" href="#id11" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.type">
<code class="sig-name descname">type</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.type" title="Permalink to this definition">¶</a></dt>
<dd><p>The type of transition (Line or Continuum) as a str.</p>
</dd></dl>

<dl class="py method">
<dt id="lightweaver.LwCompiled.LwTransition.uv">
<code class="sig-name descname">uv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.uv" title="Permalink to this definition">¶</a></dt>
<dd><p>Thin wrapper for computing U and V using the core. Must be called
after <cite>atom.setup_wavelength(la)</cite>, and Uji, Vij, Vji must tbe the
proper size, as no verification is performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>la</strong> (<em>int</em>) – The wavelength index at which to compute U and V.</p></li>
<li><p><strong>mu</strong> (<em>int</em>) – The angle index at which to compute U and V.</p></li>
<li><p><strong>Uji</strong> (<em>np.ndarray</em>) – Storage arrays for the result.</p></li>
<li><p><strong>Vij</strong> (<em>np.ndarray</em>) – Storage arrays for the result.</p></li>
<li><p><strong>Vji</strong> (<em>np.ndarray</em>) – Storage arrays for the result.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.wavelength">
<code class="sig-name descname">wavelength</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>The transition’s local wavelength grid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lightweaver.LwCompiled.LwTransition.wphi">
<code class="sig-name descname">wphi</code><a class="headerlink" href="#lightweaver.LwCompiled.LwTransition.wphi" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplicative inverse of integrated line profile at each location in
the atmosphere, used to ensure terms based on integration across the
entire line profile (e.g. in the Gamma matrix) are correctly
normalised.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.LwZeemanComponents">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">LwZeemanComponents</code><a class="headerlink" href="#lightweaver.LwCompiled.LwZeemanComponents" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stores the Zeeman components to be passed to the backend, only exists
transiently.</p>
</dd></dl>

<dl class="py class">
<dt id="lightweaver.LwCompiled.RayleighScatterer">
<em class="property">class </em><code class="sig-prename descclassname">lightweaver.LwCompiled.</code><code class="sig-name descname">RayleighScatterer</code><a class="headerlink" href="#lightweaver.LwCompiled.RayleighScatterer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>For computing Rayleigh scattering, used by BasicBackground.</p>
<dl class="py method">
<dt id="lightweaver.LwCompiled.RayleighScatterer.scatter">
<code class="sig-name descname">scatter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lightweaver.LwCompiled.RayleighScatterer.scatter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="auto_examples/plot_SimpleLineTest.html" class="btn btn-neutral float-left" title="Computing a simple NLTE 8542 line profile in a FAL C atmosphere" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, C. Osborne.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>